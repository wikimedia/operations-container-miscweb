<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 1212 &ndash; On paged categories, article totals and subcat totals are incorrect</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=1212&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=1212">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=1212">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=1212">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 1212 – On paged categories, article totals and subcat totals are incorrect",  
                             "show_bug.cgi?id=1212" );
        document.title = "Bug 1212 – On paged categories, article totals and subcat totals are incorrect";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 1212 – On paged categories, article totals and subcat totals are incorrect", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_RESOLVED bz_product_MediaWiki bz_component_Categories bz_bug_1212 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2014-11-18 18:07:09 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-11-18 18:07:09">
  <input type="hidden" name="longdesclength" value="50">
  <input type="hidden" name="id" value="1212">
  <input type="hidden" name="token" value="1419358605-ewLi6ubQDgrcd1-D11e-YsJtZWh3FA0c8NayyS7rY9g">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=1212"><b>Bug&nbsp;1212</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">On paged categories, article totals and subcat totals are incorrect</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>On paged categories, article totals and subcat totals are incorrect
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('On paged categories, article totals and subcat totals are incorrect', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>Categories
    
    (<a href="buglist.cgi?component=Categories&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">All
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Normal
       normal<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=1212">19 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=1212#vote_1212">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
          <a href="http://en.wikipedia.org/wiki/Special:Categories?offset=Living_peopla"><span title="http://en.wikipedia.org/wiki/Special:Categories?offset=Living_peopla">http://en.wikipedia.org/wiki/Special:...
        </span></a>
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">patch-need-review
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label for="duplicates">Duplicates</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - category tells user there are 200 articles in it when there are more"
   href="show_bug.cgi?id=1336">1336</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Large categories incorrectly report number of subcategories and articles"
   href="show_bug.cgi?id=1588">1588</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - There are X articles in this category lies for X&gt;200"
   href="show_bug.cgi?id=3095">3095</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Subcategory system displays the wrong amount of numbers"
   href="show_bug.cgi?id=3714">3714</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - count of articles (all pages) within categories"
   href="show_bug.cgi?id=4390">4390</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - MediaWiki:Categoryarticlecount, Subcategorycount $1 should be fed correctly"
   href="show_bug.cgi?id=6146">6146</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Special:Allpages, Special:Categories could mention total"
   href="show_bug.cgi?id=7950">7950</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Special:Categories should give a total count"
   href="show_bug.cgi?id=8235">8235</a> 
      </span>
      (<a href="buglist.cgi?bug_id=1336,1588,3095,3714,4390,6146,7950,8235">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - Things that could use a category table (tracking)"
   href="show_bug.cgi?id=13326">13326</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Option to not display [+] if no sub-category exists"
   href="show_bug.cgi?id=11132">11132</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=1212&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=1212">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2004-12-27 17:11 UTC by <span class="vcard"><span class="fn">David Gerard</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2014-11-18 18:07 UTC 
      (<a href="show_activity.cgi?id=1212">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>16 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="agarrett">agarrett</option>
                <option value="arenalpha">arenalpha</option>
                <option value="ayg">ayg</option>
                <option value="beland">beland</option>
                <option value="brion">brion</option>
                <option value="bugzilla.wikimedia">bugzilla.wikimedia</option>
                <option value="dunc_harris">dunc_harris</option>
                <option value="gangleri">gangleri</option>
                <option value="gtisza">gtisza</option>
                <option value="hippytrail">hippytrail</option>
                <option value="jidanni">jidanni</option>
                <option value="river">river</option>
                <option value="robert">robert</option>
                <option value="stanley">stanley</option>
                <option value="sylvain_machefert">sylvain_machefert</option>
                <option value="webmaster">webmaster</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=4268"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Show true category counts</span></b></a>

          <span class="bz_attach_extra_info">
              (2.71 KB,
                patch)

            <br>
            <a href="#attach_4268"
               title="Go to the comment associated with the attachment">2007-10-18 14:31 UTC</a>,

            <span class="vcard"><span class="fn">Greg Sabino Mullane</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=4268&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=4704"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">First pass at a patch (not yet ready for commit)</span></b></a>

          <span class="bz_attach_extra_info">
              (12.55 KB,
                patch)

            <br>
            <a href="#attach_4704"
               title="Go to the comment associated with the attachment">2008-03-09 04:31 UTC</a>,

            <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=4704&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=4705"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Almost-complete patch</span></b></a>

          <span class="bz_attach_extra_info">
              (22.33 KB,
                patch)

            <br>
            <a href="#attach_4705"
               title="Go to the comment associated with the attachment">2008-03-10 01:49 UTC</a>,

            <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=4705&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=4706"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Same as previous attachment, with all files actually included</span></b></a>

          <span class="bz_attach_extra_info">
              (27.09 KB,
                patch)

            <br>
            <a href="#attach_4706"
               title="Go to the comment associated with the attachment">2008-03-10 23:03 UTC</a>,

            <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=4706&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=4728"
               title="View the content of the attachment">
          <b>Patch with all functionality, needs review</b></a>

          <span class="bz_attach_extra_info">
              (33.03 KB,
                patch)

            <br>
            <a href="#attach_4728"
               title="Go to the comment associated with the attachment">2008-03-16 19:26 UTC</a>,

            <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=4728&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (4)
        </span>
        <a href="attachment.cgi?bugid=1212&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Gerard</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-27 17:11:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >On large categories, both the articles and subcats are paged. This is fine, but
the totals given for both articles and subcats are incorrect.

Test case: Category:Business

Expected result: &quot;There are [correct total] subcategories to this category.&quot;

Actual result: &quot;There are 17 subcategories to this category.&quot; - it listed only
the ones on the page.

Quick fix: change text to say &quot;on this page&quot; - then it's true, but not so useful
for the reader.
Better fix: show the correct total for the entire category.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-01-29 08:12:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - category tells user there are 200 articles in it when there are more"
   href="show_bug.cgi?id=1336">Bug 1336</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-02-25 08:01:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Large categories incorrectly report number of subcategories and articles"
   href="show_bug.cgi?id=1588">Bug 1588</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">lɛʁi לערי ריינהארט</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-14 23:04:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hallo!

There are some differences now between the test wikis FiverAlpha and Nukawiki:

See:
<a href="http://jadesukka.homelinux.org:8180/betawiki/Betawiki:Categories/counters#bugzilla">http://jadesukka.homelinux.org:8180/betawiki/Betawiki:Categories/counters#bugzilla</a>

<a href="http://test.leuksman.com/index.php?title=Category:Todo&amp;from=Z">http://test.leuksman.com/index.php?title=Category:Todo&amp;from=Z</a>
looks pretty good compared to
<a href="http://jadesukka.homelinux.org:8180/mediawiki15c/index.php?title=Luokka:Todo&amp;from=Z">http://jadesukka.homelinux.org:8180/mediawiki15c/index.php?title=Luokka:Todo&amp;from=Z</a>

Regards Reinhardt [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=user%3Agangleri">user:gangleri</a>]]</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Gerard</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-09 05:16:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - There are X articles in this category lies for X&gt;200"
   href="show_bug.cgi?id=3095">Bug 3095</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-12 05:39:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It appears this error has made its way to 1.5.0 as seen on my site here: 
<a href="http://www.marveldatabase.com/wiki/index.php/Category:Characters">http://www.marveldatabase.com/wiki/index.php/Category:Characters</a>

I definitely think that David Gerard's 'better fix' should be the course of 
action. Category pages should show the FULL count for all articles and sub-
categories of the category in question.

Also, the category page only displays the first 200 total links, both sub-
categories and articles combined. (See my referenced link) Shouldn't it show the 
first 200 articles and ALL (limited to x, for SQL query-time reasons) sub-
categories?</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">lɛʁi לערי ריינהארט</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-15 13:11:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Subcategory system displays the wrong amount of numbers"
   href="show_bug.cgi?id=3714">Bug 3714</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">arenalpha
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-15 14:51:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hope this gets fixed..... eventually...</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-19 19:50:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Any word on this bug getting some attention before version 1.6?</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-26 18:20:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - count of articles (all pages) within categories"
   href="show_bug.cgi?id=4390">Bug 4390</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Borgx</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-27 00:10:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Five similar bugs!. This is a very urgent request Mr.Developer!</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Zigger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-27 14:30:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(changed URL to category currently with paging)</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Starling</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-06 13:24:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Is SELECT COUNT(*) good enough here? Or do we need something more efficient?</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-06 14:36:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >First, it should display a TOTAL of all pages within the category (and a total of 
all categories in the category). Second, it should give the user the option to 
display the first 20, 50, 100 or 200 and have a 'previous' and 'next' feature. 
Something closer to the 'recent changes page' setup... 

Currently, the way it works is fine, but it lacks a TOTAL sum, the only way to 
find out is to flip through page by page and count yourself. I also like the idea 
of adding the choice of limiting the count (20, 50, 100 or 200) like all the 
other special pages in MediaWiki.

Just my thoughts...</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-06 15:50:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1212#c12">comment #12</a>)
<span class="quote">&gt; Is SELECT COUNT(*) good enough here? Or do we need something more efficient?</span >

I don't see why not.</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-06 20:37:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The rumor was that SELECT COUNT(*) was too expensive for large categories (eg 
Category:GFDL on Commons, with tens of thousands of entries). I'm not sure how real 
that problem is.</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-06 23:38:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I know how this will probably require the creation of another unessecary table, 
but why don't we have a table that keeps the tallies of articles in each  
category... This data could be cached server-side for larger wikis and cached 
client-side for smaller ones. Everyone is happy and we still get our count!

When the cache expires, the query is called. Life is beautiful.   :)</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Starling</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-07 00:14:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >We could just remove the count from the UI. That's what we do for
[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Special%3AWhatlinkshere">Special:Whatlinkshere</a>]], which has precisely the same schema problem.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Borgx</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-07 05:52:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1212#c17">comment #17</a>)
<span class="quote">&gt; We could just remove the count from the UI. That's what we do for
&gt; [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Special%3AWhatlinkshere">Special:Whatlinkshere</a>]], which has precisely the same schema problem.</span >


Which is now being requested at <a class="bz_bug_link 
          bz_status_REOPENED "
   title="REOPENED - Provide a count in Special pages that list articles/pages (e.g. special:whatlinkshere)"
   href="show_bug.cgi?id=4394">bug 4394</a> (Provide a count in Special:Whatlinkshere)</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Christopher Beland</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-08 01:00:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Editors often count up how many articles are in maintenance categories. 
Removing the automatic count would make that a lot more work.  And it's useful
to readers to know what is below the virtual fold before they invest the time it
takes to get there.

Perhaps there is a clever query that would give an exact count for
reasonably-sized categories and an &quot;overflow&quot; indication for anything larger
than a certain threshold (possibly with a &quot;click here to get an exact count&quot;
link).  Though it might be easiest just to implement the simply COUNT solution
at an off-peak time and check to see what kind of a performance hit there is, if
any.  That would be useful information in general, and would also help set the
threshold optimally.</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-04 01:43:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Has anyone been able to do a successful test on what kind of performance issues 
this may create? Could we not extrapolate an estimate? Grab a page-render time for 
a &lt;200 article COUNT and multiply by 50 and 500 to figure for a maximum threshold 
of 10,000 or 100,000? (Accounting for other page-rendering factors, of course...)</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-30 21:27:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - MediaWiki:Categoryarticlecount, Subcategorycount $1 should be fed correctly"
   href="show_bug.cgi?id=6146">Bug 6146</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Purodha Blissenbach</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-31 05:31:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Design Suggestions:
1. MediaWiki:Categoryarticlecount and MediaWiki:subcategorycount shoud have params $1 to $7 at least making 
messages possible like: &quot;showing 200 articles from # 401 'cat ears' to # 600 'dog pounds' of a total of 782 
articles in category 'cats and dogs'.&quot;

2. Count of articles/subcats per page (currently 200) to be installable in &quot;user preferences&quot; and selectable 
via paging option links (display previous/next 10|50|100|200|500|1000|....) as elsewhere.

3. Count of columns of articles/subcats per page (currently 3) to be set in &quot;user preferences&quot; (as 1...10, e.g
.) and possibly via paging option links.

4. Show a page directoy, if there is more than one page, like with Special:Allpages, where pages are listed and 
linked to in a &quot;$first_to_$last&quot; fashion. If there are more page diretory entries than fit on a page, make a 
directory of page directories. (Iterate til page size is matched)

5. With the page directory, MediaWiki:Categoryarticlepagingcount and MediaWiki:subcategorypagingcount should  
be introduced having params $1 to $12 at least, allowing messages like: &quot;showing 678 of 12.345 page directory 
entries in category 'cats &amp; dogs', from # 679 to # 1356 at level 2, corresponding to 134.500 subcategories of 
12.345.678.987, covering subcategory # 135.600 (lions) to subcategory # 1.234.200 (eliphants)&quot;
</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-16 15:58:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Special:Allpages, Special:Categories could mention total"
   href="show_bug.cgi?id=7950">Bug 7950</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-24 02:18:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >There has been no developer commentary on this in nearly a year. Did we ever 
determine if it was indeed too expensive?

What about the new table field to keep track as discussed. 

Any thoughts Brion / Rob / Tim?</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-29 22:32:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Offhand, I might recommend changing the indexing for the categorylinks table to split up by namespace, _then_ sort key.

This would allow counting, paging, extracting etc the various namespace groups separately.
Thus category pages (subcats) and image pages (media) could be treated separately rather easily.
Other namespaces would also end up being paged separately, though, so it might take some UI
restructuring.</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Raimond Spekking</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-12 15:59:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Special:Categories should give a total count"
   href="show_bug.cgi?id=8235">Bug 8235</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-31 05:34:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >How is the 'members' data generated on [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Special%3ACategories">Special:Categories</a>]]? (<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Special:Categories : Show the number of articles in the category"
   href="show_bug.cgi?id=146">Bug 146</a>)

It seems that each category has had a SELECT COUNT(*) to build the info (<a href="show_bug.cgi?id=1212#c12">comment
#12</a>) or is this data held somewhere else in a table?

If this is indeed a COUNT(*), wouldn't this be several times more expensive
(<a href="show_bug.cgi?id=1212#c15">comment #15</a>) than just counting the number of members when looking at just ONE
category?  

Example:
<a href="http://www.marveldatabase.com/index.php?title=Special:Categories&amp;limit=500&amp;offset=500">http://www.marveldatabase.com/index.php?title=Special:Categories&amp;limit=500&amp;offset=500</a>
 - Look at the 'Characters' category with over 6,400 'members'.

<a href="http://www.marveldatabase.com/Category:Characters">http://www.marveldatabase.com/Category:Characters</a>  - Shows 'There are 200
articles in this category', when we know this is only a count of how many appear
on this page.

Could we somehow use this 'member' count to resolve this bug? 
(Don't forget this 'total count' should have a separate count for each
'articles' and 'images' in a category.)

If we can show: &quot;Character Galleries ‎(1,095 members)&quot;, then we should be able
to accurately state: &quot;There are 1,095 articles in this category&quot;...</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-31 17:42:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >There is no COUNT(*).  If there were, there would be an actual count.  ;)  As it
is, we just iterate through the returned rows in PHP until there aren't any
more, and then keep the number handy as the count of how many categories there
are.  Since we have a LIMIT clause, of course, this means the count only goes up
to the limit.

The question is whether a COUNT(*) would, in fact, be too slow.  Just nobody has
bothered to determine whether it is, apparently.  Don't look at me, I'm not
qualified.  Maybe bug Domas or something.</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-31 19:17:36 UTC
        </span>
      </div>



<pre class="bz_comment_text" >So what is the LIMIT? (10,000/100,000?) And upon what circumstance do we run
through this 'iteration'?

Furthermore, why don't we just create a field that holds this 'pseudo-count'
with each category, which gets updated with each iteration. It will behave like
a 'cache' such that the figure isn't up-to-the-second, but depending on how
often the figures are updated, it might be worthwhile...

So far, Brions idea of first splitting up by namespace, then sort key sounds
best, long-term, I think. It would substantially lighten the load for
search/counting/paging etc.

Would this take much re-working of the categorylinks table?</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-31 19:27:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1212#c29">comment #29</a>)
<span class="quote">&gt; So what is the LIMIT?</span >

The paging limit is 200.</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gunter Schmidt</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-25 21:03:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >If somebody would like to try the often diskussed question: &quot;Is select count(*) too slow?&quot;, he might want to change this code in 
CategoryPage.php. The field is indexed, so it should be rather fast.

Replace the following function (retrieved from MW 1.9.2):

function getPagesSection() {
  $dbr =&amp; wfGetDB( DB_SLAVE );
  $catCount = $dbr-&gt;selectField( 'categorylinks', 'count(*)', array('cl_to' =&gt; $this-&gt;title-&gt;getDbKey() ), 'getPagesSection');
  $ti = htmlspecialchars( $this-&gt;title-&gt;getText() );
  $r = &quot;&lt;div id=\&quot;mw-pages\&quot;&gt;\n&quot;;
  $r .= '&lt;h2&gt;' . wfMsg( 'category_header', $ti ) . &quot;&lt;/h2&gt;\n&quot;;
  $r .= wfMsgExt( 'categoryarticlecount', array( 'parse' ), $catCount );#count( $this-&gt;articles) );
  $r .= $this-&gt;formatList( $this-&gt;articles, $this-&gt;articles_start_char );
  $r .= &quot;\n&lt;/div&gt;&quot;;
  return $r;
}
</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gunter Schmidt</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-25 21:10:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Given this small change, it might be wise to add a switch to MediaWiki, like $wgFullCategoryArticleCount = true / false. This way, 
the best configuration can be set by the admin.</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-03-17 03:37:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This might be exactly what we are looking for...
Could some one please implement this?

I very much also like the idea of a switch (off by default for Wikipedia's sake, of course ;)</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-30 03:43:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Rob/Brion/et al,

Does Gunter's solution look viable?</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-05-10 17:24:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It looks viable.  See URL:

<a href="http://en.wikipedia.org/wiki/Special:Categories?offset=Living_peopla">http://en.wikipedia.org/wiki/Special:Categories?offset=Living_peopla</a>

It takes just a few seconds to load, and that's the worst possible case at
present.  Capping it at 250,000 should be fine if we're okay with a few category
pages taking an extra second or two to load.  This is assuming that the only
issue is latency.

Adding &quot;shell&quot; to flag this for sysadmins to look at for performance impact.</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-09-18 22:57:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >That page seems to load quite quickly for me and it seems to be not cached. It is taking as long as it does for all 50 categories to be looked up. One can guesstimate the performance hit to check 1 category should be fractional, comparatively.

Does the information present in this bug, above, possibly provide a feasible solution?</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamie Hari</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-09-18 22:59:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Is there any way to accurately time how long this takes from a raw query standpoint?

<a href="http://en.wikipedia.org/w/index.php?title=Special:Categories&amp;offset=Living_peopla&amp;limit=1">http://en.wikipedia.org/w/index.php?title=Special:Categories&amp;offset=Living_peopla&amp;limit=1</a></pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-09-18 23:03:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Somewhere, probably not on this laptop, I've got an uncommitted working copy of MediaWiki which effectively tracks and updates simple tallies of the number of pages in each category, and the number of subcategories, in a relatively efficient manner, by hooking into the link update process. This would make such a count theoretically trivially inexpensive.

I'll dig it out this weekend and whack a patch somewhere for further review and criticism.</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-09-18 23:11:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1212#c37">comment #37</a>)
<span class="quote">&gt; Is there any way to accurately time how long this takes from a raw query
&gt; standpoint?
&gt; 
&gt; <a href="http://en.wikipedia.org/w/index.php?title=Special:Categories&amp;offset=Living_peopla&amp;limit=1">http://en.wikipedia.org/w/index.php?title=Special:Categories&amp;offset=Living_peopla&amp;limit=1</a></span >

It takes 4.42 seconds on the toolserver to run the COUNT(*) query on Category:Living people, with 221446 rows.  A proper solution would be better.</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Greg Sabino Mullane</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-10-18 14:31:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=4268" name="attach_4268" title="Show true category counts">attachment 4268</a> <a href="attachment.cgi?id=4268&amp;action=edit" title="Show true category counts">[details]</a></span>
Show true category counts

The count(*) solution seems to work fine for me - subsecond responses as it hits the cl_sortkey index. I made the table have 1.1 million rows, and a category with 221,000 entries in it still ran in under a second. (This is for Postgres - MySQL also seemed to use the index, but was much slower about it - maybe this is better on a newer version of MySQL? I only have an early 5.0 available at the moment). Still, no reason not to make this an option for sites that don't have large categorylinks tables, but want a true count. Patch attached: although probably deprecated by Rob's future one, maybe someone else can find use of it until then.</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-09 04:31:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=4704" name="attach_4704" title="First pass at a patch (not yet ready for commit)">attachment 4704</a> <a href="attachment.cgi?id=4704&amp;action=edit" title="First pass at a patch (not yet ready for commit)">[details]</a></span>
First pass at a patch (not yet ready for commit)

This patch adds a category table, as well as a Category class.  The first application is this bug.  I've gotten the basic functionality working, in that I can successfully view a category page and get the correct count.  It needs considerable polishing, which I hope to put in tomorrow.  Ideally I'll commit it to trunk in non-scary form tomorrow (i.e., a form that allows it to require no expensive operations on Wikimedia), and persuade Brion or someone to populate it properly at some point thereafter.  However, I don't exactly trust my timetables.  :)

I've marked Greg's patch obsolete.  It would be neat if we could tolerate such large scans, because the normalized solution is of course a lot nicer, but we can't, unfortunately.  If Postgres can handle the scanning, it would be neat if it implemented the category table as a view, with the count columns running the queries transparently and ignoring manual updates.</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-10 01:49:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=4705" name="attach_4705" title="Almost-complete patch">attachment 4705</a> <a href="attachment.cgi?id=4705&amp;action=edit" title="Almost-complete patch">[details]</a></span>
Almost-complete patch

The patch is nearly complete.  Basic features:

* Adds Category and CategoryList classes to represent categories themselves.
* Adds a category table, giving each category a name, ID, and counts of all members, subcats only, and files.
* Adds an updatelog table to track DB updates that can't be inferred from the schema, and uses it to track whether the category table has been populated.
* Adds a maintenance script to populate the category table efficiently.  This script is careful to wait for slaves and should be safe to run on a live database.  The maintenance script's includes file is called by update.php.
* Until the category table is populated, the patch handles weird category table rows gracefully.  It detects whether they're obviously impossible, and if so, it outputs appropriate messages.  Sample messages:
** &quot;The following 200 pages are in this category, out of 556 total.&quot; (category table has sane entry)
** &quot;The following 158 pages are in this category, out of 158 total.&quot; (category table is ignored, since this is the full set anyway)
** &quot;The following 200 pages are in this category.&quot; (category table entry is impossible, like less than 200: no commitments as to total number)

I would like review on this before I commit it, which I would like to do by the end of next weekend at the latest.  The one major glaring blocker omission is that it totally ignores link updates: the only way to populate the category table is by running the maintenance script.  Obviously it's useless until this is fixed.  The other flaws that occurred to me I've written down as FIXMEs, some of which I just need to code a fix for and others of which I'd like comments on.  Comments from anyone are appreciated, but especially Brion, if he has the time.</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">iubito (Sylvain Machefert)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-10 06:07:56 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hello,

I'll probably test your patch, but don't know when.

Can the maintenance be run from the web, or do I need console access ?

(In reply to <a href="show_bug.cgi?id=1212#c42">comment #42</a>)
<span class="quote">&gt; * Adds a maintenance script to populate the category table efficiently.  This
&gt; script is careful to wait for slaves and should be safe to run on a live
&gt; database.  The maintenance script's includes file is called by update.php.</span >
</pre>
    </div><div id="c44" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Robert Leverington</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-10 10:17:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Console access is required for all maintenace scripts, but a PHP or Java web-based SSH\telnet client provided by your host will usually suffice.</pre>
    </div><div id="c45" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-10 23:03:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=4706" name="attach_4706" title="Same as previous attachment, with all files actually included">attachment 4706</a> <a href="attachment.cgi?id=4706&amp;action=edit" title="Same as previous attachment, with all files actually included">[details]</a></span>
Same as previous attachment, with all files actually included

I forgot to svn add a few things, whoops.</pre>
    </div><div id="c46" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-16 19:26:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=4728" name="attach_4728" title="Patch with all functionality, needs review">attachment 4728</a> <a href="attachment.cgi?id=4728&amp;action=edit" title="Patch with all functionality, needs review">[details]</a></span>
Patch with all functionality, needs review

Okay, it now updates correctly on LinksUpdate and page deletion.  I think this is it, but I really really want review from Brion or Tim before I check it in, since otherwise it will probably get reverted.</pre>
    </div><div id="c47" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Garrett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-17 05:08:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Looks good (I spent about 10 minutes reading through the code, not a substitute for thorough testing). The only immediate issue I can see is that it's not obvious whether you've considered this scenario:

The schema change is applied, and a category which does not have an already-populated row in the category table is deleted from a page. If you haven't considered that, you'd get a PHP error for trying to subtract 1 from a signed field with value 0.

Maybe I didn't pick up on that logic in your code.

Well done, by the way. It's great to see this finally fixed up.</pre>
    </div><div id="c48" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c48">Comment 48</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-17 13:20:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1212#c47">comment #47</a>)
<span class="quote">&gt; The schema change is applied, and a category which does not have an
&gt; already-populated row in the category table is deleted from a page. If you
&gt; haven't considered that, you'd get a PHP error for trying to subtract 1 from a
&gt; signed field with value 0.
&gt; 
&gt; Maybe I didn't pick up on that logic in your code.</span >

I explicitly noted that in a comment:

+		# ... If [a row for] one of the &quot;deleted&quot; [categories] didn't
+		# exist, we might legitimately not create it, but it's simpler to just
+		# create it and then give it a negative value, since the value is bogus
+		# anyway.

You may have missed that the fields are actually signed, so you'll just get -1 with no errors, since that's a perfectly valid value for a signed int.  I made it signed so that underflow errors are more obvious (as the comment in tables.sql says).

I actually thought of a better way to do the update, in a way that doesn't require explicit LOCK IN SHARE MODE, since it's all one query (but no subqueries needed either).  I'll change it to use that and then just check it in.  Hopefully any errors that are spotted are minor enough to just be fixed on the spot instead of having to back it out.</pre>
    </div><div id="c49" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1212#c49">Comment 49</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-18 00:20:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Patch committed in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/32085" title="revision 32085 in SVN">r32085</a>.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=1212&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1212">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=1212">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=1212">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=1212&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=1212" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=1212&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419358605-61nK8BoQKruOZpnfoOjVMYFFn-SkPbwOd2iNFtX7h1c">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>