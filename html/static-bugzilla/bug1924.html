<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 1924 &ndash; Restricted read access for subset of wiki</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=1924&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=1924">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=1924">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=1924">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 1924 – Restricted read access for subset of wiki",  
                             "show_bug.cgi?id=1924" );
        document.title = "Bug 1924 – Restricted read access for subset of wiki";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 1924 – Restricted read access for subset of wiki", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_CLOSED bz_product_MediaWiki bz_component_General_Unknown bz_bug_1924 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2011-03-13 18:05:05 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2011-03-13 18:05:05">
  <input type="hidden" name="longdesclength" value="143">
  <input type="hidden" name="id" value="1924">
  <input type="hidden" name="token" value="1419359699-URNDzzMre0Ml24wxa62Y5oFoPUCwUSIhgvzXGNfrewY">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=1924"><b>Bug&nbsp;1924</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Restricted read access for subset of wiki</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>Restricted read access for subset of wiki
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Restricted read access for subset of wiki', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          WONTFIX
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>General/Unknown
    
    (<a href="buglist.cgi?component=General%2FUnknown&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">All
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Lowest
       enhancement<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=1924">18 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=1924#vote_1924">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Nobody - You can work on this!</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
          <a href="http://meta.wikimedia.org/wiki/Hidden_pages"><span title="http://meta.wikimedia.org/wiki/Hidden_pages">http://meta.wikimedia.org/wiki/Hidden...
        </span></a>
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label for="duplicates">Duplicates</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - change $wgWhitelistEdit to an array"
   href="show_bug.cgi?id=784">784</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - A more advanced control over read access."
   href="show_bug.cgi?id=1740">1740</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Expanding $wgWhitelist control of anonymous read/edit"
   href="show_bug.cgi?id=2227">2227</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Allow setting group permissions per-namespace"
   href="show_bug.cgi?id=8360">8360</a> 
      </span>
      (<a href="buglist.cgi?bug_id=784,1740,2227,8360">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Access control (tracking)"
   href="show_bug.cgi?id=2422">2422</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED WONTFIX - sysop-only pages"
   href="show_bug.cgi?id=3075">3075</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=1924&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=1924">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2005-04-19 14:02 UTC by <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2011-03-13 18:05 UTC 
      (<a href="show_activity.cgi?id=1924">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>3 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="andi">andi</option>
                <option value="kristian">kristian</option>
                <option value="roland">roland</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=431"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Restricted namespace access for 1.4.1</span></b></a>

          <span class="bz_attach_extra_info">
              (22.99 KB,
                patch)

            <br>
            <a href="#attach_431"
               title="Go to the comment associated with the attachment">2005-04-19 14:04 UTC</a>,

            <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=431&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=432"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Restricted namespace access for HEAD / 1.5</span></b></a>

          <span class="bz_attach_extra_info">
              (21.64 KB,
                patch)

            <br>
            <a href="#attach_432"
               title="Go to the comment associated with the attachment">2005-04-19 14:06 UTC</a>,

            <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=432&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=433"
               title="View the content of the attachment">
          <b>Readme for the patches</b></a>

          <span class="bz_attach_extra_info">
              (1.55 KB,
                text/plain)

            <br>
            <a href="#attach_433"
               title="Go to the comment associated with the attachment">2005-04-19 14:06 UTC</a>,

            <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=433&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=490"
               title="View the content of the attachment">
          <b>Restricted namespace access for 1.4.3</b></a>

          <span class="bz_attach_extra_info">
              (27.53 KB,
                patch)

            <br>
            <a href="#attach_490"
               title="Go to the comment associated with the attachment">2005-05-03 19:32 UTC</a>,

            <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=490&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=491"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Restricted namespace access for 1.5alpha1</span></b></a>

          <span class="bz_attach_extra_info">
              (25.30 KB,
                patch)

            <br>
            <a href="#attach_491"
               title="Go to the comment associated with the attachment">2005-05-03 19:46 UTC</a>,

            <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=491&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=649"
               title="View the content of the attachment">
          <b>Updated for v1.4.5</b></a>

          <span class="bz_attach_extra_info">
              (24.19 KB,
                patch)

            <br>
            <a href="#attach_649"
               title="Go to the comment associated with the attachment">2005-06-26 07:43 UTC</a>,

            <span class="vcard"><span class="fn">Markus Meissner</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=649&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a7" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=863"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Updated for v1.5beta4</span></b></a>

          <span class="bz_attach_extra_info">
              (18.76 KB,
                patch)

            <br>
            <a href="#attach_863"
               title="Go to the comment associated with the attachment">2005-09-08 00:46 UTC</a>,

            <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=863&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a8" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=902"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Update + addons for 1.5rc4</span></b></a>

          <span class="bz_attach_extra_info">
              (23.74 KB,
                patch)

            <br>
            <a href="#attach_902"
               title="Go to the comment associated with the attachment">2005-09-20 09:55 UTC</a>,

            <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=902&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a9" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=1030"
               title="View the content of the attachment">
          <b>Diff to restrict the output of groups on the Special:Listusers page for non-sysops </b></a>

          <span class="bz_attach_extra_info">
              (403 bytes,
                text/plain)

            <br>
            <a href="#attach_1030"
               title="Go to the comment associated with the attachment">2005-10-28 11:20 UTC</a>,

            <span class="vcard"><span class="fn">Jason Riddell</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1030&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a10" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=1037"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Update + addons for 1.5.1</span></b></a>

          <span class="bz_attach_extra_info">
              (24.09 KB,
                patch)

            <br>
            <a href="#attach_1037"
               title="Go to the comment associated with the attachment">2005-11-02 00:00 UTC</a>,

            <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1037&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a11" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=1153"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Update + addons for 1.5.3</span></b></a>

          <span class="bz_attach_extra_info">
              (27.52 KB,
                patch)

            <br>
            <a href="#attach_1153"
               title="Go to the comment associated with the attachment">2005-12-08 03:48 UTC</a>,

            <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1153&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a12" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1155"
               title="View the content of the attachment">
          <b>Display Access Denied message when no namespace permission</b></a>

          <span class="bz_attach_extra_info">
              (2.54 KB,
                patch)

            <br>
            <a href="#attach_1155"
               title="Go to the comment associated with the attachment">2005-12-08 13:25 UTC</a>,

            <span class="vcard"><span class="fn">Jody Foo</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1155&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a13" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1316"
               title="View the content of the attachment">
          <b>Update + addons for 1.5.5</b></a>

          <span class="bz_attach_extra_info">
              (31.92 KB,
                patch)

            <br>
            <a href="#attach_1316"
               title="Go to the comment associated with the attachment">2006-01-18 19:04 UTC</a>,

            <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1316&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a14" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=1450"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)</span></b></a>

          <span class="bz_attach_extra_info">
              (40.23 KB,
                patch)

            <br>
            <a href="#attach_1450"
               title="Go to the comment associated with the attachment">2006-03-16 08:09 UTC</a>,

            <span class="vcard"><span class="fn">Pawel O</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1450&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a15" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1451"
               title="View the content of the attachment">
          <b>Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)</b></a>

          <span class="bz_attach_extra_info">
              (32.43 KB,
                patch)

            <br>
            <a href="#attach_1451"
               title="Go to the comment associated with the attachment">2006-03-16 08:54 UTC</a>,

            <span class="vcard"><span class="fn">Pawel O</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1451&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a16" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1508"
               title="View the content of the attachment">
          <b>Restricted namespace access on SVN/Head 2006-04-06 + Addons 1452</b></a>

          <span class="bz_attach_extra_info">
              (29.23 KB,
                patch)

            <br>
            <a href="#attach_1508"
               title="Go to the comment associated with the attachment">2006-04-07 20:24 UTC</a>,

            <span class="vcard"><span class="fn">Alfons Zitterbacke</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1508&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a17" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1598"
               title="View the content of the attachment">
          <b>Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)</b></a>

          <span class="bz_attach_extra_info">
              (40.42 KB,
                patch)

            <br>
            <a href="#attach_1598"
               title="Go to the comment associated with the attachment">2006-04-22 22:05 UTC</a>,

            <span class="vcard"><span class="fn">Andrei Cojocaru</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1598&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a18" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=1714"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Restricted namespace access for 1.6.5</span></b></a>

          <span class="bz_attach_extra_info">
              (39.54 KB,
                patch)

            <br>
            <a href="#attach_1714"
               title="Go to the comment associated with the attachment">2006-05-13 07:37 UTC</a>,

            <span class="vcard"><span class="fn">Cyril Dangerville</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1714&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a19" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1933"
               title="View the content of the attachment">
          <b>Restricted namespace access for 1.6.7 (based on 1714)</b></a>

          <span class="bz_attach_extra_info">
              (32.32 KB,
                patch)

            <br>
            <a href="#attach_1933"
               title="Go to the comment associated with the attachment">2006-06-10 23:49 UTC</a>,

            <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1933&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a20" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=2045"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Adds &quot;your namespaces&quot; to sidebar for 1.6.3.</span></b></a>

          <span class="bz_attach_extra_info">
              (1.46 KB,
                patch)

            <br>
            <a href="#attach_2045"
               title="Go to the comment associated with the attachment">2006-07-03 22:12 UTC</a>,

            <span class="vcard"><span class="fn">Dan Davis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2045&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a21" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=2046"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Adds &quot;your namespaces&quot; to sidebar for 1.6.3</span></b></a>

          <span class="bz_attach_extra_info">
              (1.60 KB,
                patch)

            <br>
            <a href="#attach_2046"
               title="Go to the comment associated with the attachment">2006-07-03 22:22 UTC</a>,

            <span class="vcard"><span class="fn">Dan Davis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2046&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a22" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=2081"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)</span></b></a>

          <span class="bz_attach_extra_info">
              (39.22 KB,
                patch)

            <br>
            <a href="#attach_2081"
               title="Go to the comment associated with the attachment">2006-07-13 18:17 UTC</a>,

            <span class="vcard"><span class="fn">Dan Davis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2081&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a23" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=2082"
               title="View the content of the attachment">
          <b>Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)</b></a>

          <span class="bz_attach_extra_info">
              (39.88 KB,
                patch)

            <br>
            <a href="#attach_2082"
               title="Go to the comment associated with the attachment">2006-07-13 18:30 UTC</a>,

            <span class="vcard"><span class="fn">Dan Davis</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2082&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a24" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=2667"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Updated for 2082 for 1.8.2</span></b></a>

          <span class="bz_attach_extra_info">
              (42.38 KB,
                patch)

            <br>
            <a href="#attach_2667"
               title="Go to the comment associated with the attachment">2006-11-09 22:21 UTC</a>,

            <span class="vcard"><span class="fn">Joseph Southwell</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2667&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a25" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=2838"
               title="View the content of the attachment">
          <b>Updated for 1.8.2 (two bugs fixed)</b></a>

          <span class="bz_attach_extra_info">
              (38.88 KB,
                patch)

            <br>
            <a href="#attach_2838"
               title="Go to the comment associated with the attachment">2006-12-08 09:33 UTC</a>,

            <span class="vcard"><span class="fn">Noel</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=2838&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (13)
        </span>
        <a href="attachment.cgi?bugid=1924&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-19 14:02:24 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It should be possible to restrict read access for a subset of the wiki pages to
specific users. This might not be necessary for Wikipedia, but is essential for
company wikis. 

This enhancement has been brought up before on sourceforge. 

References to related requests:
<a href="http://bugzilla.wikipedia.org/show_bug.cgi?id=1740">http://bugzilla.wikipedia.org/show_bug.cgi?id=1740</a>
<a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=979095&amp;group_id=34373&amp;atid=411195">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=979095&amp;group_id=34373&amp;atid=411195</a>
<a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1014562&amp;group_id=34373&amp;atid=411195">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1014562&amp;group_id=34373&amp;atid=411195</a></pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-19 14:04:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=431" name="attach_431" title="Restricted namespace access for 1.4.1">attachment 431</a> <a href="attachment.cgi?id=431&amp;action=edit" title="Restricted namespace access for 1.4.1">[details]</a></span>
Restricted namespace access for 1.4.1

This patch makes it possible to restrict read access to namespaces. See readme
for details.</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-19 14:06:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=432" name="attach_432" title="Restricted namespace access for HEAD / 1.5">attachment 432</a> <a href="attachment.cgi?id=432&amp;action=edit" title="Restricted namespace access for HEAD / 1.5">[details]</a></span>
Restricted namespace access for HEAD / 1.5

Patch for HEAD. See readme for details</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-19 14:06:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=433" name="attach_433" title="Readme for the patches">attachment 433</a> <a href="attachment.cgi?id=433&amp;action=edit" title="Readme for the patches">[details]</a></span>
Readme for the patches</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-19 14:12:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Possible solution:
- Read access is limited on a per-namespace basis
- Only user defined namespaces (&gt; 100) can be restricted

See also <a href="http://meta.wikimedia.org/wiki/Hidden_pages">http://meta.wikimedia.org/wiki/Hidden_pages</a> </pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-05-03 19:32:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=490" name="attach_490" title="Restricted namespace access for 1.4.3">attachment 490</a> <a href="attachment.cgi?id=490&amp;action=edit" title="Restricted namespace access for 1.4.3">[details]</a></span>
Restricted namespace access for 1.4.3

Update for 1.4.3.

Fixes:
- Moves of restricted pages are now blocked for non-authorized users
- It is possible to disable logging to RecentChanges, so protecting or deleting
restricted pages is not visible to the world. See DefaultSettings.php
- The RSS feed is no longer cached when restricted pages are in effect, so each
user sees the changes according to his restrictions</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">MaPhi Werner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-05-03 19:46:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=491" name="attach_491" title="Restricted namespace access for 1.5alpha1">attachment 491</a> <a href="attachment.cgi?id=491&amp;action=edit" title="Restricted namespace access for 1.5alpha1">[details]</a></span>
Restricted namespace access for 1.5alpha1

Update for 1.5alpha1

Fixes:
- Moves of restricted pages are now blocked for non-authorized users
- It is possible to disable logging to RecentChanges, so protecting or deleting

restricted pages is not visible to the world. See DefaultSettings.php
- The RSS feed is no longer cached when restricted pages are in effect, so each

user sees the changes according to his restrictions

Note: 
My production wiki runs under 1.4.3 at the moment, so the 1.5 version of the
patch does not see much testing at the moment.</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Paul</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-24 15:23:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This is something I really wish could get put in 1.5(or support put in so it
could be easily implemented with an extension). This is a very important feature
for semi-private wikis</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-25 00:17:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - A more advanced control over read access."
   href="show_bug.cgi?id=1740">Bug 1740</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-25 00:18:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Expanding $wgWhitelist control of anonymous read/edit"
   href="show_bug.cgi?id=2227">Bug 2227</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-25 00:21:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - change $wgWhitelistEdit to an array"
   href="show_bug.cgi?id=784">Bug 784</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Markus Meissner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-06-26 07:43:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=649" name="attach_649" title="Updated for v1.4.5">attachment 649</a> <a href="attachment.cgi?id=649&amp;action=edit" title="Updated for v1.4.5">[details]</a></span>
Updated for v1.4.5

Applied the above patch (id=490) to the 1.4.5 sources. Apply with 
cd mediawiki-1.4.5
patch -p1 &lt; rra-1.4.5.patch

Note that if you are using php &lt; 4.2 (e.g. Debain Woody) you can use
<a href="http://pear.php.net/package/PHP_Compat">http://pear.php.net/package/PHP_Compat</a> to have the function var_export which is
required by the patch.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Zigger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-07-10 06:43:03 UTC
        </span>
      </div>



<pre class="bz_comment_text" >See also <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Default page restrictions for each namespace"
   href="show_bug.cgi?id=2073">bug 2073</a> (Default page restrictions for each namespace), which also has
patches.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Frédéric Bonnaud</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-08-23 10:01:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >the patch for 1.5alpha1 doesn't work any more with 1.5beta4 </pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-08 00:46:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=863" name="attach_863" title="Updated for v1.5beta4">attachment 863</a> <a href="attachment.cgi?id=863&amp;action=edit" title="Updated for v1.5beta4">[details]</a></span>
Updated for v1.5beta4

It worked for me, should work for rc4 too. (Sorry for the poor diff stuff, it's
my first patch and i had some probs with cvs so i created it localy, should
apply corectly using &quot;patch -p0 &lt; patch&quot; ).</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-08 00:51:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=863" name="attach_863" title="Updated for v1.5beta4">attachment 863</a> <a href="attachment.cgi?id=863&amp;action=edit" title="Updated for v1.5beta4">[details]</a></span>
Updated for v1.5beta4

Changes:

-less use of foreach

-less sql query tweaks</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sider</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-13 09:33:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Your patch '<span class="bz_obsolete"><a href="attachment.cgi?id=863" name="attach_863" title="Updated for v1.5beta4">attachment 863</a> <a href="attachment.cgi?id=863&amp;action=edit" title="Updated for v1.5beta4">[details]</a></span>' doesn't seem to work, i tried on v1.5beta3 and 
v1.5beta4 with cygwin patching utility, thats whats it reported:

$ patch -p0 &lt; patch.diff
(Stripping trailing CRs from patch.)
patching file includes/CategoryPage.php
(Stripping trailing CRs from patch.)
patching file includes/DefaultSettings.php
Hunk #1 succeeded at 1328 (offset 8 lines).
(Stripping trailing CRs from patch.)
patching file includes/LogPage.php
(Stripping trailing CRs from patch.)
patching file includes/Parser.php
Hunk #1 succeeded at 2061 (offset 8 lines).
Hunk #2 succeeded at 2225 (offset 8 lines).
(Stripping trailing CRs from patch.)
patching file includes/SearchEngine.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialAllpages.php
Hunk #3 FAILED at 44.
Hunk #4 succeeded at 184 (offset -9 lines).
1 out of 4 hunks FAILED -- saving rejects to file includes/SpecialAllpages.php.r
ej
(Stripping trailing CRs from patch.)
patching file includes/SpecialContributions.php
Hunk #5 FAILED at 265.
1 out of 5 hunks FAILED -- saving rejects to file includes/SpecialContributions.
php.rej
(Stripping trailing CRs from patch.)
patching file includes/SpecialExport.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialLog.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialPreferences.php
Hunk #2 succeeded at 89 (offset 1 line).
Hunk #3 succeeded at 352 (offset 14 lines).
Hunk #4 succeeded at 369 (offset 14 lines).
(Stripping trailing CRs from patch.)
patching file includes/SpecialRecentchanges.php
Hunk #3 FAILED at 133.
Hunk #4 succeeded at 248 (offset 1 line).
Hunk #5 succeeded at 277 (offset 1 line).
1 out of 5 hunks FAILED -- saving rejects to file includes/SpecialRecentchanges.
php.rej
(Stripping trailing CRs from patch.)
patching file includes/SpecialRecentchangeslinked.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialWantedpages.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialWhatlinkshere.php
(Stripping trailing CRs from patch.)
patching file includes/Title.php
Hunk #1 succeeded at 998 (offset 1 line).
Hunk #2 succeeded at 1012 (offset 1 line).
(Stripping trailing CRs from patch.)
patching file includes/User.php
patch unexpectedly ends in middle of line
Hunk #1 succeeded at 1018 with fuzz 1.</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sider</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-13 09:34:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Sorry, i forgot to say that this was the report for v1.5beta4.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sider</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-13 11:30:57 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The report for v1.5beta3:

$ patch -p0 &lt; patch3.diff
missing header for unified diff at line 3 of patch
(Stripping trailing CRs from patch.)
patching file includes/CategoryPage.php
(Stripping trailing CRs from patch.)
patching file includes/DefaultSettings.php
Hunk #1 succeeded at 1293 (offset -27 lines).
(Stripping trailing CRs from patch.)
patching file includes/LogPage.php
Hunk #1 succeeded at 64 (offset -5 lines).
(Stripping trailing CRs from patch.)
patching file includes/Parser.php
Hunk #1 succeeded at 2050 (offset -3 lines).
Hunk #2 succeeded at 2214 (offset -3 lines).
(Stripping trailing CRs from patch.)
patching file includes/SearchEngine.php
Hunk #1 succeeded at 137 (offset -13 lines).
(Stripping trailing CRs from patch.)
patching file includes/SpecialAllpages.php
Hunk #1 succeeded at 9 with fuzz 2.
Hunk #2 succeeded at 20 with fuzz 1 (offset 1 line).
Hunk #3 FAILED at 45.
Hunk #4 FAILED at 194.
2 out of 4 hunks FAILED -- saving rejects to file includes
ej
(Stripping trailing CRs from patch.)
patching file includes/SpecialContributions.php
Hunk #1 FAILED at 16.
Hunk #2 FAILED at 74.
Hunk #3 succeeded at 101 (offset -21 lines).
Hunk #4 FAILED at 126.
Hunk #5 FAILED at 244.
4 out of 5 hunks FAILED -- saving rejects to file includes
php.rej
(Stripping trailing CRs from patch.)
patching file includes/SpecialExport.php
Hunk #2 succeeded at 307 (offset -8 lines).
(Stripping trailing CRs from patch.)
patching file includes/SpecialLog.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialPreferences.php
Hunk #1 FAILED at 37.
Hunk #3 succeeded at 329 (offset -9 lines).
Hunk #4 succeeded at 346 (offset -9 lines).
1 out of 4 hunks FAILED -- saving rejects to file includes
p.rej
(Stripping trailing CRs from patch.)
patching file includes/SpecialRecentchanges.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialRecentchangeslinked.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialWantedpages.php
(Stripping trailing CRs from patch.)
patching file includes/SpecialWhatlinkshere.php
(Stripping trailing CRs from patch.)
patching file includes/Title.php
Hunk #1 succeeded at 977 (offset -20 lines).
Hunk #2 succeeded at 991 (offset -20 lines).
(Stripping trailing CRs from patch.)
patching file includes/User.php
patch unexpectedly ends in middle of line
Hunk #1 succeeded at 998 with fuzz 1 (offset -20 lines).</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-13 13:49:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Weird, i Just tried that on a pure 1.5beta4 ,

mathematix:/home/mick# tar xvzf mediawiki-1.5beta4.tar.gz
...
mathematix:/home/mick/mediawiki-1.5beta4# patch -p0
&lt;/var/www/wiki/restrict_access.patch
patching file includes/CategoryPage.php
patching file includes/DefaultSettings.php
patching file includes/LogPage.php
patching file includes/Parser.php
patching file includes/SearchEngine.php
patching file includes/SpecialAllpages.php
patching file includes/SpecialContributions.php
patching file includes/SpecialExport.php
patching file includes/SpecialLog.php
patching file includes/SpecialPreferences.php
patching file includes/SpecialRecentchanges.php
patching file includes/SpecialRecentchangeslinked.php
patching file includes/SpecialWantedpages.php
patching file includes/SpecialWhatlinkshere.php
patching file includes/Title.php
patching file includes/User.php
mathematix:/home/mick/mediawiki-1.5beta4#

Are you sure you haven't applied any other patch on the source ?

If the patching stuff doesn't work you can do it by hand (see the patch file and
you'll get the picture), also the errors you get are for some special pages, the
main stuff (user.php, title.php, parser.php) seems to be o.k. (that means that
the user want be able to read or edit any page in the namespace) try patching
these special pages by hand (so that the user want be able to see the references
to the namespace on those special pages).

If you have trouble with that, mail me the php files that have probs
(SpecialAllpages, SpecialContributions, SpecialRecentpages etc) and I'll try to
patch them for u...

Mick</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sider</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-14 10:17:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Erm..sorry i just discovered that the report in #16 is based on MW 1.5 rc4. 

It would be very nice for me if i had a patch for MW 1.5 beta3 because my wikis
run this version and any changing of this would increase my lack of time. ;-) 

So I will mail you the files to patch now.</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-14 21:33:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >You got Mail ;-) Hope it works (couldn't test it)...

I 'll make a patch for rc4 soon, stay tuned...

Mick</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-20 09:55:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=902" name="attach_902" title="Update + addons for 1.5rc4">attachment 902</a> <a href="attachment.cgi?id=902&amp;action=edit" title="Update + addons for 1.5rc4">[details]</a></span>
Update + addons for 1.5rc4

Changes...

* More examples in configuration

* No tweaking on the way logs are kept, just the way they show up. The feature
of disabling the logging in Recent chancges has been replaced by a better
(IMHO) way of hiding the desired logs in both Recent Changes and Special:Log.
Now an array of the log types to be hidden exist:

&lt;i&gt;Logs in Recent Changes are treated all the same, so normaly users will be
able
to see moves, protects and deletes of pages in restricted namespaces. Setting
this var to true will hide all logs in Recent Changes and only those for
restricted namespaces in Special:Log.

$wgHideLogs = false;

In case you want to customize what logs the user can see both in Recent Changes

and Special:Log, modify this array to include the log types you want to
hide.This is overriden by $wgHideLogs for Recent Changes and those logs for
restricted namespaces in Special:Log. This feature lets you hide also the
'block' and 'rights' log types that are namespace independed in Special:Log, or
show them in RC while hiding the rest.
&lt;/i&gt;

* Cleaned a lot of useless stuff from the previous patch.

* In some cases of custom log hiding it might get slower e.g if you want to
hide them all, use the $wgHideLogs, don't fill up the array, the more stuff the
array has the slower it gets (but not too slow).


Addons...

* In case you have categories of pages located on a restricted namespace those
categories will appear empty and might be comfusing. So now there is a way to
hide category edits etc in RC.

* In case some user tries to create a link from some namespace to an other
restricted namespace, while the page gets parsed, instead of the link, a
warning message will appear ('restrlink') to let the user know. If the link is
in the same namespace as the edited page, no check will be done.

Tested and worked for me, for probs make a comment or mail me.

Hope u like it (and sorry for my poor english ;-) )
Nick</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JDPorter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-25 20:06:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Patch for 1.5rc4 installed &amp; works flawlessly</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JDPorter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-25 20:39:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Suggestion: Patch replaceInternalLinks in parser.php to render restricted links
as plaintext for unpriviledged users.</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-25 20:53:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >That can't be done because parser runs every time you save or edit the document
(it's better that way, imagine the load if every time a user requests a page
that page was re-parsed). So no per user check can be done in parser, the only
thing i could think off is the warning thingie. Thanx for the feedback !!! :-)</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">lɛʁi לערי ריינהארט</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-05 17:14:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >pair of bugs

*read privilege* <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED WONTFIX - Restricted read access for subset of wiki"
   href="show_bug.cgi?id=1924">bug 1924</a>: Restricted read access for subset of wiki
*edit privilege* <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED WONTFIX - Editing mediawiki so only certain users can edit certain pages"
   href="show_bug.cgi?id=679">bug 679</a>: Editing mediawiki so only certain users can edit
certain pages
</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Paul</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-10 16:25:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Patch applied against the 1.5 release - successful and so far working perfectly.
Great job. Is there any chance this patch can be considered for inclusion into
MediaWiki?</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-10 22:06:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Highly unlikely that it would be implemented as anything other than an
extension. MediaWiki is a wiki engine, not a document management system; we tend
to take to the wiki philosophy that all users should be free to edit everything.</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nathan Koren</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 15:58:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This is a very much-needed patch; thank you for creating it!  However, it isn't
working for me.  I successfully patched it to 1.5.0, and have created an extra
namespace thusly:

$wgExtraNamespaces =
	array(100 =&gt; &quot;Chronology&quot;,
	      101 =&gt; &quot;Chronology_Talk&quot;,
	      102 =&gt; &quot;AlumniDB&quot;,
	      103 =&gt; &quot;AlumniDB_Talk&quot;
	      );

Then I created a group like this, and made myself a member of it:

$wgGroupPermissions['DB_Manager']['read'] = true;
$wgGroupPermissions['DB_Manager']['edit'] = true;

And finally I restrict the namespace:

$wgRestrictedNamespaces = 
	array(102 =&gt; array (&quot;DB_Manager&quot;), 103 =&gt; array (&quot;DB_Manager&quot;));

However, whenever I go to the namespace, I get an error page with this message:

&quot;Login Required

 You must login to view other pages.

 Return to Main Page.&quot;

What am I doing wrong?  I have tried restricting the namespace to &quot;sysop&quot; and
even &quot;user&quot;, but always to the same effect.  If somebody could help me with
this, I'd be most appreciative.

By the way... I'm setting up this wiki to provide services for an alumni group
of about 7,000 people.  All of them will have access to the wiki.  However, we
are also developing a database of the alumni, with a lot of very sensitive
personal information in it.  The wiki is, naturally, the perfect medium for
collaboration between the smaller group of DB developers, however the
information they are working with should OBVIOUSLY not be publically available
for every mass-marketer and stalker-ex to collect.  Hence the acute need for
this kind of restricted namespace function.  If the &quot;wiki philosophy&quot; can't
accommodate this reality, then the wiki philosophy is flat-out WRONG.</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JDPorter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 16:25:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Nathan,
I've done something quite similar for my own school. Set up your permissions thusly:
 $wgGroupPermissions['DB_Manager']['AlumniDB']= true;
 $wgGroupPermissions['DB_Manager']['AlumniDB_talk']= true;
You see? User group, then restricted namespace.</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nathan Koren</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 16:43:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi JDPorter,
Thanks for the reply; alas, doing this has no effect.  Any other suggestions?</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 19:27:27 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Try this...

$wgExtraNamespaces =
array(100 =&gt; &quot;Chronology&quot;,
101 =&gt; &quot;Chronology_Talk&quot;,
102 =&gt; &quot;AlumniDB&quot;,
103 =&gt; &quot;AlumniDB_Talk&quot;
);

You have created the extra namespaces and the group fine but remember that u
don't asign namespaces to user groups but to user rights (so more user groups
with the same right can have access to restricted namespaces).

$wgGroupPermissions['DB_Manager']['read'] = true;
$wgGroupPermissions['DB_Manager']['edit'] = true;

So u need to asign a new right to the user group, let's say &quot;Manager&quot;...

$wgGroupPermissions['Db_Manager']['Manager'] = true;

And finally restrict the namespace to the user groups with the &quot;Manager&quot; right
(note the way you enter values to the array, it's different from 1.4 patch
described in the &quot;Hidden pages&quot; wiki page  - plz someone with better English
skills edit it):

$wgRestrictedNamespaces = array(102 =&gt; 'Manager', 103 =&gt; 'Manager');

This should be fine :-)</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nathan Koren</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 21:54:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi Nick,

Thanks for the help.  Unfortunately, this approach isn't working either. :-( 
Does anybody have an example of a LocalSettings.php file that works under
Mediawiki 1.5.0 that I could duplicate, and then then modify for my own needs?

Thanks!</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Paul</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-11 23:10:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Nathan,

This is the relevant section of LocalSettings.php from my wiki, with info
anonymized. Basic idea is to clear all permissions on everything, setup arrays
with the permissions you want for certain groups, and then apply the permissions
to all:

$wgExtraNamespaces = array(100 =&gt; &quot;test1&quot;, 101 =&gt; &quot;test1_Talk&quot;,
                           102 =&gt; &quot;test2&quot;, 103 =&gt; &quot;test2_Talk&quot;,
                           104 =&gt; &quot;test3&quot;, 105 =&gt; &quot;test3_Talk&quot;);

$wgRestrictedNamespaces = array(104 =&gt; &quot;TT_NS1&quot;, 105 =&gt; &quot;TT_NS2&quot;);


$vips = array(&quot;group1&quot;, &quot;group2&quot;, &quot;group3&quot;);
$vip_privs = array(&quot;block&quot;, &quot;checkuser&quot;, &quot;createaccount&quot;, &quot;delete&quot;, &quot;edit&quot;,
&quot;editinterface&quot;, &quot;import&quot;, &quot;importupload&quot;, &quot;move&quot;, &quot;patrol&quot;,
                        &quot;protect&quot;, &quot;checkuser&quot;, &quot;read&quot;, &quot;renameuser&quot;, &quot;upload&quot;,
&quot;userrights&quot;, &quot;TT_NS1&quot;, &quot;TT_NS2&quot;);

$peons = array(&quot;low_group1&quot;, &quot;low_group2&quot;, &quot;low_group3&quot;);
$peon_privs = array(&quot;edit&quot;, &quot;read&quot;, &quot;upload&quot;);

$wgGroupPermissions = array(); // clear everyone's permissions to everything

foreach($peons as $peon)
        foreach($peon_privs as $peon_priv)
                $wgGroupPermissions[$peon][$peon_priv] = true;
foreach($vips as $vip)
        foreach($vip_privs as $vip_priv)
                $wgGroupPermissions[$vip][$vip_priv] = true;</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Christian Preuner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-17 11:42:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Can somebody post the patch for the 1.5 release?
If i apply the patch, i get this output:

patch &lt; wikipatch -p0
patching file includes/CategoryPage.php
patching file includes/DefaultSettings.php
Hunk #1 succeeded at 1331 (offset 11 lines).
patching file includes/LogPage.php
patching file includes/Parser.php
Hunk #1 succeeded at 2062 (offset 9 lines).
Hunk #2 succeeded at 2226 (offset 9 lines).
patching file includes/SearchEngine.php
patching file includes/SpecialAllpages.php
Hunk #3 FAILED at 44.
Hunk #4 succeeded at 184 (offset -9 lines).
1 out of 4 hunks FAILED -- saving rejects to file includes/SpecialAllpages.php.rej
patching file includes/SpecialContributions.php
Hunk #5 FAILED at 265.
1 out of 5 hunks FAILED -- saving rejects to file
includes/SpecialContributions.php.rej
patching file includes/SpecialExport.php
patching file includes/SpecialLog.php
patching file includes/SpecialPreferences.php
Hunk #2 succeeded at 89 (offset 1 line).
Hunk #3 succeeded at 352 (offset 14 lines).
Hunk #4 succeeded at 369 (offset 14 lines).
patching file includes/SpecialRecentchanges.php
Hunk #3 FAILED at 133.
Hunk #4 succeeded at 248 (offset 1 line).
Hunk #5 succeeded at 277 (offset 1 line).
1 out of 5 hunks FAILED -- saving rejects to file
includes/SpecialRecentchanges.php.rej
patching file includes/SpecialRecentchangeslinked.php
patching file includes/SpecialWantedpages.php
patching file includes/SpecialWhatlinkshere.php
patching file includes/Title.php
Hunk #1 succeeded at 998 (offset 1 line).
Hunk #2 succeeded at 1012 (offset 1 line).
patching file includes/User.php
</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matt Shepherd</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-27 15:18:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Nathan,

The problem you are having is probably due to you setting
$wgRestrictedNamespaces and (possibly or) $wgExtraNamespaces AFTER you've set
$wgPermissions.

i.e., try moving the $wgRestrictedNamespaces and $wgExtraNamespaces blocks to a
location in the file above $wgPermissions.

By doing this, I got it working on 1.5.1.

I don't know if this causes other problems, but it is most likely the cause of
the problem you're experiencing.

--Matt Shepherd</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matt Shepherd</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-27 16:42:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I take that back..  I'm not able to restrict the viewing of pages by group
simply using $wgExtraNamespaces, $wgRestrictedNamespaces, $wgPermissions.</pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jason Riddell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-28 11:20:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1030" name="attach_1030" title="Diff to restrict the output of groups on the Special:Listusers page for non-sysops">attachment 1030</a> <a href="attachment.cgi?id=1030&amp;action=edit" title="Diff to restrict the output of groups on the Special:Listusers page for non-sysops">[details]</a></span>
Diff to restrict the output of groups on the Special:Listusers page for non-sysops 

This is a diff of the changes I have made to restrict the visibility of groups
to non-sysop users. The patch makes the drop down user group select and the
users current groups not be displayed for anyone who isn't a sysop. There is
probably a more elegant way of doing this but this method suited my needs,
uploading it as it maybe useful for others who need are using groups to
restrict namespaces and don't want them visible to all.

Thanks,
Jason.</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jason Riddell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-10-28 11:23:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Oops, forgot to say the diff is against MediaWiki 1.5.1 and the restricted
namespace patch installed and is working just fine.

Jason.</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-02 00:00:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=1037" name="attach_1037" title="Update + addons for 1.5.1">attachment 1037</a> <a href="attachment.cgi?id=1037&amp;action=edit" title="Update + addons for 1.5.1">[details]</a></span>
Update + addons for 1.5.1

New Features added:

Now it's possible to restrict editing in public namespaces (those readable by
anyone) and allow editing only in restricted namespaces (only those locked to
the usergroup). Two new rights added for this, the 'sedit' right which allows
the user to edit in the restricted namespaces he has access to and the 'talk'
right which allows the user to edit talk pages.

So you can allow someone to edit only talk pages or only private pages or both
and don't give him the 'edit' right to edit public pages.

Have Fun :-)

Mick</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-02 00:03:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Note: Jason's patch should work fine with the new patch (couldn't test it).

Nick</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mark Bober</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-02 18:31:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >
Is there any method within this for opening up a namespace to public reads and
talks, but limiting edits to a group?

I'd expect the proper solution would be a wgLimitedNamespaces array alongside
wgRestrictedNamespaces, that grants 'read' and/or 'talk' access to a listed
namespace for '*', and edit to those with the named right?

The #40 comment seems to hold really close to what I'm looking for, Nick, it
almost just needs to be reversed (edit public and Restricted namespaces as
usual, read/talk in namespaces the user *doesn't* have access to, if defined).

I'm setting up a departmental Wiki here, and I'd like the user's options to be:

1) Public Wiki default namespace, editable by all users, readable by world
2) Public Wiki group namespaces, editable by user groups, readable/talkable by world
3) Private Wiki namespaces, as this patch provides.

#2 solves to problem of wanting to set up multiple, seperate Wikis for each group.

Thanks!

Mark
</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-03 00:03:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I guess you are looking for the right combination of priviledges.

1)
$wgGroupPermissions['*']['read'] = true;
$wgGroupPermissions['*']['talk'] = true;
$wgGroupPermissions['user']['edit'] = true;

2)This can't be done because restricted namespaces (locked to groups) are hidden
from anyone who doesn't have access to them (no read access), they are not
public. However you can allow 'talk' to users (that means they won't be able to
read the namespace but they will be able to read and edit namespace_talk). I
sugest you keep a public namespace (main)in which finished pages from resticted
namespaces end up (e.g. you write a page in the restricted/hidden namespace and
then you protect it -no further editing possible- and move it to the public
namespace so anyone can read it and talk for it). This is a nice feature you are
asking, if I can find some time I'll see what i can do, maybe an 'sread' right
is what we want.

In my case in PA.SO.K. we want to have a public namespace in which we will place
all of our finished pages for reading/talking, and have a pivate/hidden
namespace for each group to work independently. Each group has a group admin
that moves the pages from the private namespace to the public when they are
ready. Group users have the 'sedit' right instead of the 'edit' and group admins
have the 'edit' right.</pre>
    </div><div id="c44" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Vinh Vu</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-03 22:31:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Would this patch work if I use LDAP for authentication?
<a href="http://meta.wikimedia.org/wiki/LDAP_Authentication">http://meta.wikimedia.org/wiki/LDAP_Authentication</a>

If you have implemented it could you please share some of the troubles that you
might have gone through?

Thanks,
Vinh</pre>
    </div><div id="c45" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">christian</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-04 09:27:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hello, I used to patch on mediawiki 1.5.2 and it seems to work ok apart from
this error I keep getting:

Warning:in_array() [function.in-array]: Wrong datatype for second argument in
mediawiki/includes/User.php on line 1046

There was also an error about wrong datatype where it assumed a constant, I
fixed that by adding quotes around 'edit' on line 1045 in User.php

Does anyone have any clue on how to solve the issues?

Thanks, 
Christian
</pre>
    </div><div id="c46" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">christian</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-04 09:51:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I think I 'fixed' it already. I had to add the variables to the config file for
it to work :)</pre>
    </div><div id="c47" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JiangXin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-05 06:44:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c45">comment #45</a>)
<span class="quote">&gt; I keep getting:Warning:in_array() [function.in-array]: </span >

add $wgRestrictedNamespaces = NULL to config file, warning also exisit there. 
Fixed like that:
+    if( is_array( $wgRestrictedNamespaces ))
+    {
         if( in_array($ns, $wgRestrictedNamespaces) &amp;&amp; $this-&gt;canAccessNamespace($ns) ) {
                  if( ($action == edit) &amp;&amp; (in_array('sedit', $this-&gt;mRights)) ) {
                           return true;
                  }
         }
+    }
</pre>
    </div><div id="c48" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c48">Comment 48</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Torsten Schmidt</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-17 10:17:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt;&gt; Created an attachment (id=1037) [edit]
&gt;&gt; Update + addons for 1.5.1</span >

i've installed this patch on 1.5.0 and it works, thanks for this patch Nick.

one question to the message being displayed, if an unauthorized user trys to
access a restricted ns:

i get the following text (translated from the german version):

----
Login required!
you have to [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Special%3AUserLogin">Special:UserLogin</a>]] to view other pages.
Back to [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Mainpage">Mainpage</a>]]
----

this doesn't make so much sense.
how could i change this message to something like: 
you don't have the Right to view this page. / you're not allowed to view this page.

Thanks in advance.
Torsten</pre>
    </div><div id="c49" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c49">Comment 49</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-20 15:15:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Special:Allmessages</pre>
    </div><div id="c50" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c50">Comment 50</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-21 21:36:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I found a bug in the implementation of 'sedit' right, it seems that it doesn't work.

To fix that go to includes/User.php line 1047 and change

if( in_array($ns,$wgRestrictedNamespaces) &amp;&amp; $this-&gt;canAccessNamespace($ns) ) {

to 

if( $this-&gt;canAccessNamespace($ns) ) {

Also do what JiangXin sugests.

Sorry ppl, i didn't test that feature well :-(

A new patch is almost ready, I' ll release it soon..

Nick</pre>
    </div><div id="c51" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c51">Comment 51</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-21 21:44:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >also change 

if( ($action == edit) &amp;&amp; (in_array('sedit', $this-&gt;mRights)) ) {

to

if( !$title-&gt;isProtected() &amp;&amp; ($action == edit) &amp;&amp; (in_array('sedit',
$this-&gt;mRights)) ) {

so that protected pages inside restricted namespaces are not editable

Nick</pre>
    </div><div id="c52" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c52">Comment 52</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Donn Morrison</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-27 22:25:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Is it possible with this patch to have a namespace read-only for certain users?
I'd still like to have the namespace restricted for editing, but don't want the
restricted pages hidden from everyone.</pre>
    </div><div id="c53" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c53">Comment 53</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">christian</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-28 12:57:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I use this patch on 1.5.0 and it works likes a charm. 
Now I would like to use a custom authentication scheme using my own extension of
the AuthPlugin interface. However the wiki doesn't seem to respond to any
changes I make to the custom authentication class.
Is it still possible to extend this interface after using this plugin?</pre>
    </div><div id="c54" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c54">Comment 54</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">C. Filipe Medeiros</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-03 00:49:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I'm having a problem with this patch on 1.5.2. This is the setup I have:

$wgExtraNamespaces = array(
  100 =&gt; 'Code',
  101 =&gt; 'Skinne',
  102 =&gt; 'SLF',
  103 =&gt; 'Content'
  );

$wgRestrictedNamespaces = array(
  100 =&gt; array('coder'),
  101 =&gt; array('projectskinne'),
  102 =&gt; array('projectslf'),
  103 =&gt; array('content')
);

// Permissions
// &quot;Code&quot; Namespace
$wgGroupPermissions['sysop']['Code'] = true;
$wgGroupPermissions['coder']['Code'] = true;

// &quot;Skinne&quot; Project Namespace
$wgGroupPermissions['sysop']['Skinne'] = true;
$wgGroupPermissions['projectskinne']['Skinne'] = true;

// &quot;SLF&quot; Project Namespace (SportLegsFan.com)
$wgGroupPermissions['sysop']['SLF'] = true;
$wgGroupPermissions['projectslf']['SLF'] = true;

// &quot;Content&quot; namespace
$wgGroupPermissions['sysop']['Content'] = true;
$wgGroupPermissions['content']['Content'] = true;


When I try to access [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Code%3AMain">Code:Main</a>]] it asks me to login (when I am already logged
in).

When I try to Move a page to Code:Main, it returns an error on the same page
saying &quot;Protected Page&quot;</pre>
    </div><div id="c55" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c55">Comment 55</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-03 08:57:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Try this...

$wgExtraNamespaces = array(
100 =&gt; 'Code',
101 =&gt; 'Code_talk',
102 =&gt; 'Skinne',
103 =&gt; 'Skinne_talk',
104 =&gt; 'SLF',
105 =&gt; 'SLF_talk',
106 =&gt; 'Content'
107 =&gt; 'Content_talk'
);

$wgRestrictedNamespaces = array(
100 =&gt; 'coder',
102 =&gt; 'projectskinne',
104 =&gt; 'projectslf',
106 =&gt; 'content'
);

// Permissions
// &quot;Code&quot; Namespace
$wgGroupPermissions['sysop']['coder'] = true;
$wgGroupPermissions['coder']['coder'] = true;

// &quot;Skinne&quot; Project Namespace
$wgGroupPermissions['sysop']['projectskinne'] = true;
$wgGroupPermissions['projectskinne']['projectskinne'] = true;

// &quot;SLF&quot; Project Namespace (SportLegsFan.com)
$wgGroupPermissions['sysop']['projectslf'] = true;
$wgGroupPermissions['projectslf']['projectslf'] = true;

// &quot;Content&quot; namespace
$wgGroupPermissions['sysop']['Content'] = true;
$wgGroupPermissions['content']['content'] = true;

Read the DefaultSettings.php and you 'll find examples there, also read the 
previous messages here.

a) You asign a namespace to a right in $wgRestrictedNamespaces 
($wgRestrictedNamespaces = array(100=&gt;'coolguy')).
b) You asign the right to a usergroup ($wgGroupPermissions['User_group']
['coolguy'] = true;
c) Always create the talk namespaces because the way you have made your 
configuration Skinne is the talk namespace of Code and Content is the talk 
namespace of SLF.

Nick</pre>
    </div><div id="c56" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c56">Comment 56</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-03 08:58:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The new patch for 1.5.2 will probably be ready on Thuesday, it will have a new feature for read 
only namespaces (that are not hidden in the logs) and a few bugfixes...

Nick</pre>
    </div><div id="c57" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c57">Comment 57</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jody Foo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-04 19:48:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Sounds great Nick! I just found your patch and it exactly what I need. Thanks
for your effort!</pre>
    </div><div id="c58" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c58">Comment 58</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Donn Morrison</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 01:16:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hey Nick, any progress on the latest 1.5.2 patch?

Donn</pre>
    </div><div id="c59" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c59">Comment 59</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 03:48:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=1153" name="attach_1153" title="Update + addons for 1.5.3">attachment 1153</a> <a href="attachment.cgi?id=1153&amp;action=edit" title="Update + addons for 1.5.3">[details]</a></span>
Update + addons for 1.5.3

Patch for 1.5.2 also works for 1.5.3.

2 New features...

a) Read-Only Namespaces, now you may put all the namespaces you want to be read
only to an array. Users with the 'roread' right can read them, users with the
'rowrite' right can edit them. These are not locked to usergroups yet (not
specific right per namespace), that means if someone has the 'rowrite' right,
can edit every read only namespace, same goes for 'roread'. Read only
namespaces are not hidden (no log hiding).

b) For those users that have access to restricted namespaces, a list to the
main page of each restricted namespace they have access to is being displayed
after they log in. Each link is formed by the name of the namespace and the
'mainpage' message. Also on top of the list a new 'RNSlist' message is being
displayed, to edit the message go to MediaWiKi:RNSlist.

For more info check out includes/DefaultSettings.php (documentation is there)

Hope it works fine :-)
Nick

P.S. By the way the title of this bug entry is way out of date, I' ll create a
new bug entry sometime.

P.S.2 I also created a patch for changing the logo and the sidebar per
namespace, check it out (4042).</pre>
    </div><div id="c60" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c60">Comment 60</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 03:55:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I forgot to mention i also added a feature to hide User talk stuff from
Special:Recentchanges

Nick</pre>
    </div><div id="c61" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c61">Comment 61</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">C. Filipe Medeiros</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 06:22:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I'm still trying to figure out all the code (I've been able to make a couple
edits for my own purposes here-and-there) but I was wondering what I would have
to change to return an &quot;Access Denied&quot; page rather than just sending them to the
&quot;Login&quot; page whenever they try to access a restricted resource.

Or is there something wrong with my installation?</pre>
    </div><div id="c62" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c62">Comment 62</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 07:17:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Check out includes/OutputPage.php and the function returnToMain() whitch is
called in such situations.

Nick</pre>
    </div><div id="c63" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c63">Comment 63</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jody Foo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 13:04:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I too wanted to have this so I added a few lines to the function loginToUse() in
includes/OutputPage.php

I ended up with this:

function loginToUse() {
	global $wgUser, $wgTitle, $wgContLang;

        $usersNamespaces = $wgUser-&gt;getAllowedRNSes();
        $usersNamespacesArray = explode(&quot;\n&quot;, $usersNamespaces);
        $currentNamespace = Namespace::getCanonicalName($wgTitle-&gt;getNamespace());
        
        # If the user tries to access an extra namespace but does not have
        # the correct permissions, display an Access Denied message.
        # You need to define MediaWiki:noaccesstitle and MediaWiki:noaccesstext
        if($wgTitle-&gt;getNamespace() &gt;= 100) {
            if(!in_array($currentNamespace, $usersNamespacesArray)) {
                $this-&gt;setPageTitle( wfMsg( 'noaccesstitle' ) );
                $this-&gt;setHTMLTitle( wfMsg( 'errorpagetitle' ) );
                $this-&gt;setRobotpolicy( 'noindex,nofollow' );
                $this-&gt;setArticleFlag( false );
                $this-&gt;mBodytext = '';
                $this-&gt;addWikiText( wfMsg( 'noaccesstext' ) );
            }
        }
        
        else {        
            $this-&gt;setPageTitle( wfMsg( 'loginreqtitle' ) );
            $this-&gt;setHTMLTitle( wfMsg( 'errorpagetitle' ) );
            $this-&gt;setRobotpolicy( 'noindex,nofollow' );
            $this-&gt;setArticleFlag( false );
            $this-&gt;mBodytext = '';
            $this-&gt;addWikiText( wfMsg( 'loginreqtext' ) );
        }

		# We put a comment in the .html file so a Sysop can diagnose the page the
		# user can't see.
		$this-&gt;addHTML( &quot;\n&lt;!--&quot; .
						$wgContLang-&gt;getNsText( $wgTitle-&gt;getNamespace() ) .
						':' .
						$wgTitle-&gt;getDBkey() . '--&gt;' );

        # Do not return to the main page automatically if the user tried to access
        # an extra namespace. Only return if the user tried, but failed to access
        # a system namespace.
        if($wgTitle-&gt;getNamespace() &lt; 100) {
            $this-&gt;returnToMain();	# Flip back to the main page after 10 seconds.
        }
}</pre>
    </div><div id="c64" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c64">Comment 64</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jody Foo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-08 13:25:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1155" name="attach_1155" title="Display Access Denied message when no namespace permission">attachment 1155</a> <a href="attachment.cgi?id=1155&amp;action=edit" title="Display Access Denied message when no namespace permission">[details]</a></span>
Display Access Denied message when no namespace permission

This patch works after applying the 1.5.3 patch for restricting namespace
access.</pre>
    </div><div id="c65" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c65">Comment 65</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Christos Gavos</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-14 14:15:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This is fabulous! I did manage to create Private Namespaces and all. But is
there a way to make the “main” namespace private and then create a public
namespaces?

For example, 

Everything posted under the “main” namespace is private

Everything posted under the “Public:” name space is world readable

Everything posted under the “FlexPublic:” name space is readable and writable

Regards,
cgavos</pre>
    </div><div id="c66" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c66">Comment 66</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stephen Kennedy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-18 06:57:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Will this be making its way into the official code?</pre>
    </div><div id="c67" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c67">Comment 67</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-18 07:28:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >No. MediaWiki doesn't target this type of environment, and our
policy is to be open about the fact that we are not built for
that, since security problems in an unmaintained, half-done
approach are likely to crop up constantly.

If you actually need fancy read restrictions to keep some of
your own people from reading each others' writing, MediaWiki is
not the right software for you.

I hadn't realized this bug was actually still open, I'm resolving
it as WONTFIX.
</pre>
    </div><div id="c68" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c68">Comment 68</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Matt Shepherd</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-21 16:56:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >While I understand what Brion Vibber has said here and elsewhere many times, I
still feel that MediaWiki suits my needs very well aside from the lack of good
Access Control.  I'm willing to do what I need to do to ensure that after this
patch is implemented on my wiki, that the wiki remains secure.

I feel that part of the beauty of open source software is that even if the
community that developed it is not interested in a certain aspect or feature,
that feature can be developed, implemented, and maintained by someone 'outside'
of the community so that those who are interested can use it.

I work in a Software Development department at a large ISP.  If is possible that
if there is a need we may end up developing further access control ourselves as
we have evaluated many other collaborative documentation repository solutions
and like what MediaWiki has to offer.

MaPhi, will you be continuing to post updates at another location?  Since Brion
has made it clear on many occassions that there are no foreseeable plans to
implement something like this, perhaps we should find a forum where this patch
and it's updates can be posted, downloaded, and discussed freely?</pre>
    </div><div id="c69" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c69">Comment 69</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Edward Z. Yang</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-25 19:43:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >You're likely going to have to fork MediaWiki, albeit make it a closely
synchronized fork. MediaWiki, after all, is used for WikiMedia's projects, and
the MediaWiki team has done a great job patching MediaWiki so that it's
deployable on other systems. However, you can only do so much without
implementing ugly hacks or introducing performance problems.</pre>
    </div><div id="c70" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c70">Comment 70</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-12-25 20:45:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Brion Vibber is right, MediaWiKi's design is to be open for editing etc and
focuses on other important things. This is a hack for MediaWiKi and it will
remain a hack as long as someone is maintaining it (MaPhi Werner, me, someone
else perhaps). It shouldn't be in the oficial MediaWiKi because MediaWiKi should
be redisigned from scratch and adapt a new user policy etc (that means e.g. new
database scema, different architecture, different session hanlding etc) for this
to work corectly. This hack does not guarantee security etc. I personaly liked
MediaWiKi's interface and features and wanted to mod it for my needs so i used
and maintained this patch. If you want to have a wiki with user managemend in
mind (lot's of permissions to add or remove, more options upon user rights, per
article access control etc), try something else.</pre>
    </div><div id="c71" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c71">Comment 71</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-18 19:04:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1316" name="attach_1316" title="Update + addons for 1.5.5">attachment 1316</a> <a href="attachment.cgi?id=1316&amp;action=edit" title="Update + addons for 1.5.5">[details]</a></span>
Update + addons for 1.5.5

Lots of bugfixes, tested mostly with 1.5.3 but works for 1.5.5 too...

Some add-ons:

* Users in Special:Listusers can only see the users in their usergroup (to undo
this overwrite includes/Speciallistusers.php from the main distribution).

* A new variable {{ns}} added, that gets the name of the current namespace
(this helps with management), especialy with #4042 can be very helpfull in
sidebars.</pre>
    </div><div id="c72" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c72">Comment 72</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-18 19:05:46 UTC
        </span>
      </div>



<pre class="bz_comment_text" >forgot to mention the above patch can be applied with -p1 instead of -p0...</pre>
    </div><div id="c73" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c73">Comment 73</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nick Kossifidis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-01-19 06:48:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I got a report about another bug, users that are not logged in can edit their
user-page (IP), to fix this, go to User.php
in function isallowed, find 


// If we are in user's page, allow him to do everything...
                if ( $action == 'edit' &amp;&amp; ($ns == NS_USER_TALK || $ns == NS_USER)...


                if ( $action == 'protect' &amp;&amp; ($ns == NS_USER_TALK || $ns ==
NS_USER)...

and change it to...

// If we are in user's page, allow him to do everything...
                if ( $this-&gt;isLoggedIn() &amp;&amp; $action == 'edit' &amp;&amp; ($ns ==
NS_USER_TALK || $ns == NS_USER)...


                if ( $this-&gt;isLoggedIn() &amp;&amp; $action == 'protect' &amp;&amp; ($ns ==
NS_USER_TALK || $ns == NS_USER)...</pre>
    </div><div id="c74" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c74">Comment 74</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">lɛʁi לערי ריינהארט</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-01 15:17:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c71">comment #71</a>)
<span class="quote">&gt; * A new variable {{ns}} added, that gets the name of the current namespace
&gt; (this helps with management), especialy with #4042 can be very helpfull in
&gt; sidebars.</span >

This is the request from
<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED WONTFIX - CANONICALNAMESPACE and CANONICALNAMESPACEE"
   href="show_bug.cgi?id=2162">Bug 2162</a>: enhancement request for a new variable GENERICNAMESPACE</pre>
    </div><div id="c75" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c75">Comment 75</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ben Greear</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-08 08:29:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I'm using mediawiki 1.5.6 with the 1.5.5 patch, and having trouble.  I'm new to
wiki, so I could be missing something trivial.

I have added a new group using mysql commands:
mysql&gt; select * from user_groups;
+---------+------------+
| ug_user | ug_group   |
+---------+------------+
|       1 | bureaucrat |
|       1 | candela    |
|       1 | sysop      |
+---------+------------+
3 rows in set (0.00 sec)

My local-settings looks like this:
## Access restriction settings.

$wgExtraNamespaces = array(
101 =&gt; 'Private'
);

$wgRestrictedNamespaces =
        array(101 =&gt; 'candela'
             );

$wgGroupPermissions['sysop']['candela'] = true;
$wgGroupPermissions['candela']['candela'] = true;

$wgLinkWarn = true;

----

I'm using this wiki-markup in my main page to try to create a private
link, available only to user 1:

* [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Private%3APrivate">Private:Private</a>]] Restricted pages, not for public consumption.

I'm logged in as user 1, but when I display the main page, I
see this:

 &lt;restrlink&gt; Restricted pages, not for public consumption.

Any ideas what I'm doing wrong?

Thanks,
Ben Greear &lt;<a href="mailto:greearb&#64;candelatech.com">greearb&#64;candelatech.com</a>&gt;</pre>
    </div><div id="c76" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c76">Comment 76</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-09 11:00:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c73">comment #73</a>)
Hi Nick! Very good work! I thougth it was impossible to do this with MediaWiki
and I was thinking in changing to a different wiki engine! Thanks!

I found two things that maybe you want to change in the patch:

(1) I get a warning:

Warning: substr_count(): Empty substring. in ...\includes\SpecialListusers.php
on line 177

to solve it you can change (near line 177 in SpecialListusers)
     if( substr_count($rUsergroups, $tUserGroups[$i]) &gt;0 ){
for
     if( strlen($tUserGroups[$i])&gt;0 &amp;&amp; substr_count($rUsergroups, $tUserGroups[$i])

(2) If you apply the patch &quot;Diff to restrict the output of groups on the
Special:Listusers page for non-sysops&quot; you still can see the groups because in
Recentchanges you can see things like this (even if you are not in the group
&quot;testgroup&quot;)

(Bureaucrat log); 09:42 . . Admin (Discusión) (Changed group membership for
Usuario:TestUser from to testgroup) 

I don't care a lot, but maybe is a problem for someone else.

Thanks again!

Octavi</pre>
    </div><div id="c77" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c77">Comment 77</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-09 13:39:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c75">comment #75</a>)

Hi Ben! I discovered this patch yesterday so maybe I'm wrong.

You can write
$wgLinkWarn = false;

and the link will show the same way as the others. I didn't like this (I want a
warning AND a link) and changed Parser.php near line 1337 the lines:

	$s .=wfMsg( 'restrlink' ). $trail;
	continue;

commented something:
	$s .=wfMsg( 'restrlink' );//. $trail;
	//continue;

Then you have to create the page MediaWiki:Restrlink and write something you
want to appear before the restricted links. I wanted to appear an image of a
lock so I tried something like [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Image%3Alog.gif">Image:log.gif</a>]] but doesn't work. If you write
the url like:
<a href="http://www.example.com/lock.gif">http://www.example.com/lock.gif</a>
without any wiki format, it works!

You should create the pages MediaWiki:RNSlist (appears in the login) and
MediaWiki:templatenotincluded (appears if you try to do a template with
restricted pages).</pre>
    </div><div id="c78" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c78">Comment 78</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Xavier Belanche</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-24 09:33:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi Octavi,
I have the same problem about &lt;restrlink&gt;. I have this conf in the localsettings.php

$wgGroupPermissions['*'         ]['createaccount']      = false;
$wgGroupPermissions['*'         ]['read']               = true;
$wgGroupPermissions['*'         ]['edit']               = false;
$wgGroupPermissions['sysop'     ]['edit']               = true;
$wgGroupPermissions['sysop'     ]['read']               = true;
$wgGroupPermissions['sysop'     ]['createaccount']      = true;
$wgGroupPermissions['sysop'     ]['renameuser']      = true;
$wgGroupPermissions['sysop'     ]['userrights']      = true;
$wgGroupPermissions['ninja'         ]['read']               = true;
$wgGroupPermissions['ninja'         ]['edit']               = true;


#NameSpaces propios de la estructura del curso XTEC
$wgExtraNamespaces = array (
        100 =&gt; &quot;CURS&quot;,
        101 =&gt; &quot;MODUL&quot;,
        102 =&gt; &quot;PRACTICA&quot;,
        103 =&gt; &quot;EXERCICI&quot;,
        104 =&gt; &quot;GUIA&quot;,
        105 =&gt; &quot;AJUDA&quot;
);
$wgNamespacesWithSubpages = array (
        100 =&gt; 1, 101=&gt; 1, 102=&gt; 1, 103=&gt; 1, 104=&gt; 1, 105=&gt; 1);
$wgNamespacesToBeSearchDefault = array (100=&gt; 1 , 101=&gt; 1, 102=&gt; 1, 103=&gt; 1,
104=&gt; 1, 105=&gt; 1);



## Relación entre los grupos de usuarios y los NameSpaces
$wgGroupPermissions['sysop'     ]['cusito']      = true;
$wgGroupPermissions['sysop'     ]['modulito']      = true;
$wgGroupPermissions['*'         ]['cursito']      = false;
$wgGroupPermissions['*'         ]['modulito']      = false;
$wgGroupPermissions['ninja'     ]['cursito']      = true;
$wgGroupPermissions['ninja'     ]['modulito']      = false;



## Afegim als keys dels namespaces els noms dels grups de restricció :=)
$wgRestrictedNamespaces = array(100 =&gt; &quot;cursito&quot;, 101 =&gt; &quot;modulito&quot;);

$wgLinkWarn = false;

At this point, when I visit one MODUL or CURS page, it appears something like this:
<a href="http://phobos.xtec.net/curslinkat/formacio/index.php/Linkat">http://phobos.xtec.net/curslinkat/formacio/index.php/Linkat</a>
Well, I would to know how its the better way to work or solution!

Thanks, 
Javier

PD: Octavi, felicitats pel teu projecte de robòtica. Apa, ajuda'm!!!!!</pre>
    </div><div id="c79" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c79">Comment 79</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">John Beranek</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-24 14:24:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >After much tearing out of hair, I did eventually get access restriction to a
namespace, but one thing remains.

What is 'RSNlist' message meant to say? I can't quite understand what it's there
for based on the patch/comments.
</pre>
    </div><div id="c80" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c80">Comment 80</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">John Beranek</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-24 14:42:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >[Apologies, I meant RNSlist in <a href="show_bug.cgi?id=1924#c79">comment #79</a>]

In fact, can we have examples of all the messages:

- restrlink
- templatenotincluded
- RNSlist

any others?
</pre>
    </div><div id="c81" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c81">Comment 81</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Xavier Belanche</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-02-28 07:49:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hey,
Just rules :) I have a problem of permissions! Thanks for your feedbacks :)_

Javier</pre>
    </div><div id="c82" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c82">Comment 82</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">violendom</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-01 10:06:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi, I had some particular needs :

* I wanted to view the restricted link if it's allowed and in a different
namespace page.
* The page must not be cached if a restricted link is present, because the page
is different for differnt user
* The page can be cached if the restricted link is in the same namespace of the page
* I need a template to display an open lock near the allowed restricted link
(restrallowedlink)

so I've changed Parser.php to satisfy my needs : 

#If the link points to a restricted namespace outside the
#parent namespace warn the user.
global $wgRestrictedNamespaces, $wgLinkWarn, $wgUser;
if( $wgLinkWarn &amp;&amp; is_array( $wgRestrictedNamespaces )) {
  if( array_key_exists( $ns, $wgRestrictedNamespaces ) ) {			
    if ($this-&gt;mTitle-&gt;getNamespace() != $ns) {
      #If the restricted link is in a page with a differnt namespace
      #do not cache.
      $this-&gt;disableCache();
    }	
    if ( $wgUser-&gt;isAllowed($wgRestrictedNamespaces[$ns]) ) {
      $s .=wfMsg( 'restrallowedlink' );
    } else {
      $s .=wfMsg( 'restrlink' ). $trail;
      continue;
    }
  }
}

It would be nice with some conf variables to configure the link display behaviour</pre>
    </div><div id="c83" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c83">Comment 83</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Müller</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-02 08:57:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >hi,
i have running mediawiki 1.5.6. Is it necessary to patch 1.5.6  or is it
necessary to include an extension to enable private and puplic wiki pages?

Which example on this bugzilla-side is running? Or can anybody post me an
running LocalSettings.php.  

which convention is correct?
$wgGroupPermissions['Groupname']['restrictedNamespaceName']         = true; 
or
$wgGroupPermissions['Groupname']['Right']         = true;

thanks in advanced for &quot;any&quot; answer</pre>
    </div><div id="c84" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c84">Comment 84</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Müller</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-02 09:01:26 UTC
        </span>
      </div>



<pre class="bz_comment_text" >hi,
i have running mediawiki 1.5.6. Is it necessary to patch 1.5.6  or is it
necessary to include an extension to enable private and puplic wiki pages?

Which example on this bugzilla-side is running? Or can anybody post me an
running LocalSettings.php.  

which convention is correct?
$wgGroupPermissions['Groupname']['restrictedNamespaceName']         = true; 
or
$wgGroupPermissions['Groupname']['Right']         = true;

thanks in advanced for &quot;any&quot; answer</pre>
    </div><div id="c85" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c85">Comment 85</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel O</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-16 08:09:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=1450" name="attach_1450" title="Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)">attachment 1450</a> <a href="attachment.cgi?id=1450&amp;action=edit" title="Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)">[details]</a></span>
Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)

No updates here. Just munged patch from
[<a href="http://bugzilla.wikimedia.org/attachment.cgi?id=1316&amp;action=edit|addons">http://bugzilla.wikimedia.org/attachment.cgi?id=1316&amp;action=edit|addons</a> for
1.5.5] to jive with plain 1.5.7 release.</pre>
    </div><div id="c86" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c86">Comment 86</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel O</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-16 08:54:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1451" name="attach_1451" title="Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)">attachment 1451</a> <a href="attachment.cgi?id=1451&amp;action=edit" title="Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)">[details]</a></span>
Addons for 1.5.7 (based on 1.5.5 addons 1316, munged for 1.5.7)

Sorry, I've been smoking crack and original patch did not, err, patch cleanly.
This one does.</pre>
    </div><div id="c87" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c87">Comment 87</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Vinnie</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-18 00:34:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Is there a simple piece of code that will allow a general user to edit the talk
page and nothing else?</pre>
    </div><div id="c88" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c88">Comment 88</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Hiram</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-03-22 20:00:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Pawel O: Your patch produces the following error when a user not in any
namespace group askes for List Users:&lt;BR&gt;
Warning:  substr_count() [&lt;a
href='function.substr-count'&gt;function.substr-count&lt;/a&gt;]: Empty substring. in
includes/SpecialListusers.php &lt;BR&gt;
It is from the following section of code:&lt;BR&gt;
&lt;PRE&gt;
+                       $incl = false;
+                       $rUsergroups = implode(',',$groups);
+                       $tUserGroups = $wgUser-&gt;getGroups();
+                       for( $i = 0; count($tUserGroups) &gt;= $i; $i++) {
+                               if( substr_count($rUsergroups, $tUserGroups[$i])
<span class="quote">&gt;0 ){</span >
+                                       $incl = true;
+                                       break;
+                               }
+                       }
&lt;/PRE&gt;</pre>
    </div><div id="c89" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c89">Comment 89</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jean-Gabriel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-05 21:15:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hello,

(first : thanks Nick Kossifidis for this patch, it helps a lot 
setting up corporate wikis).

We'd like to also protect uploaded files, i.e. be able to upload 
files that could then be retrieved only by a group of users. 

Does the patch allow to do this ?  For this purpose, it would be nice 
if we could use the same restrictions that are set up by the way of 
this patch, for &quot;normal&quot; wiki pages !

Thanks in advance ...
</pre>
    </div><div id="c90" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c90">Comment 90</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alfons Zitterbacke</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-07 20:24:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1508" name="attach_1508" title="Restricted namespace access on SVN/Head 2006-04-06 + Addons 1452">attachment 1508</a> <a href="attachment.cgi?id=1508&amp;action=edit" title="Restricted namespace access on SVN/Head 2006-04-06 + Addons 1452">[details]</a></span>
Restricted namespace access on SVN/Head 2006-04-06 + Addons 1452

I updated 1452 to work with recent SVN Code (2006-04-06).</pre>
    </div><div id="c91" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c91">Comment 91</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ivan Vighetto</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-14 09:42:46 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Applying the patch, doesn't work &quot;preferences&quot;. I added $wgUser as global in
function namespacesCheckboxes() in SpecialPreferences.php and works ok.</pre>
    </div><div id="c92" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c92">Comment 92</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ivan Vighetto</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-14 09:43:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >After applying the patch, doesn't work &quot;preferences&quot;. I added $wgUser as global
in function namespacesCheckboxes() in SpecialPreferences.php and works ok.</pre>
    </div><div id="c93" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c93">Comment 93</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Silvia Pfeiffer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-14 10:35:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I run mediawiki 1.5.7 and have applied
mediawiki-1.5.7-restriction-patch-beta-0.62.tar.gz . The section that I have
restriced is all pages that contain &quot;Restricted/&quot; in them.

It works, but when I use &quot;search&quot;, the restricted pages also come up as search
results.
Try <a href="http://www.annodex.org/">http://www.annodex.org/</a> and search for &quot;restricted&quot;.

I checked the source code, but couldn't find out why. Can anyone help?</pre>
    </div><div id="c94" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c94">Comment 94</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrei Cojocaru</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-22 22:05:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1598" name="attach_1598" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">attachment 1598</a> <a href="attachment.cgi?id=1598&amp;action=edit" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">[details]</a></span>
Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)

Hi,

I recently set up a MediaWiki installation and was looking for exactly what
this patch provided! However, it seemed there was no version for 1.6.3, however
I decided to try SVN/Head 2006-04-06 + Addons 1452 with Display Access Denied
message when no namespace permission (had to do some light hacking for the
latter because of some changed code in loginToUse() and there was also a slight
bug in the first in wfSpeciAllpages() since it didn't have global $wgUser).
Anyways, thanks to the writers for the mentioned patches, they did the real
work.

Hopefully, people will keep posting patches to enable this functionality, hope
this helps others.

P.S. I forgot to mention above, that I didn't do any extensive testing, but
after using the wiki for a couple of days it seems to work fine with no side
effects except that little bug in wfSpecialAllpages(). Also it seems the
restricted patches aren't included in Search either unless you have permission
(let me know if I'm wrong).</pre>
    </div><div id="c95" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c95">Comment 95</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrei Cojocaru</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-22 23:32:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c93">comment #93</a>)
<span class="quote">&gt; I run mediawiki 1.5.7 and have applied
&gt; mediawiki-1.5.7-restriction-patch-beta-0.62.tar.gz . The section that I have
&gt; restriced is all pages that contain &quot;Restricted/&quot; in them.</span >

That file refers to the patch referenced from
<a href="http://conseil-recherche-innovation.net/index.php/1974/04">http://conseil-recherche-innovation.net/index.php/1974/04</a> which is different
from the namespace restriction patch on this page. It seems to support
restricting namespaces implicitly by matching the namespace followed by colon
part not explictly like this patch. Also, it only has one group of &quot;authorized&quot;
 users, while this patch supports as many restriction groups as you want by
implementing restriction as a user right rather than a user group.
</pre>
    </div><div id="c96" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c96">Comment 96</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roland Rosenfeld</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-23 18:23:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c94">comment #94</a>)
<span class="quote">&gt; Addons for 1.6.3  with Display Access Denied message when no namespace
&gt; permission patch (based SVN/Head 2006-04-06 + Addons 1452)</span >

As far as I can see, this breaks the &quot;what links here&quot; link.  The following
patch solves this:

+++ includes/SpecialWhatlinkshere.php   Sun Apr 23 20:19:38 2006
&#64;&#64; -73,7 +73,7 &#64;&#64;
         * &#64;access private
         */
        function showIndirectLinks( $level, $target, $limit, $from = 0, $dir =
'next' ) {
-               global $wgOut;
+               global $wgOut, $wgUser;
                $fname = 'WhatLinksHerePage::showIndirectLinks';
 
                $dbr =&amp; wfGetDB( DB_READ );</pre>
    </div><div id="c97" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c97">Comment 97</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roland Rosenfeld</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-23 18:45:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >And another problem with 1.6.3:

--- includes/SpecialPreferences.php.org Sun Apr 23 20:27:10 2006
+++ includes/SpecialPreferences.php     Sun Apr 23 20:27:47 2006
&#64;&#64; -370,7 +370,7 &#64;&#64;
         * &#64;access private
         */
        function namespacesCheckboxes() {
-               global $wgContLang;
+               global $wgContLang, $wgUser;
 
                # Determine namespace checkboxes
                $namespaces = $wgContLang-&gt;getNamespaces();
</pre>
    </div><div id="c98" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c98">Comment 98</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Didier Courtaud</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-04 13:03:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The <span class=""><a href="attachment.cgi?id=1598" name="attach_1598" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">attachment 1598</a> <a href="attachment.cgi?id=1598&amp;action=edit" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">[details]</a></span> does not seem to work with Mediawiki 1.6.5 :

patching file includes/CategoryPage.php
patching file includes/DefaultSettings.php
Hunk #1 succeeded at 1567 (offset 13 lines).
patching file includes/Export.php
patching file includes/OutputPage.php
Hunk #1 FAILED at 748.
1 out of 1 hunk FAILED -- saving rejects to file includes/OutputPage.php.rej
patching file includes/Parser.php
patching file includes/QueryPage.php
patching file includes/SearchEngine.php
patching file includes/SpecialAllpages.php
patching file includes/SpecialContributions.php
patching file includes/SpecialListusers.php
patching file includes/SpecialLog.php
patching file includes/SpecialPreferences.php
patching file includes/SpecialRandompage.php
patching file includes/SpecialRecentchanges.php
patching file includes/SpecialRecentchangeslinked.php
patching file includes/SpecialUserlogin.php
Hunk #1 succeeded at 410 (offset -1 lines).
patching file includes/SpecialWantedpages.php
Hunk #1 succeeded at 71 (offset 3 lines).
patching file includes/SpecialWhatlinkshere.php
patching file includes/Title.php
patching file includes/User.php
</pre>
    </div><div id="c99" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c99">Comment 99</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Cyril Dangerville</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-13 07:37:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=1714" name="attach_1714" title="Restricted namespace access for 1.6.5">attachment 1714</a> <a href="attachment.cgi?id=1714&amp;action=edit" title="Restricted namespace access for 1.6.5">[details]</a></span>
Restricted namespace access for 1.6.5

Based on patch for 1.6.3. Resolved the conflict on includes/OutputPage.php
mentioned by Didier Courteau in last comment to make it compatible with 1.6.5.</pre>
    </div><div id="c100" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c100">Comment 100</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Cyril Dangerville</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-13 07:45:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=1714" name="attach_1714" title="Restricted namespace access for 1.6.5">attachment 1714</a> <a href="attachment.cgi?id=1714&amp;action=edit" title="Restricted namespace access for 1.6.5">[details]</a></span>
Restricted namespace access for 1.6.5

Based on <span class=""><a href="attachment.cgi?id=1598" name="attach_1598" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">attachment #1598</a> <a href="attachment.cgi?id=1598&amp;action=edit" title="Addons for 1.6.3  with Display Access Denied message when no namespace permission patch (based SVN/Head 2006-04-06 + Addons 1452)">[details]</a></span>.
Do not forget to define MediaWiki:RNSlist, MediaWiki:noaccesstitle and
MediaWiki:noaccesstext.</pre>
    </div><div id="c101" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c101">Comment 101</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stephan Braun</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-05-22 18:22:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I used this patch for 1.5.7 and everything seems to work fine except for the RSS
feed for recent changes. The feed includes the changes of restriced (hidden)
pages which should not be so. Is there anything to change this behaviour?</pre>
    </div><div id="c102" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c102">Comment 102</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">jbm</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-01 20:10:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >
The patch for 1.6.5 seems to be imcopatible with 1.6.6

Hunk #1 succeeded at 120 with fuzz 2 (offset 5 lines).
patching file includes/DefaultSettings.php
Hunk #1 FAILED at 1554.
1 out of 1 hunk FAILED -- saving rejects to file
includes/DefaultSettings.php.rejpatch
</pre>
    </div><div id="c103" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c103">Comment 103</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-10 23:49:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1933" name="attach_1933" title="Restricted namespace access for 1.6.7 (based on 1714)">attachment 1933</a> <a href="attachment.cgi?id=1933&amp;action=edit" title="Restricted namespace access for 1.6.7 (based on 1714)">[details]</a></span>
Restricted namespace access for 1.6.7 (based on 1714)

just updated 1714 to MediaWiki 1.6.7</pre>
    </div><div id="c104" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c104">Comment 104</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-14 12:17:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I think I found a possible security hole. If you include a restricted page in a
non restricted page you can see the contents, even if you don't have access to
the restricted namespace.

Try writing {{:RestrictedNS:NameOfThePage}} in a non restricted page
(RestrictedNS is the restricted namespace and NameOfThePage the name of the page).

To solve it, I added an &quot;else&quot; near line 2268 in includes/Parser.php

    # Articles from restricted namespaces can't be used in templates.
    # They would appear or disappear based on the rights of the user
    # that refreshes the cache...
    if( is_array( $wgRestrictedNamespaces ) ) {
        if( array_key_exists( $title-&gt;getNamespace(), $wgRestrictedNamespaces ) ) {
            $found = true;
            $text = $linestart . wfMsg( 'templatenotincluded' );
        }
    }
+    else
    if ( $title-&gt;getNamespace() == NS_SPECIAL &amp;&amp;
$this-&gt;mOptions-&gt;getAllowSpecialInclusion() ) {

Anyone can tell me if I'm right? Thanks

Octavi</pre>
    </div><div id="c105" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c105">Comment 105</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-14 12:52:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Never mind my previous post, I introduced the security hole to my wiki some time
ago when I did some changes to the code. All the patches here are ok. Sorry!

Octavi</pre>
    </div><div id="c106" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c106">Comment 106</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-14 14:07:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I've been looking at my changes and the patches and after all maybe my post #104
was right. My wiki has too many changes to know it for sure. Can somebody check
it? Thanks

Octavi</pre>
    </div><div id="c107" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c107">Comment 107</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-18 09:14:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I certify this bug. In my wiki it also works. 
Someone must build a new patch.</pre>
    </div><div id="c108" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c108">Comment 108</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-20 09:23:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >In <a href="show_bug.cgi?id=1924#c104">comment #104</a> there is a mistake and it will prevent to appear any template
(even the ones of non restricted namespaces). To solve it, we have to merge the
two &quot;if&quot; (and leave the &quot;else&quot; after):

# Articles from restricted namespaces can't be used in templates.
# They would appear or disappear based on the rights of the user
# that refreshes the cache...
if( is_array( $wgRestrictedNamespaces ) &amp;&amp; array_key_exists(
$title-&gt;getNamespace(), $wgRestrictedNamespaces ) ) {
  $found = true;
  $text = $linestart . wfMsg( 'templatenotincluded' );
} 
else if ( $title-&gt;getNamespace() == NS_SPECIAL &amp;&amp; ...</pre>
    </div><div id="c109" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c109">Comment 109</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcus Schwarz</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-23 00:40:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c103">comment #103</a>)
<span class="quote">&gt; Created an attachment (id=1933) [edit]
&gt; Restricted namespace access for 1.6.7 (based on 1714)
&gt; 
&gt; just updated 1714 to MediaWiki 1.6.7</span >


I have some troubles with this patch.
First I often receive a message like &quot;&lt;restrlink&gt;&quot;, which I hadn't using version
1.5.3 with that patch. I found out that in &quot;DefaultSettings.php&quot; around line 1424 
$wgLinkWarn = false; 
has to be set instead of 
$wgLinkWarn = true;

also I found some error in SpecialWhatlinkshere.php around line 203: &quot;Fatal
error: Call to a member function canAccessNamespace() on a non-object in
/var/www/html/wiki/includes/SpecialWhatlinkshere.php on line 203&quot;
This can be eliminated by setting 
global $wgUser; 
around line 78, after function showIndirectLinks() begins.

Another error now occurs in SpecialRecentchangeslinked.php, an syntax error of
the sql statement. &quot;1054: Unknown column 'page_namespace' in 'where clause'
(localhost)&quot; I haven't had a closer look at it by now...</pre>
    </div><div id="c110" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c110">Comment 110</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-03 22:12:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=2045" name="attach_2045" title="Adds &quot;your namespaces&quot; to sidebar for 1.6.3.">attachment 2045</a> <a href="attachment.cgi?id=2045&amp;action=edit" title="Adds &quot;your namespaces&quot; to sidebar for 1.6.3.">[details]</a></span>
Adds &quot;your namespaces&quot; to sidebar for 1.6.3.

Makes the restricted namespace patches more useful... shows a user a list of
namespaces to which they have access.</pre>
    </div><div id="c111" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c111">Comment 111</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-03 22:22:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=2046" name="attach_2046" title="Adds &quot;your namespaces&quot; to sidebar for 1.6.3">attachment 2046</a> <a href="attachment.cgi?id=2046&amp;action=edit" title="Adds &quot;your namespaces&quot; to sidebar for 1.6.3">[details]</a></span>
Adds &quot;your namespaces&quot; to sidebar for 1.6.3

Makes the restricted namespace patches more useful by showing the user a list
of
namespaces to which they have access. If the user does not have access to any
restricted namespaces, the sidebar remains the standard.</pre>
    </div><div id="c112" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c112">Comment 112</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marco Rota</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-05 14:41:36 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c108">comment #108</a>)
I've tried your workaround in a 1.5.6 installation and it work fine, but don't 
work in a 1.6.7.
What version you are using?
</pre>
    </div><div id="c113" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c113">Comment 113</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roland Rosenfeld</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-10 16:45:03 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I found a little but in SpecialRecentchangeslinked: It uses the table
column page_namespace, but table 'page' isn't used in this query so it
fails.  Changing this to pl_namespace seems to solve this problem:

--- SpecialRecentchangeslinked.php.old	Mon Jul 10 18:32:17 2006
+++ SpecialRecentchangeslinked.php	Mon Jul 10 18:38:15 2006
&#64;&#64; -67,7 +67,7 &#64;&#64;
 	if( is_array( $wgRestrictedNamespaces )) {
 		foreach( $wgRestrictedNamespaces as $key =&gt; $value ) {
 			if( ! $wgUser-&gt;canAccessNamespace( $key )) {
-				$cmq .= ' AND page_namespace &lt;&gt;' . $key;
+				$cmq .= ' AND pl_namespace &lt;&gt;' . $key;
 			}
 		}
 	}
</pre>
    </div><div id="c114" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c114">Comment 114</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-13 18:17:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=2081" name="attach_2081" title="Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)">attachment 2081</a> <a href="attachment.cgi?id=2081&amp;action=edit" title="Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)">[details]</a></span>
Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)

As not able to include this snippet from a previous version into Parser.php. Do
not really understand it well enough to workout where it should go if it goes
at all.

***************
*** 2527,2532 ****
--- 2537,2546 ----
		if ( !$found ) {
			# Check for NS: (namespace expansion)
			$mwNs = MagicWord::get( MAG_NS );
+			  if ( $part1 == 'ns' ) {
+				  $text = $linestart . $wgContLang-&gt;getNsText(
$this-&gt;mTitle-&gt;getNamespace() );
+				  $found = true;
+			  }
			if ( $mwNs-&gt;matchStartAndRemove( $part1 ) ) {
				if ( intval( $part1 ) || $part1 == &quot;0&quot; ) {
					$text = $linestart .
$wgContLang-&gt;getNsText( intval( $part1 ) );
***************</pre>
    </div><div id="c115" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c115">Comment 115</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-13 18:30:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=2082" name="attach_2082" title="Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)">attachment 2082</a> <a href="attachment.cgi?id=2082&amp;action=edit" title="Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)">[details]</a></span>
Updated for 1.7.1 (includes &quot;your namespaces&quot; in the sidebar)

Gah!!! Missed one line (in SpecialPreferences.php).</pre>
    </div><div id="c116" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c116">Comment 116</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-14 17:05:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >For v.1.7.1 patches.

Decided to put the sidebar heading into the database:

Create MediaWiki:Yournamespaces with your heading.

Update to includes/Skin.php, line 1494:
-  $heading = 'your namespaces';
+  $heading = wfMsgForContent ('yournamespaces');

Dan</pre>
    </div><div id="c117" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c117">Comment 117</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-16 16:46:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I modified the restricted link feature. So with this changes it allows links
inside of the namespace group and not only the namespace as it was before.

includes/Parser.php
  			if( $wgLinkWarn &amp;&amp; is_array( $wgRestrictedNamespaces )) {
- 				if( array_key_exists( $ns, $wgRestrictedNamespaces ) &amp;&amp; 
($this-&gt;mTitle-&gt;getNamespace() != $ns)) {
+ 				if( array_key_exists( $ns, $wgRestrictedNamespaces ) &amp;&amp; 
($this-&gt;mTitle-&gt;getNamespace() != $ns) &amp;&amp; ($wgRestrictedNamespaces[$ns] !=
$wgRestrictedNamespaces[$this-&gt;mTitle-&gt;getNamespace()])) {
  					$s .=wfMsg( 'restrlink' ). $trail;
  					continue;
  				}
  			}</pre>
    </div><div id="c118" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c118">Comment 118</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-16 23:51:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Andreas,

As the code existed prior to your changes, to enable linking into a restricted
namespace, you would set $wgLinkWarn = false; in LocalSettings.php. This would
allow those links.

Dan</pre>
    </div><div id="c119" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c119">Comment 119</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-17 06:45:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I know. But I would like this feature, but i also want to link to the discussion
pages etc.

Andi</pre>
    </div><div id="c120" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c120">Comment 120</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Davis</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-17 10:59:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Anyone else find that after these patches, you can't undelete?

We found the cause in User.php (line 1321). Special:Undelete is protected and
itself includes a call to isAllowed('delete'). Therefore, the updated
isAllowed() function fails. We have updated line 1321 to check for portected
pages other than Special:Undelete. 

   //If the user wants to delete or undelete a page and it's blocked don't allow
him to do so.
   if( ($action == 'delete' || $action == 'undelete') &amp;&amp;
     ( ($title-&gt;isProtected() &amp;&amp; !$title == &quot;Special:Undelete&quot; ) ||
$this-&gt;isBlocked()) ){
        return false;
   }

Dan</pre>
    </div><div id="c121" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c121">Comment 121</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-19 19:22:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >In our Wiki follow error occured:
Fatal error: Call to a member function on a non-object in
/webs/phpbb/root/www/phpbb.de/wiki/includes/SpecialWhatlinkshere.php on line 203

To fix this we did follow changes:

Modified: trunk/wiki/includes/SpecialWhatlinkshere.php
==============================================================================
--- trunk/wiki/includes/SpecialWhatlinkshere.php (original)
+++ trunk/wiki/includes/SpecialWhatlinkshere.php Mon Jul 17 02:21:18 2006
&#64;&#64; -73,7 +73,7 &#64;&#64;
 	 * &#64;access private
 	 */
 	function showIndirectLinks( $level, $target, $limit, $from = 0, $dir = 'next' ) {
-		global $wgOut;
+		global $wgOut, $wgUser;
 		$fname = 'WhatLinksHerePage::showIndirectLinks';
 
 		$dbr =&amp; wfGetDB( DB_READ );</pre>
    </div><div id="c122" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c122">Comment 122</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Hubel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-19 20:10:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Oh I forgot:
Dan: Your undelete patch worked. The undelete function works now.</pre>
    </div><div id="c123" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c123">Comment 123</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jonathan Polley</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-28 21:19:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c03">comment #03</a>)

You can not access the Special:Preferences page.  To do that, I had to remove
the patch at line 377 in SpecialPreferences.php.  This is not a problem with the
1.7.1 patch, but I have to use 1.6.x for a bit longer.</pre>
    </div><div id="c124" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c124">Comment 124</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-08-07 11:44:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c112">comment #112</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=1924#c108">comment #108</a>)
&gt; I've tried your workaround in a 1.5.6 installation and it work fine, but don't 
&gt; work in a 1.6.7.
&gt; What version you are using?
&gt; </span >

I use 1.5.8 (with other patches). I won't upgrade for now because there are too
many changes.
I don't know if (in the patches for 1.6.x and 1.7.x) you can also see the
contents of a restricted page 

including it in a non restricted page: {{:RestrictedNS:NameOfThePage}}

Octavi</pre>
    </div><div id="c125" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c125">Comment 125</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Joe Travaglini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-08-08 18:57:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Octavi - 
  You will always be able to trans(in)clude a &quot;restricted&quot; page because the page
isn't truly &quot;restricted&quot;.  These solutions are imperfect hacks.  This applies to
1.6.x and 1.7.x and will to 1.8.x as well.

  You will have to significantly modify the parser to handle the transclusion. 
And even then, there will still be aways around the restriction hacks.</pre>
    </div><div id="c126" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c126">Comment 126</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Octavi Estapé</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-08-09 08:16:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=1924#c125">comment #125</a>)
<span class="quote">&gt; Octavi - 
&gt;   You will always be able to trans(in)clude a &quot;restricted&quot; page because the page
&gt; isn't truly &quot;restricted&quot;.  These solutions are imperfect hacks.  This applies to
&gt; 1.6.x and 1.7.x and will to 1.8.x as well.
&gt; 
&gt;   You will have to significantly modify the parser to handle the transclusion. 
&gt; And even then, there will still be aways around the restriction hacks.</span >

I don't agree with you. Of course it won't be perfect (all the software has
imperfections), but I think that this patch is near to perfection. And I think
that our purpose is to make it better. I only found this problem and I think
that you won't find any way to see restricted content without the right
permission (at least in version 1.5.x). In case you do, please write it here.
Thanks!

Octavi</pre>
    </div><div id="c127" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c127">Comment 127</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Didier Courtaud</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-10-26 09:47:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The proposed patch does not work with MW 1.8.2 :

patch -p1 &lt; ../RS.patch
patching file includes/CategoryPage.php
Hunk #1 succeeded at 210 with fuzz 2 (offset 103 lines).
patching file includes/DefaultSettings.php
Hunk #1 succeeded at 1747 (offset 54 lines).
patching file includes/Export.php
Hunk #1 succeeded at 256 (offset 19 lines).
Hunk #2 succeeded at 355 (offset 19 lines).
patching file includes/OutputPage.php
Hunk #2 FAILED at 776.
1 out of 2 hunks FAILED -- saving rejects to file includes/OutputPage.php.rej
patching file includes/Parser.php
Hunk #1 FAILED at 1508.
Hunk #2 FAILED at 2826.
2 out of 2 hunks FAILED -- saving rejects to file includes/Parser.php.rej
patching file includes/QueryPage.php
patching file includes/SearchEngine.php
Hunk #1 succeeded at 167 (offset 5 lines).
patching file includes/SpecialAllpages.php
patching file includes/SpecialContributions.php
patching file includes/SpecialLog.php
patching file includes/SpecialPreferences.php
Hunk #2 succeeded at 384 (offset 5 lines).
Hunk #3 FAILED at 394.
1 out of 3 hunks FAILED -- saving rejects to file
includes/SpecialPreferences.php.rej
patching file includes/SpecialRandompage.php
patching file includes/SpecialRecentchanges.php
patching file includes/SpecialRecentchangeslinked.php
patching file includes/SpecialUserlogin.php
Hunk #1 succeeded at 475 (offset 34 lines).
Hunk #2 succeeded at 485 (offset 34 lines).
patching file includes/SpecialWantedpages.php
patching file includes/SpecialWhatlinkshere.php
patching file includes/Title.php
Hunk #1 succeeded at 1026 (offset -4 lines).
Hunk #2 succeeded at 1137 (offset -3 lines).
Hunk #3 succeeded at 1151 (offset -3 lines).
patching file includes/User.php
Hunk #1 FAILED at 1237.
1 out of 1 hunk FAILED -- saving rejects to file includes/User.php.rej
patching file includes/Skin.php
Hunk #1 FAILED at 1445.
Hunk #2 succeeded at 1558 (offset 67 lines).
1 out of 2 hunks FAILED -- saving rejects to file includes/Skin.php.rej

Does anyone can publish a version compatible with MW 1.8.2

Didier</pre>
    </div><div id="c128" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c128">Comment 128</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Joseph Southwell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-09 22:21:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=2667" name="attach_2667" title="Updated for 2082 for 1.8.2">attachment 2667</a> <a href="attachment.cgi?id=2667&amp;action=edit" title="Updated for 2082 for 1.8.2">[details]</a></span>
Updated for 2082 for 1.8.2

I updated for 1.8.2
I made very few changes 
1.
-#if( $this-&gt;canAccessNamespace($nsid) &amp;&amp; !($nsid %2) ) { 
+if( $this-&gt;canAccessNamespace($nsid) ) {
all I could see the %2 doing was removing odd numbered namespace ids from the
list. I could not imagine a reason to do that. 

2. altered the formatting of the restricted namespace list on the UserLogin
page. 

3. added a bunch of default rights to the sysop user. I had group user very
limitted and sysop couldn't do anything because it was expecting to inherit
some of its authority from user.</pre>
    </div><div id="c129" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c129">Comment 129</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-09 23:00:57 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Can future patches for this hack be maintained/distributed elsewhere? I ask
because each individual problem/notification clogs up the inboxes of people
who'd rather not receive the emails. In addition, using our bug tracker gives
off the false impressions that (a) this is going to make it into MediaWiki *some
time*, even though it's not, no matter how much Santa Claus begs, and (b) that
we're in some means affiliated with it.

I'm sure someone out there would be willing to host discussion like this for
what amounts to a major fork in aims and scope of MediaWiki.</pre>
    </div><div id="c130" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c130">Comment 130</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Joseph Southwell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-11-10 20:53:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I have fixed one bug and added 2 features to the patch for 1.8.2. Per Rob
Church's request above the current state of my version of the patch can be had at

&lt;a
href=&quot;<a href="http://wiki.ontoserve.com/index.php/Namespace_Hack">http://wiki.ontoserve.com/index.php/Namespace_Hack</a>&quot;&gt;<a href="http://wiki.ontoserve.com/index.php/Namespace_Hack">http://wiki.ontoserve.com/index.php/Namespace_Hack</a>&lt;/a&gt;</pre>
    </div><div id="c131" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c131">Comment 131</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Noel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-08 09:33:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=2838" name="attach_2838" title="Updated for 1.8.2 (two bugs fixed)">attachment 2838</a> <a href="attachment.cgi?id=2838&amp;action=edit" title="Updated for 1.8.2 (two bugs fixed)">[details]</a></span>
Updated for 1.8.2 (two bugs fixed)</pre>
    </div><div id="c132" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c132">Comment 132</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ben Levitt</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-23 01:26:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Allow setting group permissions per-namespace"
   href="show_bug.cgi?id=8360">Bug 8360</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c133" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c133">Comment 133</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">qsheets095
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-02 00:15:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Comment on <span class=""><a href="attachment.cgi?id=2838" name="attach_2838" title="Updated for 1.8.2 (two bugs fixed)">attachment 2838</a> <a href="attachment.cgi?id=2838&amp;action=edit" title="Updated for 1.8.2 (two bugs fixed)">[details]</a></span>
Updated for 1.8.2 (two bugs fixed)

<span class="quote">&gt;diff -iEbdu -r ./includes/Article.php ./includes/Article.php
&gt;--- ./includes/Article.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/Article.php	2006-12-07 15:30:54.340034100 +0100
&gt;&#64;&#64; -644,7 +644,6 &#64;&#64;
&gt; 
&gt; 		# If we got diff and oldid in the query, we want to see a
&gt; 		# diff page instead of the article.
&gt;-
&gt; 		if ( !is_null( $diff ) ) {
&gt; 			$wgOut-&gt;setPageTitle( $this-&gt;mTitle-&gt;getPrefixedText() );
&gt; 
&gt;diff -iEbdu -r ./includes/CategoryPage.php ./includes/CategoryPage.php
&gt;--- ./includes/CategoryPage.php	2006-11-21 16:36:14.472026700 +0100
&gt;+++ ./includes/CategoryPage.php	2006-12-07 15:22:52.721070900 +0100
&gt;&#64;&#64; -175,6 +175,7 &#64;&#64;
&gt; 	}
&gt; 
&gt; 	function doCategoryQuery() {
&gt;+		global $wgUser;
&gt; 		$dbr =&amp; wfGetDB( DB_SLAVE );
&gt; 		if( $this-&gt;from != '' ) {
&gt; 			$pageCondition = 'cl_sortkey &gt;= ' . $dbr-&gt;addQuotes( $this-&gt;from );
&gt;&#64;&#64; -210,6 +211,11 &#64;&#64;
&gt; 
&gt; 			$title = Title::makeTitle( $x-&gt;page_namespace, $x-&gt;page_title );
&gt; 
&gt;+			# If this page is inside a restricted namespace, skip the result...
&gt;+ 			if(!$wgUser-&gt;canAccessNamespace($title-&gt;getNamespace())) {
&gt;+ 				continue;
&gt;+ 			}
&gt;+
&gt; 			if( $title-&gt;getNamespace() == NS_CATEGORY ) {
&gt; 				$this-&gt;addSubcategory( $title, $x-&gt;cl_sortkey, $x-&gt;page_len );
&gt; 			} elseif( $title-&gt;getNamespace() == NS_IMAGE ) {
&gt;diff -iEbdu -r ./includes/DefaultSettings.php ./includes/DefaultSettings.php
&gt;--- ./includes/DefaultSettings.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/DefaultSettings.php	2006-12-07 15:30:58.121429300 +0100
&gt;&#64;&#64; -914,6 +914,13 &#64;&#64;
&gt; $wgGroupPermissions['bot'  ]['autoconfirmed']   = true;
&gt; 
&gt; // Most extra permission abilities go to this group
&gt;+$wgGroupPermissions['sysop']['createpage']      = true;
&gt;+$wgGroupPermissions['sysop']['createtalk']      = true;
&gt;+$wgGroupPermissions['sysop']['read']            = true;
&gt;+$wgGroupPermissions['sysop']['edit']            = true;
&gt;+$wgGroupPermissions['sysop']['minoredit']       = true;
&gt;+$wgGroupPermissions['sysop']['roread']          = true;
&gt;+$wgGroupPermissions['sysop']['roedit']          = true;
&gt; $wgGroupPermissions['sysop']['block']           = true;
&gt; $wgGroupPermissions['sysop']['createaccount']   = true;
&gt; $wgGroupPermissions['sysop']['delete']          = true;
&gt;&#64;&#64; -1747,6 +1754,96 &#64;&#64;
&gt; $wgExtraNamespaces = NULL;
&gt; 
&gt; /**
&gt;+ * Hidden namespaces. If you include a namespace in this array, only users with
&gt;+ * the matching priviledges will be able to see and edit pages in this
&gt;+ * namespace.
&gt;+ *
&gt;+ * The form is &quot; namespace =&gt; 'priviledge' &quot; e.g.
&gt;+ *
&gt;+ * $wgRestrictedNamespaces =
&gt;+ *    array(100 =&gt; 'coolguy',
&gt;+ *             101 =&gt; 'coolguy'
&gt;+ *            );
&gt;+ *
&gt;+ * where 100 is the namespace id and 'coolguy' is the priviledge.
&gt;+ *
&gt;+ * Each priv. is a string in an array, you can add as many as you like
&gt;+ * in the $wgGroupPermitions array e.g.
&gt;+ *
&gt;+ *$wgGroupPermissions['allowed']['coolguy'] = true;
&gt;+ *
&gt;+ * In this example you asigned the 'coolguy' priviledge to the 'allowed' group.
&gt;+ *
&gt;+ */
&gt;+$wgRestrictedNamespaces = NULL;
&gt;+
&gt;+/**
&gt;+ * In case you want only to deny the edit right on a namespace, you may put it
&gt;+ * in this array. You also need to asign the 'roread' right to the usergroup you
&gt;+ * want to be able to read and the 'roedit' right to the usergroup you want to be
&gt;+ * able to edit. Read only namespaces are not hiden (nor their logs etc).
&gt;+ *
&gt;+ * Example: $wgReadOnlyNSes = array(100,101);
&gt;+ *
&gt;+ */
&gt;+$wgReadOnlyNSes = NULL;
&gt;+
&gt;+/**
&gt;+ * In case you have categories of pages located on a restricted namespaces
&gt;+ * those categories will appear empty and might be comfusing. Setting this
&gt;+ * var to true, (all) categories will be hidden in the Recent changes.
&gt;+ */
&gt;+$wgHideCategoriesinRC = false;
&gt;+
&gt;+/**
&gt;+ * Logs in Recent Changes are treated all the same, so normaly users will be able
&gt;+ * to see moves, protects and deletes of pages in restricted namespaces. Setting
&gt;+ * this var to true will hide all logs in Recent Changes and only those for restricted
&gt;+ * namespaces in Special:Log.
&gt;+ */
&gt;+$wgHideLogs = false;
&gt;+ 
&gt;+/**
&gt;+ * In case you want to customize what logs the user can see both in Recent Changes
&gt;+ * and Special:Log, modify this array to include the log types you want to hide. This is
&gt;+ * overriden by $wgHideLogs for Recent Changes and those logs for restricted
&gt;+ * namespaces in Special:Log. This feature lets you hide also the 'block' and 'rights'
&gt;+ * log types that are namespace independed in Special:Log, or show them in RC while
&gt;+ * hiding the rest.
&gt;+ * 
&gt;+ * This example shows how to hide all log types in RC, and (block/rights) in Special:Log
&gt;+ * (the others in Special:Log are  are filtered based on namespace access rights so they
&gt;+ * apply only for restricted namespaces).
&gt;+ *
&gt;+ *$wgHidenLogs = array('block','protect', 'rights', 'delete','upload', 'move');
&gt;+ */
&gt;+$wgHidenLogs = NULL;
&gt;+ 
&gt;+/**
&gt;+ * In case some user tries to create a link from some namespace to an other restricted
&gt;+ * namespace, while the page gets parsed, instead of the link, a warning message will appear
&gt;+ * ('restrlink') to let the user know. If the link is in the same namespace as the edited page,
&gt;+ * no check will be done.
&gt;+ */
&gt;+$wgLinkWarn = true; 
&gt;+ 
&gt;+/**
&gt;+ * In case you want to hide logs about User Talk pages (namespace 3) fromnrecent changes
&gt;+ * set this to true.
&gt;+ * 
&gt;+ */
&gt;+$wgHideUtalk = false; 
&gt;+ 
&gt;+/**
&gt;+ * You can use this array to alter wiki's upper left logo depending on the namespace
&gt;+ * you are in. 
&gt;+ *
&gt;+ * Example:
&gt;+ * $wgNamespaceLogos = array ( 100 =&gt; '/url_path_to/logo.gif');
&gt;+ **/
&gt;+$wgNamespaceLogos = NULL;
&gt;+
&gt;+/**
&gt;  * Limit images on image description pages to a user-selectable limit. In order
&gt;  * to reduce disk usage, limits can only be selected from a list. This is the
&gt;  * list of settings the user can choose from:
&gt;diff -iEbdu -r ./includes/Export.php ./includes/Export.php
&gt;--- ./includes/Export.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/Export.php	2006-12-07 15:30:56.355736500 +0100
&gt;&#64;&#64; -256,7 +256,13 &#64;&#64;
&gt; 	 */
&gt; 	function outputStream( $resultset ) {
&gt; 		$last = null;
&gt;+		global $wgUser;
&gt; 		while( $row = $resultset-&gt;fetchObject() ) {
&gt;+                        #If page is in a secured namespace, skip the row.
&gt;+                        if(!$wgUser-&gt;canAccessNamespace($row-&gt;page_namespace) ){
&gt;+                               continue;
&gt;+                        }
&gt;+
&gt; 			if( is_null( $last ) ||
&gt; 				$last-&gt;page_namespace != $row-&gt;page_namespace ||
&gt; 				$last-&gt;page_title     != $row-&gt;page_title ) {
&gt;&#64;&#64; -349,11 +355,14 &#64;&#64;
&gt; 	}
&gt; 
&gt; 	function namespaces() {
&gt;-		global $wgContLang;
&gt;-		$spaces = &quot;  &lt;namespaces&gt;\n&quot;;
&gt;+		global $wgContLang, $wgUser;
&gt;+		$spaces = &quot;&lt;namespaces&gt;\n&quot;;
&gt; 		foreach( $wgContLang-&gt;getFormattedNamespaces() as $ns =&gt; $title ) {
&gt;+			if($wgUser-&gt;canAccessNamespace($ns))
&gt;+			{
&gt; 			$spaces .= '      ' . wfElement( 'namespace', array( 'key' =&gt; $ns ), $title ) . &quot;\n&quot;;
&gt; 		}
&gt;+		}
&gt; 		$spaces .= &quot;    &lt;/namespaces&gt;&quot;;
&gt; 		return $spaces;
&gt; 	}
&gt;diff -iEbdu -r ./includes/OutputPage.php ./includes/OutputPage.php
&gt;--- ./includes/OutputPage.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/OutputPage.php	2006-12-07 15:30:56.636997300 +0100
&gt;&#64;&#64; -236,7 +236,7 &#64;&#64;
&gt; 		foreach ( $categories as $category =&gt; $arbitrary ) {
&gt; 			$title = Title::makeTitleSafe( NS_CATEGORY, $category );
&gt; 			$text = $wgContLang-&gt;convertHtml( $title-&gt;getText() );
&gt;-			$this-&gt;mCategoryLinks[] = $sk-&gt;makeLinkObj( $title, $text );
&gt;+			$this-&gt;mCategoryLinks[] = $sk-&gt;makeKnownLinkObj( $title, $text );
&gt; 		}
&gt; 	}
&gt; 
&gt;&#64;&#64; -723,6 +723,7 &#64;&#64;
&gt; 		$this-&gt;mBodytext = '';
&gt; 
&gt; 		$groups = array();
&gt;+		
&gt; 		foreach( $wgGroupPermissions as $key =&gt; $value ) {
&gt; 			if( isset( $value[$permission] ) &amp;&amp; $value[$permission] == true ) {
&gt; 				$groupName = User::getGroupName( $key );
&gt;&#64;&#64; -777,6 +778,21 &#64;&#64;
&gt; 
&gt; 		$skin = $wgUser-&gt;getSkin();
&gt; 		
&gt;+		if($wgTitle-&gt;getNamespace() &gt;= 100){
&gt;+ 			$usersNamespaces = $wgUser-&gt;getAllowedRNSes();
&gt;+ 			$usersNamespacesArray = explode(&quot;\n&quot;, $usersNamespaces);
&gt;+ 			$currentNamespace = Namespace::getCanonicalName($wgTitle-&gt;getNamespace());
&gt;+ 
&gt;+ 			if (!in_array($currentNamespace, $usersNamespacesArray)) {
&gt;+ 				$this-&gt;setPageTitle( wfMsg( 'noaccesstitle' ) );
&gt;+ 				$this-&gt;setHtmlTitle( wfMsg( 'errorpagetitle' ) );
&gt;+ 				$this-&gt;setRobotPolicy( 'noindex,nofollow' );
&gt;+ 				$this-&gt;setArticleFlag( false );
&gt;+ 				$this-&gt;addHTML( wfMsgHtml( 'noaccesstext') );
&gt;+ 			} else {
&gt;+ 				// Should never reach here.
&gt;+ 			}
&gt;+		} else {
&gt; 		$this-&gt;setPageTitle( wfMsg( 'loginreqtitle' ) );
&gt; 		$this-&gt;setHtmlTitle( wfMsg( 'errorpagetitle' ) );
&gt; 		$this-&gt;setRobotPolicy( 'noindex,nofollow' );
&gt;&#64;&#64; -793,6 +809,7 &#64;&#64;
&gt; 		if( $mainPage-&gt;userCanRead() )
&gt; 			$this-&gt;returnToMain( true, $mainPage );
&gt; 	}
&gt;+	}
&gt; 
&gt; 	/** &#64;obsolete */
&gt; 	function databaseError( $fname, $sql, $error, $errno ) {
&gt;diff -iEbdu -r ./includes/Parser.php ./includes/Parser.php
&gt;--- ./includes/Parser.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/Parser.php	2006-12-07 16:39:15.760002900 +0100
&gt;&#64;&#64; -1463,6 +1463,7 &#64;&#64;
&gt; 	 */
&gt; 	function replaceInternalLinks( $s ) {
&gt; 		global $wgContLang;
&gt;+		global $wgUser;
&gt; 		static $fname = 'Parser::replaceInternalLinks' ;
&gt; 
&gt; 		wfProfileIn( $fname );
&gt;&#64;&#64; -1604,6 +1605,17 &#64;&#64;
&gt; 
&gt; 			$ns = $nt-&gt;getNamespace();
&gt; 			$iw = $nt-&gt;getInterWiki();
&gt;+
&gt;+ 			#If the link points to a restricted namespace outside the
&gt;+ 			#parent namespace warn the user.
&gt;+ 			global $wgRestrictedNamespaces, $wgLinkWarn ;
&gt;+ 			if( $wgLinkWarn &amp;&amp; is_array( $wgRestrictedNamespaces )) {
&gt;+ 				if( array_key_exists( $ns, $wgRestrictedNamespaces ) &amp;&amp;  !$wgUser-&gt;canAccessNamespace( $ns )) {/*($this-&gt;mTitle-&gt;getNamespace() != $ns)) {*/
&gt;+ 					$s .=wfMsg( 'restrlink' ). $trail;
&gt;+ 					continue;
&gt;+ 				}
&gt;+ 			}
&gt;+
&gt; 			wfProfileOut( &quot;$fname-title&quot; );
&gt; 			
&gt; 			if ($might_be_img) { # if this is actually an invalid link
&gt;&#64;&#64; -2826,7 +2838,7 &#64;&#64;
&gt; 	 * &#64;private
&gt; 	 */
&gt; 	function braceSubstitution( $piece ) {
&gt;-		global $wgContLang, $wgLang, $wgAllowDisplayTitle, $action;
&gt;+		global $wgContLang, $wgLang, $wgAllowDisplayTitle, $action, $wgRestrictedNamespaces;
&gt; 		$fname = __METHOD__ /*. '-L' . count( $this-&gt;mArgStack )*/;
&gt; 		wfProfileIn( $fname );
&gt; 		wfProfileIn( __METHOD__.'-setup' );
&gt;&#64;&#64; -2994,6 +3006,15 &#64;&#64;
&gt; 				}
&gt; 
&gt; 				if ( !$title-&gt;isExternal() ) {
&gt;+					# Articles from restricted namespaces can't be used in templates.
&gt;+					# They would appear or disappear based on the rights of the user
&gt;+					# that refreshes the cache...
&gt;+					if( is_array( $wgRestrictedNamespaces ) ) {
&gt;+						if( array_key_exists( $title-&gt;getNamespace(), $wgRestrictedNamespaces ) ) {
&gt;+							$found = true;
&gt;+							$text = $linestart . wfMsg( 'templatenotincluded' );
&gt;+						}
&gt;+ 					}
&gt; 					if ( $title-&gt;getNamespace() == NS_SPECIAL &amp;&amp; $this-&gt;mOptions-&gt;getAllowSpecialInclusion() &amp;&amp; $this-&gt;ot['html'] ) {
&gt; 						$text = SpecialPage::capturePath( $title );
&gt; 						if ( is_string( $text ) ) {
&gt;diff -iEbdu -r ./includes/QueryPage.php ./includes/QueryPage.php
&gt;--- ./includes/QueryPage.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/QueryPage.php	2006-12-07 15:30:58.355813300 +0100
&gt;&#64;&#64; -474,8 +474,14 &#64;&#64;
&gt; class PageQueryPage extends QueryPage {
&gt; 
&gt; 	function formatResult( $skin, $result ) {
&gt;-		global $wgContLang;
&gt;+		global $wgContLang, $wgUser;
&gt; 		$nt = Title::makeTitle( $result-&gt;namespace, $result-&gt;title );
&gt;+
&gt;+		# Don't show wanted pages in restricted namespaces
&gt;+		if( !$wgUser-&gt;canAccessNamespace( $nt-&gt;getNamespace() ) ) {
&gt;+			return &quot;&quot;;
&gt;+		}
&gt;+
&gt; 		return $skin-&gt;makeKnownLinkObj( $nt, htmlspecialchars( $wgContLang-&gt;convert( $nt-&gt;getPrefixedText() ) ) );
&gt; 	}
&gt; }
&gt;diff -iEbdu -r ./includes/SearchEngine.php ./includes/SearchEngine.php
&gt;--- ./includes/SearchEngine.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SearchEngine.php	2006-12-07 16:12:19.098684900 +0100
&gt;&#64;&#64; -167,10 +167,10 &#64;&#64;
&gt; 	 * &#64;access public
&gt; 	 */
&gt; 	function searchableNamespaces() {
&gt;-		global $wgContLang;
&gt;+		global $wgContLang, $wgUser;
&gt; 		$arr = array();
&gt; 		foreach( $wgContLang-&gt;getNamespaces() as $ns =&gt; $name ) {
&gt;-			if( $ns &gt;= NS_MAIN ) {
&gt;+			if( $ns &gt;= NS_MAIN &amp;&amp; $wgUser-&gt;canAccessNamespace($ns)) {
&gt; 				$arr[$ns] = $name;
&gt; 			}
&gt; 		}
&gt;diff -iEbdu -r ./includes/Skin.php ./includes/Skin.php
&gt;--- ./includes/Skin.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/Skin.php	2006-12-07 15:41:43.918198000 +0100
&gt;&#64;&#64; -121,7 +121,6 &#64;&#64;
&gt; 		include_once( &quot;{$wgStyleDirectory}/{$skinName}.deps.php&quot; );
&gt; 		wfRestoreWarnings();
&gt; 		require_once( &quot;{$wgStyleDirectory}/{$skinName}.php&quot; );
&gt;-
&gt; 		# Check if we got if not failback to default skin
&gt; 		$className = 'Skin'.$skinName;
&gt; 		if( !class_exists( $className ) ) {
&gt;&#64;&#64; -1511,11 +1510,22 &#64;&#64;
&gt; 	 */
&gt; 	function buildSidebar() {
&gt; 		global $parserMemc, $wgEnableSidebarCache;
&gt;-		global $wgLang, $wgContLang;
&gt;+		global $wgLang, $wgContLang, $wgUser, $wgTitle;
&gt;+		global $wgExtraNamespaces, $wgRestrictedNamespaces;
&gt; 
&gt; 		$fname = 'SkinTemplate::buildSidebar';
&gt; 
&gt; 		wfProfileIn( $fname );
&gt;+		$nsname = '';
&gt;+		if(is_object($wgTitle))
&gt;+		{
&gt;+			$nsid = $wgTitle-&gt;getNamespace();
&gt;+			if(in_array($nsid, array_keys($wgExtraNamespaces)) &amp;&amp; 
&gt;+				in_array($nsid, array_keys($wgRestrictedNamespaces)))
&gt;+			{	
&gt;+				$nsname = $wgExtraNamespaces[$nsid].&quot;:&quot;;	
&gt;+			}
&gt;+		}
&gt; 
&gt; 		$key = wfMemcKey( 'sidebar' );
&gt; 		$cacheSidebar = $wgEnableSidebarCache &amp;&amp;
&gt;&#64;&#64; -1550,13 +1560,28 &#64;&#64;
&gt; 					$href = self::makeInternalOrExternalUrl( $link );
&gt; 					$bar[$heading][] = array(
&gt; 						'text' =&gt; $text,
&gt;-						'href' =&gt; $href,
&gt;+						'href' =&gt; preg_replace('/Main_Page$/', $nsname.&quot;Main_Page&quot;, $href),
&gt; 						'id' =&gt; 'n-' . strtr($line[1], ' ', '-'),
&gt; 						'active' =&gt; false
&gt; 					);
&gt; 				} else { continue; }
&gt; 			}
&gt; 		}
&gt;+		$heading = 'your namespaces';
&gt;+ 		$lines = explode( &quot;\n&quot;, $wgUser-&gt;getAllowedRNSes() );
&gt;+ 		if (count($lines) &gt; 0 &amp;&amp; $lines[0] != '') {
&gt;+ 			foreach ($lines as $line) {
&gt;+ 				$bar[$heading][] = array(
&gt;+ 					'text' =&gt; $line,
&gt;+ 					'href' =&gt; $this-&gt;makeInternalOrExternalUrl( $line . ':' . wfMsgForContent( 'mainpage' ) ),
&gt;+ 					'id' =&gt; 'n-' . strtr($line, ' ', '-'),
&gt;+ 					'active' =&gt; false
&gt;+ 				);
&gt;+ 			}
&gt;+ 		}
&gt;+
&gt; 		if ($cacheSidebar)
&gt; 			$cachednotice = $parserMemc-&gt;set( $key, $bar, 86400 );
&gt; 		wfProfileOut( $fname );
&gt;diff -iEbdu -r ./includes/SkinTemplate.php ./includes/SkinTemplate.php
&gt;--- ./includes/SkinTemplate.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/SkinTemplate.php	2006-12-07 15:41:43.918198000 +0100
&gt;&#64;&#64; -1076,7 +1076,12 &#64;&#64;
&gt;	 */
&gt;	function text( $str ) {
&gt;-		echo htmlspecialchars( $this-&gt;data[$str] );
&gt;+		global $wgTitle, $wgNamespaceLogos;
&gt;+		if('logopath'==$str &amp;&amp; isset($wgNamespaceLogos[$wgTitle-&gt;getNamespace()])) {
&gt;+			echo htmlspecialchars( $wgNamespaceLogos[$wgTitle-&gt;getNamespace()] );
&gt;+		} else {
&gt;+			echo htmlspecialchars( $this-&gt;data[$str] );
&gt;+		}
&gt;	}</span >
&gt;
<span class="quote">&gt;	/**
&gt;	 * &#64;private
&gt;diff -iEbdu -r ./includes/SpecialAllpages.php ./includes/SpecialAllpages.php
&gt;--- ./includes/SpecialAllpages.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialAllpages.php	2006-12-07 15:21:46.970229300 +0100
&gt;&#64;&#64; -10,17 +10,24 &#64;&#64;
&gt;  * &#64;param $specialPage &#64;see SpecialPage object.
&gt;  */
&gt; function wfSpecialAllpages( $par=NULL, $specialPage ) {
&gt;-	global $wgRequest, $wgOut, $wgContLang;
&gt;+	global $wgRequest, $wgOut, $wgContLang, $wgUser;
&gt; 
&gt; 	# GET values
&gt; 	$from = $wgRequest-&gt;getVal( 'from' );
&gt; 	$namespace = $wgRequest-&gt;getInt( 'namespace' );
&gt; 
&gt; 	$namespaces = $wgContLang-&gt;getNamespaces();
&gt;+ 	if ( isset($par) ) {
&gt;+ 		foreach ($namespaces as $ns_id =&gt; $ns_name) {
&gt;+ 			if ($par == $ns_name) {
&gt;+ 				$namespace = $ns_id;
&gt;+ 			}
&gt;+ 		}
&gt;+ 	}
&gt; 
&gt; 	$indexPage = new SpecialAllpages();
&gt; 
&gt;-	if( !in_array($namespace, array_keys($namespaces)) )
&gt;+ 	if( !in_array($namespace, array_keys($namespaces)) || !$wgUser-&gt;canAccessNamespace( $namespace))
&gt; 		$namespace = 0;
&gt; 
&gt; 	$wgOut-&gt;setPagetitle( $namespace &gt; 0 ?
&gt;&#64;&#64; -28,9 +35,7 &#64;&#64;
&gt; 		wfMsg( 'allarticles' )
&gt; 		);
&gt; 
&gt;-	if ( isset($par) ) {
&gt;-		$indexPage-&gt;showChunk( $namespace, $par, $specialPage-&gt;including() );
&gt;-	} elseif ( isset($from) ) {
&gt;+	if ( isset($from) ) {
&gt; 		$indexPage-&gt;showChunk( $namespace, $from, $specialPage-&gt;including() );
&gt; 	} else {
&gt; 		$indexPage-&gt;showToplevel ( $namespace, $specialPage-&gt;including() );
&gt;diff -iEbdu -r ./includes/SpecialContributions.php ./includes/SpecialContributions.php
&gt;--- ./includes/SpecialContributions.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialContributions.php	2006-12-07 15:30:56.136978100 +0100
&gt;&#64;&#64; -16,7 +16,14 &#64;&#64;
&gt; 	}
&gt; 
&gt; 	function setNamespace( $ns ) {
&gt;+		global $wgUser;
&gt;+		# If the namespace asked is restricted return
&gt;+		# to the main namespace.
&gt;+		if($wgUser-&gt;canAccessNamespace($ns)) {
&gt; 		$this-&gt;namespace = $ns;
&gt;+		}else{
&gt;+			$this-&gt;namespace = 0;
&gt;+		}
&gt; 	}
&gt; 
&gt; 	function setLimit( $limit ) {
&gt;&#64;&#64; -72,15 +79,30 &#64;&#64;
&gt; 	}
&gt; 
&gt; 	function getNamespaceCond() {
&gt;-		if ( $this-&gt;namespace !== false )
&gt;+		global $wgUser;
&gt;+		# Include the namespace in the querry only if it's not restricted to the user.
&gt;+		if (($this-&gt;namespace !== false) &amp;&amp; ($wgUser-&gt;canAccessNamespace($this-&gt;namespace))) {
&gt; 			return ' AND page_namespace = ' . (int)$this-&gt;namespace;
&gt;+		} else {
&gt; 		return '';
&gt; 	}
&gt;+	}
&gt; 
&gt; 	function getPreviousOffsetForPaging() {
&gt; 		list( $index, $usercond ) = $this-&gt;getUserCond();
&gt; 		$nscond = $this-&gt;getNamespaceCond();
&gt; 
&gt;+		# Exclude all namespaces that are restricted to this user
&gt;+		global $wgRestrictedNamespaces;
&gt;+		global $wgUser;
&gt;+		if( is_array( $wgRestrictedNamespaces )) {
&gt;+			foreach( $wgRestrictedNamespaces as $key =&gt; $value ) {
&gt;+				if( ! $wgUser-&gt;canAccessNamespace( $key )) {
&gt;+					$nscond .= ' AND page_namespace &lt;&gt;' . $key;
&gt;+				}
&gt;+			}
&gt;+		}
&gt;+
&gt; 		$use_index = $this-&gt;dbr-&gt;useIndexClause( $index );
&gt; 		extract( $this-&gt;dbr-&gt;tableNames( 'page', 'revision' ) );
&gt; 
&gt;&#64;&#64; -137,6 +159,16 &#64;&#64;
&gt; 			$offsetQuery = &quot;AND rev_timestamp &lt;= '{$this-&gt;offset}'&quot;;
&gt; 
&gt; 		$nscond = $this-&gt;getNamespaceCond();
&gt;+		# Exclude all namespaces that are restricted to this user
&gt;+		global $wgRestrictedNamespaces;
&gt;+		global $wgUser;
&gt;+		if( is_array( $wgRestrictedNamespaces )) {
&gt;+			foreach( $wgRestrictedNamespaces as $key =&gt; $value ) {
&gt;+				if( ! $wgUser-&gt;canAccessNamespace( $key )) {
&gt;+					$nscond .= ' AND page_namespace &lt;&gt;' . $key;
&gt;+				}
&gt;+			}
&gt;+		}
&gt; 		$use_index = $this-&gt;dbr-&gt;useIndexClause( $index );
&gt; 		$sql = &quot;SELECT
&gt; 			page_namespace,page_title,page_is_new,page_latest,
&gt;diff -iEbdu -r ./includes/SpecialLog.php ./includes/SpecialLog.php
&gt;--- ./includes/SpecialLog.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/SpecialLog.php	2006-12-07 15:30:57.433902900 +0100
&gt;&#64;&#64; -302,11 +302,42 &#64;&#64;
&gt; 	 * &#64;private
&gt; 	 */
&gt; 	function logLine( $s ) {
&gt;-		global $wgLang;
&gt;+		global $wgLang, $wgUser;
&gt;+		global $wgHideLogs, $wgHidenLogs;
&gt; 		$title = Title::makeTitle( $s-&gt;log_namespace, $s-&gt;log_title );
&gt; 		$user = Title::makeTitleSafe( NS_USER, $s-&gt;user_name );
&gt; 		$time = $wgLang-&gt;timeanddate( wfTimestamp(TS_MW, $s-&gt;log_timestamp), true );
&gt; 
&gt;+ 		# Hide all logs or the log types in $wgHidenLogs.
&gt;+ 		# Block and rights are namespace independed.
&gt;+ 		if((is_array($wgHidenLogs) &amp;&amp;
&gt;+ 			((in_array('block', $wgHidenLogs) &amp;&amp; $s-&gt;log_type =='block' )
&gt;+ 			||(in_array('rights', $wgHidenLogs) &amp;&amp; $s-&gt;log_type=='rights'))
&gt;+ 			||($wgHideLogs &amp;&amp; ($s-&gt;log_type=='block' ||$s-&gt;log_type=='rights')))){
&gt;+ 				return;
&gt;+ 		}
&gt;+ 
&gt;+ 		# Upload namespaces are public.
&gt;+ 		if(is_array($wgHidenLogs) &amp;&amp;
&gt;+ 			(in_array('upload', $wgHidenLogs) &amp;&amp; $s-&gt;log_type=='upload') ||
&gt;+ 			($wgHideLogs &amp;&amp; $s-&gt;log_type=='upload')) {
&gt;+ 				return;
&gt;+ 		}
&gt;+ 
&gt;+ 		# We hide the rest only for the restricted namespaces.
&gt;+ 		if(!$wgUser-&gt;canAccessNamespace($s-&gt;log_namespace)){
&gt;+ 			if($wgHideLogs){
&gt;+ 				return;
&gt;+ 			}
&gt;+ 			if(is_array($wgHidenLogs)){
&gt;+ 				if((in_array('protect', $wgHidenLogs) &amp;&amp; $s-&gt;log_type=='protect')
&gt;+ 					||(in_array('delete', $wgHidenLogs) &amp;&amp; $s-&gt;log_type=='delete')
&gt;+ 					||(in_array('move', $wgHidenLogs) &amp;&amp; $s-&gt;log_type=='move')){
&gt;+ 						return;
&gt;+ 				}
&gt;+ 			}
&gt;+ 		}
&gt;+
&gt; 		// Enter the existence or non-existence of this page into the link cache,
&gt; 		// for faster makeLinkObj() in LogPage::actionText()
&gt; 		$linkCache =&amp; LinkCache::singleton();
&gt;diff -iEbdu -r ./includes/SpecialPreferences.php ./includes/SpecialPreferences.php
&gt;--- ./includes/SpecialPreferences.php	2006-12-07 11:51:17.164600800 +0100
&gt;+++ ./includes/SpecialPreferences.php	2006-12-07 15:30:57.730789300 +0100
&gt;&#64;&#64; -88,7 +88,7 &#64;&#64;
&gt; 		if ( $this-&gt;mPosted ) {
&gt; 			$namespaces = $wgContLang-&gt;getNamespaces();
&gt; 			foreach ( $namespaces as $i =&gt; $namespace ) {
&gt;-				if ( $i &gt;= 0 ) {
&gt;+				if ( $i &gt;= 0 &amp;&amp; $wgUser-&gt;canAccessNamespace( $i) ) {
&gt; 					$this-&gt;mSearchNs[$i] = $request-&gt;getCheck( &quot;wpNs$i&quot; ) ? 1 : 0;
&gt; 				}
&gt; 			}
&gt;&#64;&#64; -384,7 +384,7 &#64;&#64;
&gt; 
&gt; 		$namespaces = $wgContLang-&gt;getNamespaces();
&gt; 		foreach ( $namespaces as $i =&gt; $namespace ) {
&gt;-			if ( $i &gt;= NS_MAIN ) {
&gt;+			if ( $i &gt;= NS_MAIN &amp;&amp; $wgUser-&gt;canAccessNamespace( $i) ) {
&gt; 				$this-&gt;mSearchNs[$i] = $wgUser-&gt;getOption( 'searchNs'.$i );
&gt; 			}
&gt; 		}
&gt;&#64;&#64; -394,14 +394,14 &#64;&#64;
&gt; 	 * &#64;access private
&gt; 	 */
&gt; 	function namespacesCheckboxes() {
&gt;-		global $wgContLang;
&gt;+		global $wgContLang, $wgUser;
&gt; 
&gt; 		# Determine namespace checkboxes
&gt; 		$namespaces = $wgContLang-&gt;getNamespaces();
&gt; 		$<a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/1" title="revision 1 in SVN">r1</a> = null;
&gt; 
&gt; 		foreach ( $namespaces as $i =&gt; $name ) {
&gt;-			if ($i &lt; 0)
&gt;+			if ($i &lt; 0 || !$wgUser-&gt;canAccessNamespace( $i) )
&gt; 				continue;
&gt; 			$checked = $this-&gt;mSearchNs[$i] ? &quot;checked='checked'&quot; : '';
&gt; 			$name = str_replace( '_', ' ', $namespaces[$i] );
&gt;diff -iEbdu -r ./includes/SpecialRandompage.php ./includes/SpecialRandompage.php
&gt;--- ./includes/SpecialRandompage.php	2006-10-14 02:06:36.000000000 +0200
&gt;+++ ./includes/SpecialRandompage.php	2006-12-07 15:30:59.058965300 +0100
&gt;&#64;&#64; -11,12 +11,15 &#64;&#64;
&gt;  *               used as e.g. Special:Randompage/Category
&gt;  */
&gt; function wfSpecialRandompage( $par = NS_MAIN ) {
&gt;-	global $wgOut, $wgExtraRandompageSQL, $wgContLang, $wgLang;
&gt;+	global $wgOut, $wgExtraRandompageSQL, $wgContLang, $wgLang, $wgUser;
&gt; 	$fname = 'wfSpecialRandompage';
&gt; 
&gt; 	# Determine namespace
&gt; 	$t = Title::newFromText ( $par . &quot;:Dummy&quot; ) ;
&gt; 	$namespace = $t-&gt;getNamespace () ;
&gt;+ 	if ($namespace === false || $namespace &lt; NS_MAIN || !$wgUser-&gt;canAccessNamespace($namespace)) {
&gt;+ 		$namespace = NS_MAIN;
&gt;+ 	}
&gt; 
&gt; 	# NOTE! We use a literal constant in the SQL instead of the RAND()
&gt; 	# function because RAND() will return a different value for every row
&gt;diff -iEbdu -r ./includes/SpecialRecentchanges.php ./includes/SpecialRecentchanges.php
&gt;--- ./includes/SpecialRecentchanges.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialRecentchanges.php	2006-12-07 15:30:55.011934900 +0100
&gt;&#64;&#64; -17,6 +17,7 &#64;&#64;
&gt; 	global $wgUser, $wgOut, $wgRequest, $wgUseRCPatrol, $wgDBtype;
&gt; 	global $wgRCShowWatchingUsers, $wgShowUpdatedMarker;
&gt; 	global $wgAllowCategorizedRecentChanges ;
&gt;+	global $wgRestrictedNamespaces, $wgHideCategoriesinRC, $wgHidenLogs, $wgHideLogs, $wgHideUtalk;
&gt; 	$fname = 'wfSpecialRecentchanges';
&gt; 
&gt; 	# Get query parameters
&gt;&#64;&#64; -124,8 +125,9 &#64;&#64;
&gt; 
&gt; 	# Get last modified date, for client caching
&gt; 	# Don't use this if we are using the patrol feature, patrol changes don't update the timestamp
&gt;+	# Don't use it if there are hidden namespaces, as the feed must be different for the users
&gt; 	$lastmod = $dbr-&gt;selectField( 'recentchanges', 'MAX(rc_timestamp)', false, $fname );
&gt;-	if ( $feedFormat || !$wgUseRCPatrol ) {
&gt;+	if ( !is_array( $wgRestrictedNamespaces ) &amp;&amp; ($feedFormat || !$wgUseRCPatrol) ) {
&gt; 		if( $lastmod &amp;&amp; $wgOut-&gt;checkLastModified( $lastmod ) ){
&gt; 			# Client cache fresh and headers sent, nothing more to do.
&gt; 			return;
&gt;&#64;&#64; -152,6 +154,32 &#64;&#64;
&gt; 		}
&gt; 	}
&gt; 
&gt;+ 	# Hide all categories if $wgHideCategoriesinRC is set
&gt;+ 	$hidem .= $wgHideCategoriesinRC ? ' AND rc_namespace &lt;&gt; 14':'';
&gt;+ 	# Hide all User_talk pages if $wgHideUtalk is set
&gt;+ 	$hidem .= $wgHideUtalk ? ' AND rc_namespace &lt;&gt; 3':'';
&gt;+ 	# Hide all logs if $wgHideRCLogs is set
&gt;+ 	$hidem .= $wgHideLogs ? ' AND rc_type &lt;&gt; 3':'';
&gt;+ 	# Hide all logs or the log types in $wgHidenLogs.
&gt;+ 	if(!$wgHideLogs &amp;&amp; is_array($wgHidenLogs)){
&gt;+ 		# Block and rights are namespace independed.
&gt;+ 		$hidem .= in_array('block', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/block&quot;':'';
&gt;+ 		$hidem .= in_array('rights', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/rights&quot;':'';
&gt;+ 		# Hide the log types set in $wgHidenLogs
&gt;+ 		$hidem .= in_array('protect', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/protect&quot;':'';
&gt;+ 		$hidem .= in_array('delete', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/delete&quot;':'';
&gt;+ 		$hidem .= in_array('upload', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/upload&quot;':'';
&gt;+ 		$hidem .= in_array('move', $wgHidenLogs) ? ' AND rc_title &lt;&gt; &quot;Log/move&quot;':'';
&gt;+ 	}
&gt;+ 	# Exclude all namespaces that are restricted to this user
&gt;+ 	if( is_array( $wgRestrictedNamespaces )) {
&gt;+ 		foreach( $wgRestrictedNamespaces as $key =&gt; $value ) {
&gt;+ 			if( ! $wgUser-&gt;canAccessNamespace( $key )) {
&gt;+ 				$hidem .= ' AND rc_namespace &lt;&gt;' . $key;
&gt;+ 			}
&gt;+ 		}
&gt;+ 	}
&gt;+
&gt; 	# Namespace filtering
&gt; 	$hidem .= is_null( $namespace ) ?  '' : ' AND rc_namespace' . ($invert ? '!=' : '=') . $namespace;
&gt; 
&gt;&#64;&#64; -349,8 +377,13 &#64;&#64;
&gt; 		 * go ahead and use it even if there have been edits made
&gt; 		 * since it was rendered. This keeps a swarm of requests
&gt; 		 * from being too bad on a super-frequently edited wiki.
&gt;+		 *
&gt;+		 * Using restricted namespaces forbids caching the feed,
&gt;+		 * however, since it must be rendered according to user
&gt;+		 * rights.
&gt; 		 */
&gt;-		if( time() - wfTimestamp( TS_UNIX, $feedLastmod )
&gt;+		if( !is_array( $wgRestrictedNamespaces )
&gt;+			&amp;&amp; time() - wfTimestamp( TS_UNIX, $feedLastmod )
&gt; 				&lt; $wgFeedCacheTimeout
&gt; 			|| wfTimestamp( TS_UNIX, $feedLastmod )
&gt; 				&gt; wfTimestamp( TS_UNIX, $lastmod ) ) {
&gt;diff -iEbdu -r ./includes/SpecialRecentchangeslinked.php ./includes/SpecialRecentchangeslinked.php
&gt;--- ./includes/SpecialRecentchangeslinked.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialRecentchangeslinked.php	2006-12-07 15:22:21.173792100 +0100
&gt;&#64;&#64; -67,6 +67,16 &#64;&#64;
&gt; 		$cmq = 'AND rc_minor=0';
&gt; 	} else { $cmq = ''; }
&gt; 
&gt;+	# Exclude all namespaces that are restricted to this user
&gt;+ 	global $wgRestrictedNamespaces;
&gt;+ 	if( is_array( $wgRestrictedNamespaces )) {
&gt;+ 		foreach( $wgRestrictedNamespaces as $key =&gt; $value ) {
&gt;+ 			if( ! $wgUser-&gt;canAccessNamespace( $key )) {
&gt;+ 				$cmq .= ' AND page_namespace &lt;&gt;' . $key;
&gt;+ 			}
&gt;+ 		}
&gt;+ 	}
&gt;+
&gt; 	extract( $dbr-&gt;tableNames( 'recentchanges', 'categorylinks', 'pagelinks', 'revision', 'page' , &quot;watchlist&quot; ) );
&gt; 
&gt; 	$uid = $wgUser-&gt;getID();
&gt;diff -iEbdu -r ./includes/SpecialUserlogin.php ./includes/SpecialUserlogin.php
&gt;--- ./includes/SpecialUserlogin.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialUserlogin.php	2006-12-07 15:30:54.574418100 +0100
&gt;&#64;&#64; -475,6 +475,7 &#64;&#64;
&gt; 	function successfulLogin( $msg, $auto = true ) {
&gt; 		global $wgUser;
&gt; 		global $wgOut;
&gt;+		global $wgLinkWarn;
&gt; 
&gt; 		# Run any hooks; ignore results
&gt; 
&gt;&#64;&#64; -484,12 +485,20 &#64;&#64;
&gt; 		$wgOut-&gt;setRobotpolicy( 'noindex,nofollow' );
&gt; 		$wgOut-&gt;setArticleRelated( false );
&gt; 		$wgOut-&gt;addWikiText( $msg );
&gt;+		if($wgUser-&gt;getRMainPages() != NULL) {
&gt;+ 			# We are going to put some links to restricted namespaces
&gt;+ 			# that the user has access to, so we disable the warning.
&gt;+ 			$wgLinkWarn = false;
&gt;+ 			$wgOut-&gt;addWikiText(wfMsg('RNSlist').&quot;&lt;br&gt;&quot;.str_replace( '_', ' ',$wgUser-&gt;getRMainPages()));
&gt;+ 			$wgOut-&gt;returnToMain(false);
&gt;+		} else {
&gt; 		if ( !empty( $this-&gt;mReturnTo ) ) {
&gt; 			$wgOut-&gt;returnToMain( $auto, $this-&gt;mReturnTo );
&gt; 		} else {
&gt; 			$wgOut-&gt;returnToMain( $auto );
&gt; 		}
&gt; 	}
&gt;+	}
&gt; 
&gt; 	/** */
&gt; 	function userNotPrivilegedMessage() {
&gt;diff -iEbdu -r ./includes/SpecialWantedpages.php ./includes/SpecialWantedpages.php
&gt;--- ./includes/SpecialWantedpages.php	2006-10-14 02:06:36.000000000 +0200
&gt;+++ ./includes/SpecialWantedpages.php	2006-12-07 15:30:58.871458100 +0100
&gt;&#64;&#64; -67,10 +67,15 &#64;&#64;
&gt; 
&gt; 
&gt; 	function formatResult( $skin, $result ) {
&gt;-		global $wgLang;
&gt;+		global $wgLang, $wgUser;
&gt; 
&gt; 		$title = Title::makeTitleSafe( $result-&gt;namespace, $result-&gt;title );
&gt; 
&gt;+		# Don't show wanted pages in restricted namespaces
&gt;+ 		if( !$wgUser-&gt;canAccessNamespace( $title-&gt;getNamespace() ) ) {
&gt;+ 			return &quot;&quot;;
&gt;+ 		}
&gt;+
&gt; 		if( $this-&gt;isCached() ) {
&gt; 			# Check existence; which is stored in the link cache
&gt; 			if( !$title-&gt;exists() ) {
&gt;diff -iEbdu -r ./includes/SpecialWhatlinkshere.php ./includes/SpecialWhatlinkshere.php
&gt;--- ./includes/SpecialWhatlinkshere.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/SpecialWhatlinkshere.php	2006-12-07 15:30:54.761925300 +0100
&gt;&#64;&#64; -73,7 +73,7 &#64;&#64;
&gt; 	 * &#64;private
&gt; 	 */
&gt; 	function showIndirectLinks( $level, $target, $limit, $from = 0, $dir = 'next' ) {
&gt;-		global $wgOut;
&gt;+		global $wgOut, $wgUser;
&gt; 		$fname = 'WhatLinksHerePage::showIndirectLinks';
&gt; 
&gt; 		$dbr =&amp; wfGetDB( DB_READ );
&gt;&#64;&#64; -199,6 +199,11 &#64;&#64;
&gt; 
&gt; 		$wgOut-&gt;addHTML( '&lt;ul&gt;' );
&gt; 		foreach ( $rows as $row ) {
&gt;+			#If the linking page is located in a secured namespace, skip it.
&gt;+ 			if(!$wgUser-&gt;canAccessNamespace($row-&gt;page_namespace)) {
&gt;+ 				continue;
&gt;+ 			}
&gt;+
&gt; 			$nt = Title::makeTitle( $row-&gt;page_namespace, $row-&gt;page_title );
&gt; 
&gt; 			if ( $row-&gt;page_is_redirect ) {
&gt;diff -iEbdu -r ./includes/Title.php ./includes/Title.php
&gt;--- ./includes/Title.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/Title.php	2006-12-07 17:06:26.249622900 +0100
&gt;&#64;&#64; -1026,6 +1026,10 &#64;&#64;
&gt; 			wfProfileOut( $fname );
&gt; 			return false;
&gt; 		}
&gt;+		if( !$wgUser-&gt;canAccessNamespace( $this-&gt;mNamespace )) {
&gt;+ 			wfProfileOut( $fname );
&gt;+ 			return false;
&gt;+ 		}
&gt; 		// XXX: This is the code that prevents unprotecting a page in NS_MEDIAWIKI
&gt; 		// from taking effect -ævar
&gt; 		if( NS_MEDIAWIKI == $this-&gt;mNamespace &amp;&amp;
&gt;&#64;&#64; -1133,7 +1137,7 &#64;&#64;
&gt; 			return $result;
&gt; 		}
&gt; 
&gt;-		if( $wgUser-&gt;isAllowed('read') ) {
&gt;+		if( $wgUser-&gt;isAllowed('read', $this) ) {
&gt; 			return true;
&gt; 		} else {
&gt; 			global $wgWhitelistRead;
&gt;&#64;&#64; -1147,18 +1151,19 &#64;&#64;
&gt; 			}
&gt; 
&gt; 			/** some pages are explicitly allowed */
&gt;+			if( is_array( $wgWhitelistRead )) {
&gt; 			$name = $this-&gt;getPrefixedText();
&gt;-			if( $wgWhitelistRead &amp;&amp; in_array( $name, $wgWhitelistRead ) ) {
&gt;+ 				if( in_array( $name, $wgWhitelistRead ) ) {
&gt; 				return true;
&gt; 			}
&gt;-
&gt; 			# Compatibility with old settings
&gt;-			if( $wgWhitelistRead &amp;&amp; $this-&gt;getNamespace() == NS_MAIN ) {
&gt;+ 				if( $this-&gt;getNamespace() == NS_MAIN ) {
&gt; 				if( in_array( ':' . $name, $wgWhitelistRead ) ) {
&gt; 					return true;
&gt; 				}
&gt; 			}
&gt; 		}
&gt;+		}
&gt; 		return false;
&gt; 	}
&gt; 
&gt;diff -iEbdu -r ./includes/User.php ./includes/User.php
&gt;--- ./includes/User.php	2006-10-14 02:06:32.000000000 +0200
&gt;+++ ./includes/User.php	2006-12-07 15:30:54.011896500 +0100
&gt;&#64;&#64; -871,6 +871,7 &#64;&#64;
&gt; 			}
&gt; 
&gt; 			$effectiveGroups = array_merge( $implicitGroups, $this-&gt;mGroups );
&gt;+
&gt; 			$this-&gt;mRights = $this-&gt;getGroupPermissions( $effectiveGroups );
&gt; 		}
&gt; 
&gt;&#64;&#64; -1348,16 +1349,155 &#64;&#64;
&gt; 	 * &#64;param string $action Action to be checked
&gt; 	 * &#64;return boolean True: action is allowed, False: action should not be allowed
&gt; 	 */
&gt;-	function isAllowed($action='') {
&gt;+	function isAllowed($action='', $title=NULL) {
&gt;+		global $wgRestrictedNamespaces, $wgReadOnlyNSes;
&gt; 		if ( $action === '' )
&gt; 			// In the spirit of DWIM
&gt; 			return true;
&gt; 
&gt; 		$this-&gt;loadFromDatabase();
&gt;+		if( $title == NULL ) {
&gt;+			global $wgTitle;
&gt;+			$title = $wgTitle;
&gt;+		}
&gt;+		$ns = $title-&gt;getNamespace();
&gt;+
&gt;+		// If user wants to read a page, that page is in a read only namespace
&gt;+		// and the user has the 'roread' right, allow him to read it. If it has
&gt;+		// the 'roedit' right allow him to edit it.
&gt;+		if( is_array($wgReadOnlyNSes)) {
&gt;+			if( $action == 'read' &amp;&amp; in_array($ns, $wgReadOnlyNSes) &amp;&amp;
&gt;+				in_array('roread', $this-&gt;mRights) &amp;&amp; !$this-&gt;isBlocked() ) {
&gt;+					return true;
&gt;+			}
&gt;+			if( $action == 'edit' &amp;&amp; !$title-&gt;isProtected() &amp;&amp;
&gt;+				in_array($ns, $wgReadOnlyNSes) &amp;&amp; in_array('roedit', $this-&gt;mRights) &amp;&amp; !$this-&gt;isBlocked()) {
&gt;+					return true;
&gt;+			}
&gt;+		}
&gt;+
&gt;+		// Prevent access to restricted namespaces if the user does not have all
&gt;+		// required rights.
&gt;+		if( !$this-&gt;canAccessNamespace($ns) ) {
&gt;+			return false;
&gt;+		}
&gt;+
&gt;+		// If we are in user's page, allow him to do everything...
&gt;+		if ( $action == 'edit' &amp;&amp; ($ns == NS_USER_TALK || $ns == NS_USER) &amp;&amp;
&gt;+			$title-&gt;getText() == $this-&gt;getName() &amp;&amp; !$this-&gt;isBlocked() &amp;&amp; !$title-&gt;isProtected() ) {
&gt;+				return true;
&gt;+		}
&gt;+
&gt;+		if ( $action == 'protect' &amp;&amp; ($ns == NS_USER_TALK || $ns == NS_USER) &amp;&amp;
&gt;+			$title-&gt;getText() == $this-&gt;getName() &amp;&amp; !$this-&gt;isBlocked() ){
&gt;+				return true;
&gt;+		}
&gt;+
&gt;+		// If user wants to edit a talk page and has the talk right, allow him to do so...
&gt;+		if( $title-&gt;isTalkPage() &amp;&amp; $action == 'edit' &amp;&amp; in_array('talk', $this-&gt;mRights) &amp;&amp;
&gt;+			!$this-&gt;isBlocked() &amp;&amp; !$title-&gt;isProtected() ){
&gt;+				return true;
&gt;+		}
&gt;+
&gt;+		// If user wants to leave a mesage on another's user talk page and that page is unprotected, allow him to do so...
&gt;+		if( $action == 'edit' &amp;&amp; $ns == NS_USER_TALK &amp;&amp; !$this-&gt;isBlocked() &amp;&amp; !$title-&gt;isProtected() ){
&gt;+			return true;
&gt;+		}
&gt;+
&gt;+		// If user has the sedit right, allow him to edit pages in the restricted namespaces
&gt;+		// he has access.
&gt;+		if( is_array($wgRestrictedNamespaces) &amp;&amp; array_key_exists($ns, $wgRestrictedNamespaces)
&gt;+				&amp;&amp; $this-&gt;canAccessNamespace($ns) &amp;&amp; !$this-&gt;isBlocked() ){
&gt;+			if( $action == 'edit' &amp;&amp; in_array('sedit', $this-&gt;mRights) &amp;&amp; !$title-&gt;isProtected() ) {
&gt;+				return true;
&gt;+			}
&gt;+
&gt;+			// If user has the sprotect right, allow him to edit pages in the  in the restricted namespaces
&gt;+			// he has access.
&gt;+			if(($action == 'protect' || $action == 'unprotect') &amp;&amp; in_array('sprotect', $this-&gt;mRights)) {
&gt;+				return true;
&gt;+			}
&gt;+
&gt;+			// If user has the sdelete right, allow him to edit pages in the  in the restricted namespaces
&gt;+			// he has access.
&gt;+			if( !$title-&gt;isProtected() &amp;&amp; ($action == 'delete' || $action == 'undelete') &amp;&amp;
&gt;+				(in_array('sdelete', $this-&gt;mRights)) ) {
&gt;+					return true;
&gt;+			}
&gt;+		}
&gt;+
&gt;+		//If the user wants to delete or undelete a page and it's blocked don't allow him to do so.
&gt;+		if( ($action == 'delete' || $action == 'undelete') &amp;&amp; ($title-&gt;isProtected() || $this-&gt;isBlocked()) ){
&gt;+			return false;
&gt;+		}
&gt;+
&gt;+		//If the user wants to protect or unprotect a page and it's blocked don't allow him to do so.
&gt;+		if( ($action == 'protect' || $action == 'unprotect') &amp;&amp; $this-&gt;isBlocked() ){
&gt;+			return false;
&gt;+		}
&gt;+		
&gt; 		return in_array( $action , $this-&gt;mRights );
&gt; 	}
&gt; 
&gt; 	/**
&gt;+	 * Check if user is allowed to access a given namespace
&gt;+	 * &#64;param string $namespace ID of the namespace that needs to be checked.
&gt;+	 * &#64;return boolean True: access is allowed, False: access is denied
&gt;+	 */
&gt;+	function canAccessNamespace( $namespace='' ) {
&gt;+		global $wgRestrictedNamespaces;
&gt;+		$this-&gt;loadFromDatabase();
&gt;+		if( is_array( $wgRestrictedNamespaces )) {
&gt;+			if( array_key_exists( $namespace, $wgRestrictedNamespaces ) ) {
&gt;+				if( in_array($wgRestrictedNamespaces[$namespace], $this-&gt;mRights)){
&gt;+					return true;
&gt;+				}
&gt;+				return false;
&gt;+			}
&gt;+		}
&gt;+		return true;
&gt;+	}
&gt;+
&gt;+	/**
&gt;+	 * Get the restricted namespaces the user has access to (talk namespaces not included).
&gt;+	 * &#64;return string with the namespace names seperated by the &quot;\n&quot; character/
&gt;+	 */
&gt;+	function getAllowedRNSes() {
&gt;+		global $wgRestrictedNamespaces;
&gt;+		$this-&gt;loadFromDatabase();
&gt;+		$names = NULL;
&gt;+		if( is_array( $wgRestrictedNamespaces ) ) {
&gt;+			foreach ($wgRestrictedNamespaces as $nsid =&gt; $ugroup) {
&gt;+				#if( $this-&gt;canAccessNamespace($nsid) &amp;&amp; !($nsid %2) ) { #huh!?!? what the hell is the mod 2 about?
&gt;+				if( $this-&gt;canAccessNamespace($nsid) ) {
&gt;+					$names .= Namespace::getCanonicalName($nsid).&quot;\n&quot;;
&gt;+				}
&gt;+			}
&gt;+		}
&gt;+		return $names;
&gt;+	}
&gt;+
&gt;+	/**
&gt;+	 * Get the main page title of each restricted namespace (talk namespaces not included)
&gt;+	 * the user has access to.
&gt;+	 * &#64;return string: The titles seperated by the  &quot;\n&quot; character.
&gt;+	 */
&gt;+	function getRMainPages() {
&gt;+		global $wgRestrictedNamespaces;
&gt;+		$titles = NULL;
&gt;+		if( is_array( $wgRestrictedNamespaces ) ) {
&gt;+			$namespaces = $this-&gt;getAllowedRNSes();
&gt;+			$nsarray = explode(&quot;\n&quot;,$namespaces);
&gt;+			foreach ($nsarray as $index =&gt; $nsname) {
&gt;+				if($nsname != &quot;&quot;){
&gt;+					$titles .= &quot;[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=%22.%24nsname.%22%3A%22.wfMsgForContent%28%20%27mainpage%27%20%29.%22">&quot;.$nsname.&quot;:&quot;.wfMsgForContent( 'mainpage' ).&quot;</a>|&quot;.$nsname.&quot;]]&quot;.&quot;&lt;br/&gt;\n&quot;;
&gt;+				}
&gt;+			}
&gt;+		}
&gt;+		return $titles;
&gt;+	}
&gt;+
&gt;+	/**
&gt; 	 * Load a skin if it doesn't exist or return it
&gt; 	 * &#64;todo FIXME : need to check the old failback system [AV]
&gt; 	 */
&gt;&#64;&#64; -1370,7 +1510,8 &#64;&#64;
&gt; 			# get the user skin
&gt; 			$userSkin = $this-&gt;getOption( 'skin' );
&gt; 			$userSkin = $wgRequest-&gt;getVal('useskin', $userSkin);
&gt;-
&gt;+			ini_set('display_errors', true);
&gt;+			ini_set('error_reporting', 2047);
&gt; 			$this-&gt;mSkin =&amp; Skin::newFromKey( $userSkin );
&gt; 			wfProfileOut( $fname );
&gt; 		}
&gt;diff -iEbdu -r ./includes/Wiki.php ./includes/Wiki.php
&gt;--- ./includes/Wiki.php	2006-10-14 02:06:34.000000000 +0200
&gt;+++ ./includes/Wiki.php	2006-12-07 15:30:56.855755700 +0100
&gt;&#64;&#64; -331,7 +331,6 &#64;&#64;
&gt; 			/* No such action; this will switch to the default case */
&gt; 			$action = 'nosuchaction';
&gt; 		}
&gt;-
&gt; 		switch( $action ) {
&gt; 			case 'view':
&gt; 				$output-&gt;setSquidMaxage( $this-&gt;getVal( 'SquidMaxage' ) );
&gt;diff -iEbdu -r ./languages/messages/MessagesEn.php ./languages/messages/MessagesEn.php
&gt;--- ./languages/messages/MessagesEn.php	2006-10-14 02:07:00.000000000 +0200
&gt;+++ ./languages/messages/MessagesEn.php	2006-12-07 15:30:59.512107700 +0100
&gt;&#64;&#64; -1589,6 +1589,7 &#64;&#64;
&gt; # Namespace form on various pages
&gt; 'namespace' =&gt; 'Namespace:',
&gt; 'invert' =&gt; 'Invert selection',
&gt;+'RNSlist' =&gt; 'Available Namespaces',
&gt; 
&gt; # Contributions
&gt; #
&gt;diff -iEbdu -r ./skins/CologneBlue.php ./skins/CologneBlue.php
&gt;--- ./skins/CologneBlue.php	2006-10-14 02:06:12.000000000 +0200
&gt;+++ ./skins/CologneBlue.php	2006-12-07 15:20:32.734904100 +0100
&gt;&#64;&#64; -183,41 +183,43 &#64;&#64;
&gt; 		$s .= $this-&gt;menuHead( &quot;qbfind&quot; );
&gt; 		$s .= $this-&gt;searchForm();
&gt; 
&gt;-		$s .= $this-&gt;menuHead( &quot;qbbrowse&quot; );
&gt;+		#$s .= $this-&gt;menuHead( &quot;qbbrowse&quot; );
&gt; 
&gt;-		# Use the first heading from the Monobook sidebar as the &quot;browse&quot; section
&gt;+		# Use the first two headings from the Monobook sidebar as the &quot;browse&quot; section
&gt; 		$bar = $this-&gt;buildSidebar();
&gt;-		$browseLinks = reset( $bar );
&gt;-
&gt;+		foreach($bar as $sectionTitle =&gt; $browseLinks)
&gt;+		{
&gt;+			$s .= $this-&gt;menuHeadText($sectionTitle);	
&gt; 		foreach ( $browseLinks as $link ) {
&gt; 			if ( $link['text'] != '-' ) {
&gt; 				$s .= &quot;&lt;a href=\&quot;{$link['href']}\&quot;&gt;&quot; .
&gt; 					htmlspecialchars( $link['text'] ) . '&lt;/a&gt;' . $sep;
&gt; 			}
&gt; 		}
&gt;+		}
&gt; 
&gt; 		if ( $wgOut-&gt;isArticle() ) {
&gt;-			$s .= $this-&gt;menuHead( &quot;qbedit&quot; );
&gt;-			$s .= &quot;&lt;strong&gt;&quot; . $this-&gt;editThisPage() . &quot;&lt;/strong&gt;&quot;;
&gt;-
&gt;-			$s .= $sep . $this-&gt;makeKnownLink( wfMsgForContent( &quot;edithelppage&quot; ), wfMsg( &quot;edithelp&quot; ) );
&gt;-
&gt;-			if( $wgUser-&gt;isLoggedIn() ) {
&gt;-				$s .= $sep . $this-&gt;moveThisPage();
&gt;-			}
&gt;-			if ( $wgUser-&gt;isAllowed('delete') ) {
&gt;-				$dtp = $this-&gt;deleteThisPage();
&gt;-				if ( &quot;&quot; != $dtp ) {
&gt;-					$s .= $sep . $dtp;
&gt;-				}
&gt;-			}
&gt;-			if ( $wgUser-&gt;isAllowed('protect') ) {
&gt;-				$ptp = $this-&gt;protectThisPage();
&gt;-				if ( &quot;&quot; != $ptp ) {
&gt;-					$s .= $sep . $ptp;
&gt;-				}
&gt;-			}
&gt;-			$s .= $sep;
&gt;+#			$s .= $this-&gt;menuHead( &quot;qbedit&quot; );
&gt;+#			$s .= &quot;&lt;strong&gt;&quot; . $this-&gt;editThisPage() . &quot;&lt;/strong&gt;&quot;;
&gt;+#
&gt;+#			$s .= $sep . $this-&gt;makeKnownLink( wfMsgForContent( &quot;edithelppage&quot; ), wfMsg( &quot;edithelp&quot; ) );
&gt;+#
&gt;+#			if( $wgUser-&gt;isLoggedIn() ) {
&gt;+#				$s .= $sep . $this-&gt;moveThisPage();
&gt;+#			}
&gt;+#			if ( $wgUser-&gt;isAllowed('delete') ) {
&gt;+#				$dtp = $this-&gt;deleteThisPage();
&gt;+#				if ( &quot;&quot; != $dtp ) {
&gt;+#					$s .= $sep . $dtp;
&gt;+#				}
&gt;+#			}
&gt;+#			if ( $wgUser-&gt;isAllowed('protect') ) {
&gt;+#				$ptp = $this-&gt;protectThisPage();
&gt;+#				if ( &quot;&quot; != $ptp ) {
&gt;+#					$s .= $sep . $ptp;
&gt;+#				}
&gt;+#			}
&gt;+#			$s .= $sep;
&gt; 
&gt; 			$s .= $this-&gt;menuHead( &quot;qbpageoptions&quot; );
&gt; 			$s .= $this-&gt;talkLink()
&gt;&#64;&#64; -295,6 +297,12 &#64;&#64;
&gt; 		return $s;
&gt; 	}
&gt; 
&gt;+	function menuHeadText( $text )
&gt;+	{
&gt;+		$s = &quot;\n&lt;h6&gt;&quot; . $text . &quot;&lt;/h6&gt;&quot;;
&gt;+		return $s;
&gt;+	}
&gt;+
&gt; 	function searchForm( $label = &quot;&quot; )
&gt; 	{
&gt; 		global $wgRequest;</span ></pre>
    </div><div id="c134" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c134">Comment 134</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-02 11:40:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Please do *NOT* post future patches here, maintain them elsewhere. The above
comment is particularly irritating because it leaves a large, unwanted email in
the inboxes of people who are trying to monitor other, more important bugs.</pre>
    </div><div id="c135" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c135">Comment 135</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">qsheets095
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-10 01:29:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I'm sorry... I meant for it to attach itself to the last attachment since the
edit was so minor (SkinTemplate.php). </pre>
    </div><div id="c136" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c136">Comment 136</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Edward Z. Yang</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-10 01:40:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Is there any particular reason why you nuked the CC list?</pre>
    </div><div id="c137" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c137">Comment 137</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kristian Spilhaug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-19 22:28:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I am sorry for disturbing once again, hopefully it will be the last posting here.

Joseph Southwell and myself have made a SourceForge-project of this patch. It
can be found at 

<a href="http://sourceforge.net/projects/hiddenwiki/">http://sourceforge.net/projects/hiddenwiki/</a>

So far the latest patch only work for MediaWiki 1.8.2, but hopefully it will be
updated soon.

Anyone interested in joining as developers may feel free to send me an e-mail,
and I'll include you as soon as possible.</pre>
    </div><div id="c138" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c138">Comment 138</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rotem Liss</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-20 08:12:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*Do not remove people from the CC list.* They will choose whether they would
like to get updates or not. Especially, *do not remove <a href="mailto:wikibugs-l&#64;wikipedia.org">wikibugs-l&#64;wikipedia.org</a>
from the CC list*, as many people use it to get updates from all the bugs.</pre>
    </div><div id="c139" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c139">Comment 139</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rotem Liss</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-01-20 08:14:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Changed Assigned field, sorry for the bug-spam.</pre>
    </div><div id="c140" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c140">Comment 140</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JayEdgar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-02 15:57:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Will this mod be updated for MW 1.9? or does the status=closed(wontfix) mean that it's done?

Many thanks.</pre>
    </div><div id="c141" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c141">Comment 141</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kristian Spilhaug</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-02 16:10:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >As mentioned in <a href="show_bug.cgi?id=1924#c137">comment #137</a>:

Check out <a href="http://sourceforge.net/projects/hiddenwiki/">http://sourceforge.net/projects/hiddenwiki/</a> for updates and new
releases for this patch, or if you want to contribute with the development.

Please post comments and requests there, and NOT here.</pre>
    </div><div id="c142" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1924#c142">Comment 142</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JayEdgar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-02 16:22:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >My apologies. I didn't see 137. /jte</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=1924&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1924">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=1924">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=1924">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=1924&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=1924" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=1924&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419359700-xtQU-D9GYFR3c9K77Xsb5lFY1C0XmOcD2L4NDlI5dWc">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>