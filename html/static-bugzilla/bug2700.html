<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 2700 &ndash; Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=2700&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=2700">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=2700">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=2700">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 2700 – Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)",  
                             "show_bug.cgi?id=2700" );
        document.title = "Bug 2700 – Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 2700 – Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_NEW bz_product_MediaWiki bz_component_Parser bz_bug_2700 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2014-11-20 09:11:23 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-11-20 09:11:23">
  <input type="hidden" name="longdesclength" value="92">
  <input type="hidden" name="id" value="2700">
  <input type="hidden" name="token" value="1419360894-rMidtyYyczm19VyPQkGxmuHllMZQKf9FbubIKCu3K74">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=2700"><b>Bug&nbsp;2700</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td><span title="Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)">Pre-save transform skips extensions using wikitext (gallery, references, foot...
        </span>
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">NEW
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>Parser
    
    (<a href="buglist.cgi?component=Parser&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">All
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>High
       major<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=2700">37 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=2700#vote_2700">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Nobody - You can work on this!</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label for="duplicates">Duplicates</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - template substitution does not work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=6157">6157</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - any links inside &lt;gallery&gt; won't autopipe"
   href="show_bug.cgi?id=6222">6222</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pre-save transform not executed for references (signatures, pipe trick, subst don't work)"
   href="show_bug.cgi?id=6814">6814</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pre-save transform not applied to markup inside &lt;ref&gt; container"
   href="show_bug.cgi?id=8125">8125</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - When a subst: is used inside a &lt;ref&gt; it doesn't get subst'ed"
   href="show_bug.cgi?id=8929">8929</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - &quot;pipe trick&quot; links don't work"
   href="show_bug.cgi?id=10927">10927</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - subst: don't work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=12016">12016</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - refs fail to parse the piped link trick"
   href="show_bug.cgi?id=13072">13072</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - New parser breaks signatures inside gallery tags"
   href="show_bug.cgi?id=13120">13120</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipetrick doesn't work in gallery image caption"
   href="show_bug.cgi?id=13141">13141</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Problem with &lt;ref&gt; and [[xxx (yyy)|]]"
   href="show_bug.cgi?id=13959">13959</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Auto-piping does not work in galleries"
   href="show_bug.cgi?id=14007">14007</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Cannot substitute templates withing &lt;ref&gt; tags"
   href="show_bug.cgi?id=14550">14550</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipe trick not working when used as template parameter that is in turn used in a reference citation"
   href="show_bug.cgi?id=15467">15467</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic conversion of the wikitext doesn't work in references"
   href="show_bug.cgi?id=15547">15547</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic piped links do not work in &lt;ref&gt; tags"
   href="show_bug.cgi?id=16183">16183</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - pipe trick does not work inside ref tags"
   href="show_bug.cgi?id=16904">16904</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - The &quot;pipe trick&quot; does not work in footnotes"
   href="show_bug.cgi?id=18064">18064</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - subst is not parsed within footnotes"
   href="show_bug.cgi?id=18825">18825</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Subst: prefix does not work in image captions inside &lt;gallery&gt;&lt;/gallery&gt; tags."
   href="show_bug.cgi?id=20359">20359</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Five tildes don't produce timestamp in en.wikipedia article namespace"
   href="show_bug.cgi?id=22258">22258</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - ~~~~ in &lt;gallery&gt;"
   href="show_bug.cgi?id=24131">24131</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Magic words, templates and parser functions not substituted in &lt;ref&gt; tags"
   href="show_bug.cgi?id=24160">24160</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic signatures (~~~~) do not work in &lt;ref&gt;&lt;/ref&gt;"
   href="show_bug.cgi?id=24446">24446</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Template substitution doesn't work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=26859">26859</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipe trick doesn't work within ref"
   href="show_bug.cgi?id=28680">28680</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - &lt;ref&gt;...&lt;/ref&gt; in template"
   href="show_bug.cgi?id=29775">29775</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Substitution not working in gallery tags"
   href="show_bug.cgi?id=30135">30135</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Inter-project links into &lt;ref&gt; do not work when alternative text is empty"
   href="show_bug.cgi?id=35954">35954</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - {{subst:foo}} does not work in &lt;ref&gt;"
   href="show_bug.cgi?id=42078">42078</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - {{subst: doesn't work inside &lt;ref&gt;...&lt;/ref&gt;"
   href="show_bug.cgi?id=72079">72079</a> 
      </span>
      (<a href="buglist.cgi?bug_id=6157,6222,6814,8125,8929,10927,12016,13072,13120,13141,13959,14007,14550,15467,15547,16183,16904,18064,18825,20359,22258,24131,24160,24446,26859,28680,29775,30135,35954,42078,72079">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_REOPENED "
   title="REOPENED - rvexpandtemplates=true does not expand templates in ref tags"
   href="show_bug.cgi?id=24774">24774</a> <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - UNIQ issues (tracking)"
   href="show_bug.cgi?id=26213">UNIQ</a> <a class="bz_bug_link 
          bz_status_ASSIGNED "
   title="ASSIGNED - VisualEditor: When using citation templates, the page title and access date fields should be filled automatically"
   href="show_bug.cgi?id=56772">56772</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=2700&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=2700">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2005-07-04 21:53 UTC by <span class="vcard"><span class="fn">David Benbennick</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2014-11-20 09:11 UTC 
      (<a href="show_activity.cgi?id=2700">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>59 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="541329866">541329866</option>
                <option value="arkbug">arkbug</option>
                <option value="bawolff+wn">bawolff+wn</option>
                <option value="billinghurstwiki">billinghurstwiki</option>
                <option value="bluehairedlawyer">bluehairedlawyer</option>
                <option value="bugs">bugs</option>
                <option value="bugzillawikimedia.askec">bugzillawikimedia.askec</option>
                <option value="cbm.wikipedia">cbm.wikipedia</option>
                <option value="church.of.emacs.ml">church.of.emacs.ml</option>
                <option value="conrad.irwin">conrad.irwin</option>
                <option value="cuerden">cuerden</option>
                <option value="daniel">daniel</option>
                <option value="danny.b">danny.b</option>
                <option value="dixond">dixond</option>
                <option value="dogma">dogma</option>
                <option value="ed.palmer">ed.palmer</option>
                <option value="eep">eep</option>
                <option value="federicoleva">federicoleva</option>
                <option value="gsvick">gsvick</option>
                <option value="gustronico">gustronico</option>
                <option value="gwicke">gwicke</option>
                <option value="happy.melon.wiki">happy.melon.wiki</option>
                <option value="he7d3r+bugs">he7d3r+bugs</option>
                <option value="huji.huji">huji.huji</option>
                <option value="jackmcbarn+wmbz">jackmcbarn+wmbz</option>
                <option value="jamydlan">jamydlan</option>
                <option value="jan.dudik">jan.dudik</option>
                <option value="jayvdb">jayvdb</option>
                <option value="l.rabinelli+bugzilla">l.rabinelli+bugzilla</option>
                <option value="legoktm.wikipedia">legoktm.wikipedia</option>
                <option value="liangent">liangent</option>
                <option value="mah">mah</option>
                <option value="martineznovo">martineznovo</option>
                <option value="matanya">matanya</option>
                <option value="matma.rex">matma.rex</option>
                <option value="mediawiki-bugs">mediawiki-bugs</option>
                <option value="mediawiki">mediawiki</option>
                <option value="meno25mail">meno25mail</option>
                <option value="nicdumz">nicdumz</option>
                <option value="nickanc.wiki">nickanc.wiki</option>
                <option value="nospam">nospam</option>
                <option value="nvervelle">nvervelle</option>
                <option value="Nx.devnull">Nx.devnull</option>
                <option value="nzmoihue">nzmoihue</option>
                <option value="orenbochman">orenbochman</option>
                <option value="ori">ori</option>
                <option value="Platonides">Platonides</option>
                <option value="richard">richard</option>
                <option value="roan.kattouw">roan.kattouw</option>
                <option value="robth1">robth1</option>
                <option value="sanbec">sanbec</option>
                <option value="seahen123">seahen123</option>
                <option value="sirabder87">sirabder87</option>
                <option value="ta.bu.shi.da.yu">ta.bu.shi.da.yu</option>
                <option value="tim">tim</option>
                <option value="waldir">waldir</option>
                <option value="wicke">wicke</option>
                <option value="wikipedia_emails-nachfrage">wikipedia_emails-nachfrage</option>
                <option value="will.pittenger1+wikibugzilla">will.pittenger1+wikibugzilla</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=5952"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">a patch to allow extensions to output wikitext</span></b></a>

          <span class="bz_attach_extra_info">
              (5.68 KB,
                patch)

            <br>
            <a href="#attach_5952"
               title="Go to the comment associated with the attachment">2009-03-22 20:13 UTC</a>,

            <span class="vcard">bluehairedlawyer
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=5952&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=9806"
               title="View the content of the attachment">
          <b>Patch to allow extensions to specify a function that is executed during preSaveTransform</b></a>

          <span class="bz_attach_extra_info">
              (4.62 KB,
                patch)

            <br>
            <a href="#attach_9806"
               title="Go to the comment associated with the attachment">2012-01-05 01:11 UTC</a>,

            <span class="vcard"><span class="fn">Nikola Kovacs</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=9806&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=10450"
               title="View the content of the attachment">
          <b>Some parser tests</b></a>

          <span class="bz_attach_extra_info">
              (12.51 KB,
                text/plain)

            <br>
            <a href="#attach_10450"
               title="Go to the comment associated with the attachment">2012-04-22 20:18 UTC</a>,

            <span class="vcard">bluehairedlawyer
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=10450&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=10451"
               title="View the content of the attachment">
          <b>Allow extensions to specify tag contents can be passed through preSaveTransform without being escaped</b></a>

          <span class="bz_attach_extra_info">
              (3.26 KB,
                patch)

            <br>
            <a href="#attach_10451"
               title="Go to the comment associated with the attachment">2012-04-22 20:29 UTC</a>,

            <span class="vcard">bluehairedlawyer
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=10451&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (1)
        </span>
        <a href="attachment.cgi?bugid=2700&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Benbennick</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-07-04 21:53:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >See [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=User%3ADbenbenn%2Fsandbox%23Gallery_pipe_trick">User:Dbenbenn/sandbox#Gallery_pipe_trick</a>]], for example.  A 
link in the caption of a gallery image ending in |]] is broken.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">brianna.laugher
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-25 09:10:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Can't be too hard to fix... can it? :)</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-06 17:11:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - any links inside &lt;gallery&gt; won't autopipe"
   href="show_bug.cgi?id=6222">Bug 6222</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">goldom
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-06 17:47:24 UTC
        </span>
      </div>



<pre class="bz_comment_text" >sorry bout 6222, I did a search for &lt;gallery&gt; first but that wasn't in this
one's name.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-06 19:39:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - template substitution does not work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=6157">Bug 6157</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Magnus Manske</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-13 10:11:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Fixed in SVN.</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">brianna.laugher
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-13 12:21:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >So... when should this take effect? (
<a href="http://en.wikibooks.org/wiki/User:Pfctdayelise">http://en.wikibooks.org/wiki/User:Pfctdayelise</a> has a gallery with these pipes)</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rob Church</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-13 12:40:36 UTC
        </span>
      </div>



<pre class="bz_comment_text" >When it's been reviewed and upon the next synchronisation, like all other fixes
and additions.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-13 18:13:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Patch is bogus, does not fix reported cases.</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">baumanns</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-13 10:04:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It seems to work for me. Doesn't it?
Greetings</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-03 02:26:27 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pre-save transform not applied to markup inside &lt;ref&gt; container"
   href="show_bug.cgi?id=8125">Bug 8125</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-12-03 02:26:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pre-save transform not executed for references (signatures, pipe trick, subst don't work)"
   href="show_bug.cgi?id=6814">Bug 6814</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-09 17:01:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - When a subst: is used inside a &lt;ref&gt; it doesn't get subst'ed"
   href="show_bug.cgi?id=8929">Bug 8929</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-08-14 20:53:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - &quot;pipe trick&quot; links don't work"
   href="show_bug.cgi?id=10927">Bug 10927</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 21:37:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - subst: don't work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=12016">Bug 12016</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Raimond Spekking</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-02-19 17:00:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - refs fail to parse the piped link trick"
   href="show_bug.cgi?id=13072">Bug 13072</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-05 17:58:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Problem with &lt;ref&gt; and [[xxx (yyy)|]]"
   href="show_bug.cgi?id=13959">Bug 13959</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-07 02:45:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Auto-piping does not work in galleries"
   href="show_bug.cgi?id=14007">Bug 14007</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nicolas Dumazet</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-07 16:43:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Seems that it is broken again :)

<a href="http://fr.wikipedia.org/w/index.php?title=Alaska&amp;diff=prev&amp;oldid=29263402">http://fr.wikipedia.org/w/index.php?title=Alaska&amp;diff=prev&amp;oldid=29263402</a> references is a good example of [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=title%20%28disambig%29">title (disambig)</a>|]] not showing properly</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-11 00:34:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - New parser breaks signatures inside gallery tags"
   href="show_bug.cgi?id=13120">Bug 13120</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Adam Cuerden</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-12 00:57:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >So, with all the closing down of other bugs as duplicates of this... when is someone going to make an attempt to fix it? </pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-07-05 00:07:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Cannot substitute templates withing &lt;ref&gt; tags"
   href="show_bug.cgi?id=14550">Bug 14550</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lejonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-09-10 12:25:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic conversion of the wikitext doesn't work in references"
   href="show_bug.cgi?id=15547">Bug 15547</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Majid Abder Rahman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-09-10 12:49:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Still not working subst within reference (e.g.: <a href="http://it.wikipedia.org/w/index.php?title=Hardcore_punk&amp;diff=18368819&amp;oldid=18364416">http://it.wikipedia.org/w/index.php?title=Hardcore_punk&amp;diff=18368819&amp;oldid=18364416</a> )</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">bdk</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-10-30 20:15:26 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic piped links do not work in &lt;ref&gt; tags"
   href="show_bug.cgi?id=16183">Bug 16183</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">bdk</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-10-30 20:20:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipe trick not working when used as template parameter that is in turn used in a reference citation"
   href="show_bug.cgi?id=15467">Bug 15467</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">bdk</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-01-06 21:42:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - pipe trick does not work inside ref tags"
   href="show_bug.cgi?id=16904">Bug 16904</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-02-28 20:17:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This one's been around for quite a while...

The problem here is that MediaWiki treats all extension tags as if they don't contain wikitext, so extensions that do contain wikitext, such as Cite, have to call the parser themselves. And in so doing miss out on the pre-save transformations.

Ideally we should be able to set extension hooks so that their wikitext output gets parser along with everything else.</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Splarka</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-03-20 02:14:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - The &quot;pipe trick&quot; does not work in footnotes"
   href="show_bug.cgi?id=18064">Bug 18064</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Umherirrender</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-03-20 17:41:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >#tag allows you to use that trick in refs and other tags

see [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=mw%3AHelp%3AMagic%20words%23Miscellaneous">mw:Help:Magic words#Miscellaneous</a>]]</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rich Farmbrough</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-03-22 09:27:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I have moved the severity up to normal.  This bug causes problems with using apparently standard wiki-syntax in certain places where it could be expected to be usable.  As such it requires special case handling or adoption of sub-optimal approaches to certain tasks.  I would have thought that extensions could be flagged as requiring or  not requiring pre-save processing.</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-03-22 20:13:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=5952" name="attach_5952" title="a patch to allow extensions to output wikitext">attachment 5952</a> <a href="attachment.cgi?id=5952&amp;action=edit" title="a patch to allow extensions to output wikitext">[details]</a></span>
a patch to allow extensions to output wikitext

This patch allows extensions to specify that they contain and output wikitext. The result being that such extensions don't have to invoke the parser themselves and the pre-save transformation work as they should do.

Unfortunately this doesn't work for either gallery or imagemap tags as they don't contain pure wikitext.</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-17 23:50:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - subst is not parsed within footnotes"
   href="show_bug.cgi?id=18825">Bug 18825</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">CBM</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-18 00:13:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Note that the syntax {{#tag:ref|{{subst:today}}}} works as expected.</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alexandre Emsenhuber [IAlex]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-08-22 22:12:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Subst: prefix does not work in image captions inside &lt;gallery&gt;&lt;/gallery&gt; tags."
   href="show_bug.cgi?id=20359">Bug 20359</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-08-24 13:13:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >CBM +  Umherirrender:

The whole point here is that we're trying to keep it as simple as possible. There's no point trying to tell people about #ref when a fair number of people over at enwiki can't figure out relative links. The best thing to do is to make work what most editors think should work. This bug is now 4 years old and has 19 deplicates. That should tell you enough.</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jesús Martínez Novo (Ciencia Al Poder)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-01-04 19:54:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipetrick doesn't work in gallery image caption"
   href="show_bug.cgi?id=13141">Bug 13141</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alex Z.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-01-25 06:48:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Five tildes don't produce timestamp in en.wikipedia article namespace"
   href="show_bug.cgi?id=22258">Bug 22258</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Conrad Irwin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 15:07:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The pipe-trick part of this is now resolved. subst: can be fixed by using safesubst: instead, so it's just signatures left.</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Solitarius</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-17 05:50:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >For information only, this bug and the use of {{subst:...}} inside a &lt;ref&gt; is mentioned in [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=fr%3AWikip%C3%A9dia%3AGuilde_des_Guides%2Fsemaine_11_2010">fr:Wikipédia:Guilde_des_Guides/semaine_11_2010</a>]].</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mormegil</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-05-29 09:14:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Just a note: Conrad’s changes mentioned in <a href="show_bug.cgi?id=2700#c38">comment 38</a> had been reverted in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/62689" title="revision 62689 in SVN">r62689</a>.</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rich Farmbrough</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-19 19:40:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >&quot; subst: can be fixed by using safesubst: &quot;

So we tell all editors everywhere to use safesubst: instead of subst: ? Or what?  I don't see this as a fix, more a work-around - but then I haven't experimented with safesubst: so perhaps I'm missing the point.</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alexandre Emsenhuber [IAlex]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-28 14:50:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - ~~~~ in &lt;gallery&gt;"
   href="show_bug.cgi?id=24131">Bug 24131</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alexandre Emsenhuber [IAlex]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-28 17:34:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Magic words, templates and parser functions not substituted in &lt;ref&gt; tags"
   href="show_bug.cgi?id=24160">Bug 24160</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c44" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">[no longer active user]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-28 23:14:57 UTC
        </span>
      </div>



<pre class="bz_comment_text" >no, safesubst can not
testcase:
&lt;ref&gt;{{safesubst:formatnum:12321123}}&lt;/ref&gt;&lt;references/&gt;</pre>
    </div><div id="c45" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-19 19:44:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Automatic signatures (~~~~) do not work in &lt;ref&gt;&lt;/ref&gt;"
   href="show_bug.cgi?id=24446">Bug 24446</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c46" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Krinkle</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-19 19:50:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >If the bug is not present when using {{#ref instead of &lt;ref&gt; then I asume the bug isn't as big as we might think ? They should both render the same, right ?</pre>
    </div><div id="c47" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-19 19:54:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >They'll render the same if passed the same input.  &lt;ref&gt; is passed input without the PST being run, {{#tag:ref}} is passed the input after the PST is run on it.  Something like that.  I'm pretty sure some people know exactly what the bug is and have some idea how to fix it, but I'm not one of them.</pre>
    </div><div id="c48" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c48">Comment 48</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-19 19:58:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c47">comment #47</a>)
<span class="quote">&gt; They'll render the same if passed the same input.  &lt;ref&gt; is passed input
&gt; without the PST being run, {{#tag:ref}} is passed the input after the PST is
&gt; run on it.  Something like that.</span >
That's exactly right: PST runs on {{stuff in braces}} but not on &lt;tags&gt;.

<span class="quote">&gt; I'm pretty sure some people know exactly what
&gt; the bug is and have some idea how to fix it, but I'm not one of them.</span >

What I think happens is &lt;tags&gt; get armored before PST; &lt;nowiki&gt; needs this treatment, but for other tags it causes this bug.</pre>
    </div><div id="c49" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c49">Comment 49</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">db [inactive,noenotif]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-22 11:21:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Template substitution doesn't work inside &lt;ref&gt; tags"
   href="show_bug.cgi?id=26859">Bug 26859</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c50" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c50">Comment 50</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-02-16 23:44:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The simple way to fix the original problem is to accept the pipe trick natively. So even if they are not done in the PST, they render as if they were. And just ignore things like signatures/subst inside references.

The other option is to start using a transparent hook.</pre>
    </div><div id="c51" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c51">Comment 51</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Happy-melon</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-04-24 10:12:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Pipe trick doesn't work within ref"
   href="show_bug.cgi?id=28680">Bug 28680</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c52" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c52">Comment 52</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Huji</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-09 23:58:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c50">comment #50</a>)
<span class="quote">&gt; The simple way to fix the original problem is to accept the pipe trick
&gt; natively. So even if they are not done in the PST, they render as if they were.
&gt; And just ignore things like signatures/subst inside references.
&gt; 
&gt; The other option is to start using a transparent hook.</span >

I think having subst inside &lt;ref&gt; is something desirable and substs shouldn't be ignored inside references. Templates like {{cite web}} and others used on Wikipedia are an example; if we could {{subst:DATE}} in them, we didn't have to type in the current date in them.</pre>
    </div><div id="c53" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c53">Comment 53</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-11 15:36:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >You can use things like {{subst:DATE}}. But then the {{cite web}} template itself where you include it needs to be substed as well.</pre>
    </div><div id="c54" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c54">Comment 54</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Svick</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-11 18:44:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c53">comment #53</a>)
<span class="quote">&gt; You can use things like {{subst:DATE}}. But then the {{cite web}} template
&gt; itself where you include it needs to be substed as well.</span >

You mean something like &lt;ref&gt;{{subst:cite web | … | accessdate = {{subst:DATE}} }}&lt;/ref&gt;? That doesn't work.</pre>
    </div><div id="c55" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c55">Comment 55</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-11 21:00:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Try using {{#tag:ref|{{subst:cite web | … | accessdate = {{subst:DATE}} }} }}</pre>
    </div><div id="c56" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c56">Comment 56</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rich Farmbrough</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-17 07:17:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >That's great, but subst'ing {{Cite web}} (etc.)  would be a disaster.  Simply for &quot;Subst:&quot; this is a basic problem which people have had to code round in Javascript and bot code.  Leaving this bug unassigned means increasing amounts of resource are used to code for these special cases (which, of course rely on the underlying templates (where appropriate) not changing) as more tools are developed to work on Wikitext. 

For example SmackBot (now Helpful Pixe Bot) used to use &quot;Subst:CURRENTMONTHNAME&quot; to date tags. Mainly because of this bug I had to write code to regenerate the XML for AWB to use the explicit monthname, a side effect being that all changes to the XML had to be back-ported to the component model.  Moreover if I didn't regenerate the XML the wrong month was used.

Now AWB is no longer used for this I use the current system ides of the GMT month, which is pretty good, but still creates an unneeded dependency on my system clock.

Similarly there are probably workarounds for the other extensions which are not processed but the idea of having a mark-up language that works one way on parts of the page and another on other parts, except through design, is a real bad one.

Although it doesn't currently cause _me_ problems -

I'd like to see this prioritized.</pre>
    </div><div id="c57" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c57">Comment 57</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mark A. Hershberger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-18 15:52:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - &lt;ref&gt;...&lt;/ref&gt; in template"
   href="show_bug.cgi?id=29775">Bug 29775</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c58" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c58">Comment 58</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lejonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-30 20:28:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Substitution not working in gallery tags"
   href="show_bug.cgi?id=30135">Bug 30135</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c59" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c59">Comment 59</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">billinghurst</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-08-08 04:32:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Can I give another example of what I think is the same issue, the inability to perform the pipe trick within {{#ref:}}

Example that does not work (at enWS)

{{subst:#tag:ref|[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Author%3ACharles%20Darwin">Author:Charles Darwin</a>|]]}}

should expand to give &lt;ref&gt;[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Author%3ACharles%20Darwin">Author:Charles Darwin</a>|Charles Darwin]]&lt;/ref&gt; though it just replicates &lt;ref&gt;[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Author%3ACharles%20Darwin">Author:Charles Darwin</a>|]]&lt;/ref&gt;. I am not seeing other issues, though I am willing to undertake trials if there are tests that are desire.</pre>
    </div><div id="c60" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c60">Comment 60</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gadget850</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-08-08 04:45:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c59">comment #59</a>)
<span class="quote">&gt; Can I give another example of what I think is the same issue, the inability to
&gt; perform the pipe trick within {{#ref:}}
&gt; 
&gt; Example that does not work (at enWS)
&gt; 
&gt; {{subst:#tag:ref|[[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Author%3ACharles%20Darwin">Author:Charles Darwin</a>|]]}}</span >

That will never work— subst only applies to templates and #tag is a magic word. What you are trying is equivalent to &lt;subst:ref&gt; which will not work.</pre>
    </div><div id="c61" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c61">Comment 61</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">billinghurst</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-08-08 06:53:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >What will never work?  The subst: expansion of the tag?  Seems to work perfectly for me and has been for a while.

My issue is that the piping trick[1] stops working when it is inside either the &lt;ref&gt; or {{#tag:ref|...}}

[1] <a href="http://en.wikipedia.org/wiki/Help:Pipe_trick">http://en.wikipedia.org/wiki/Help:Pipe_trick</a></pre>
    </div><div id="c62" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c62">Comment 62</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Helder</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-12-19 17:32:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I just noticed that subst isn't working inside of &lt;ref&gt; tags:
<a href="https://pt.wikipedia.org/w/index.php?diff=prev&amp;oldid=28035465">https://pt.wikipedia.org/w/index.php?diff=prev&amp;oldid=28035465</a>

I believe this is the same bug.</pre>
    </div><div id="c63" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c63">Comment 63</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nemo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-12-28 13:58:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Pipe trick doesn't work with Translate extension popups, I guess it's this bug again. <a href="https://translatewiki.net/w/i.php?title=MediaWiki:Bw-desc-freecol/it&amp;diff=prev&amp;oldid=3550365">https://translatewiki.net/w/i.php?title=MediaWiki:Bw-desc-freecol/it&amp;diff=prev&amp;oldid=3550365</a></pre>
    </div><div id="c64" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c64">Comment 64</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Umherirrender</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-04 18:54:56 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c63">comment #63</a>)
<span class="quote">&gt; Pipe trick doesn't work with Translate extension popups, I guess it's this bug
&gt; again.
&gt; <a href="https://translatewiki.net/w/i.php?title=MediaWiki:Bw-desc-freecol/it&amp;diff=prev&amp;oldid=3550365">https://translatewiki.net/w/i.php?title=MediaWiki:Bw-desc-freecol/it&amp;diff=prev&amp;oldid=3550365</a></span >

That does not sounds like this, because it is not wrapping within a extension tag. Edit over GUI works for that title, this sounds like a problem with the edit api. You should fill a new bug for that.</pre>
    </div><div id="c65" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c65">Comment 65</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nikola Kovacs</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-05 01:11:24 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=9806" name="attach_9806" title="Patch to allow extensions to specify a function that is executed during preSaveTransform">attachment 9806</a> <a href="attachment.cgi?id=9806&amp;action=edit" title="Patch to allow extensions to specify a function that is executed during preSaveTransform">[details]</a></span>
Patch to allow extensions to specify a function that is executed during preSaveTransform

This patch introduces a mechanism similar to the tag hooks, the only difference is that the callback function gets called when the output type is set to OT_WIKI (which normally means during preSaveTransform), and that the enclosing tags with the parameters are not removed.

An extension can register a callback and then do pre-save transformation on its content - this is the best solution in my opinion, since only the extension knows which parts of the content are supposed to be transformed, e.g. in the case of the gallery tag only the description part.

This is a work in progress/proof of concept, in particular the galleryPST function calls parser-&gt;preSaveTransform, which might cause problems if it breaks the parser state. This will probably need something re-entrant like recursiveTagParse.

All parser tests passed.</pre>
    </div><div id="c66" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c66">Comment 66</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mark A. Hershberger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-10 18:53:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Thanks for this patch!  We've been in a code slush (<a href="http://lists.wikimedia.org/pipermail/wikitech-l/2012-January/057313.html">http://lists.wikimedia.org/pipermail/wikitech-l/2012-January/057313.html</a>) for a
few weeks so we're just getting around to looking at these.

We're also doing a lot of parser work, so I'm not sure how relevant this is,
but I'll ask them to take a look, but I'll still get someone to look.</pre>
    </div><div id="c67" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c67">Comment 67</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gabriel Wicke</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-28 20:43:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c65">comment #65</a>)

<span class="quote">&gt; An extension can register a callback and then do pre-save transformation on its
&gt; content - this is the best solution in my opinion, since only the extension
&gt; knows which parts of the content are supposed to be transformed, e.g. in the
&gt; case of the gallery tag only the description part.</span >

I am not too enthusiastic about encouraging extensions to do their own arbitrary pre-save transform processing. In the longer run, general support for extensions working with parsed (and pre-save transformed) wikitext / HTML DOM input could be cleaner and should offer better opportunities for integration with a visual editor. I am working on something like that in the Parsoid parser (<a href="http://mediawiki.org/wiki/Parsoid">http://mediawiki.org/wiki/Parsoid</a>). There is also a simple and undocumented method for something vaguely like this in the PHP parser (the setTransparentTagHook method).

However, I do not have a good solution for partly-parsed and -transformed extensions like gallery. Will give this some thought, and ask others about their ideas.</pre>
    </div><div id="c68" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c68">Comment 68</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Krinkle</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-07 07:36:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_PATCH_TO_REVIEW "
   title="PATCH_TO_REVIEW - &lt;ref&gt; doesn't expand triple-brace template parameters"
   href="show_bug.cgi?id=34999">Bug 34999</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c69" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c69">Comment 69</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mark A. Hershberger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-09 04:35:46 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c67">comment #67</a>)
<span class="quote">&gt; I am not too enthusiastic about encouraging extensions to do their own
&gt; arbitrary pre-save transform processing.</span >

lowering priority</pre>
    </div><div id="c70" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c70">Comment 70</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">billinghurst</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-09 10:41:56 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c69">comment #69</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=2700#c67">comment #67</a>)
&gt; &gt; I am not too enthusiastic about encouraging extensions to do their own
&gt; &gt; arbitrary pre-save transform processing.
&gt; 
&gt; lowering priority</span >

I am not sure how to equate the &quot;lowering the priority&quot; for a significant issue that doesn't follow normal wiki behaviour?  We get numerous responses akin to &quot;I don't like it&quot; however no solutions.

Cite must be one of the most commonly used extensions in wikipedia space, and one would think that it is used multiple times per page.  We have a fairly common practice with the renowned pipe trick, and now at <a href="show_bug.cgi?id=2700#c69">comment #69</a>, you are saying that we are &quot;lowering the priority&quot;.  How about we consider the basic users and solve some of the base underlying issues that bug users every day, or isn't that sexy enough to gather attention?  For some of us this is a large annoyance, where we have to create work arounds, by scripting buttons, or doing significant copy and paste.</pre>
    </div><div id="c71" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c71">Comment 71</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gabriel Wicke</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-09 12:13:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >&#64;billinghurst: Cite can be covered by something like bluehairedlawyer's patch (<span class="bz_obsolete"><a href="attachment.cgi?id=5952" name="attach_5952" title="a patch to allow extensions to output wikitext">attachment 5952</a> <a href="attachment.cgi?id=5952&amp;action=edit" title="a patch to allow extensions to output wikitext">[details]</a></span> / <a href="show_bug.cgi?id=2700#c31">comment 31</a>), as its entire content is parsed as wikitext.</pre>
    </div><div id="c72" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c72">Comment 72</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael M.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-14 08:47:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Inter-project links into &lt;ref&gt; do not work when alternative text is empty"
   href="show_bug.cgi?id=35954">Bug 35954</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c73" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c73">Comment 73</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">DavidL</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-14 13:54:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >More than 6 years after this bug as been reported, the bug is still there !
How many time should we wait for correction ?
Priority must not be Low !</pre>
    </div><div id="c74" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c74">Comment 74</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">DavidL</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-14 13:55:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Priority = High because blocking another High priority bug.</pre>
    </div><div id="c75" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c75">Comment 75</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nikola Kovacs</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-20 07:59:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c67">comment #67</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=2700#c65">comment #65</a>)
&gt; 
&gt; &gt; An extension can register a callback and then do pre-save transformation on its
&gt; &gt; content - this is the best solution in my opinion, since only the extension
&gt; &gt; knows which parts of the content are supposed to be transformed, e.g. in the
&gt; &gt; case of the gallery tag only the description part.
&gt; 
&gt; I am not too enthusiastic about encouraging extensions to do their own
&gt; arbitrary pre-save transform processing. In the longer run, general support for
&gt; extensions working with parsed (and pre-save transformed) wikitext / HTML DOM
&gt; input could be cleaner and should offer better opportunities for integration
&gt; with a visual editor. I am working on something like that in the Parsoid parser
&gt; (<a href="http://mediawiki.org/wiki/Parsoid">http://mediawiki.org/wiki/Parsoid</a>). There is also a simple and undocumented
&gt; method for something vaguely like this in the PHP parser (the
&gt; setTransparentTagHook method).
&gt; 
&gt; However, I do not have a good solution for partly-parsed and -transformed
&gt; extensions like gallery. Will give this some thought, and ask others about
&gt; their ideas.</span >

If the problem is that extensions could do arbitrary processing instead of the standard PST, then the only solution I can think of is to allow extension to somehow specify which part of their input should be transformed, and then let the parser do the processing. Implementing that would probably be much harder and more cumbersome.

The only thing that needs to be done on my patch is that I'm not sure the extension calling parser-&gt;preSaveTransform is 100% safe. I can give it a go if you want, but I don't want to waste my time if the patch will be rejected because my approach (letting the extension do the PST) is not the correct one.

New parsers are nice and all, but they do not fix the problem that we have right now, and they probably never will if you want to keep the current gallery syntax.</pre>
    </div><div id="c76" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c76">Comment 76</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-21 22:05:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Actually David's wrong. This bug is seven not six years old. If its not fixed soon we'll have to figure out who's going to pay for it to go to college...

What would be wrong with running the all the contents of a &lt;gallery&gt; through preSaveTransform? I realise it's not wikitext but then preSaveTransform isn't the full parser? What particular pre-save transforms would corrupt the gallery syntax?</pre>
    </div><div id="c77" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c77">Comment 77</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nikola Kovacs</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-21 22:19:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=2700#c76">comment #76</a>)
<span class="quote">&gt; Actually David's wrong. This bug is seven not six years old. If its not fixed
&gt; soon we'll have to figure out who's going to pay for it to go to college...
&gt; 
&gt; What would be wrong with running the all the contents of a &lt;gallery&gt; through
&gt; preSaveTransform? I realise it's not wikitext but then preSaveTransform isn't
&gt; the full parser? What particular pre-save transforms would corrupt the gallery
&gt; syntax?</span >

I don't know off the top of my head what characters are allowed in filenames (in particular, is [, { or ~ allowed), but in theory:

&lt;gallery&gt;
File:Oh noez [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=This%20is%20not%20a%20link.png">This is not a link.png</a>|]] yeah, I know, this is a contrived example
&lt;/gallery&gt;

There's also replacing tildes, substing and the reverse pipe trick. Replacing tildes would be the most realistic problem (if ~ is allowed in filenames)</pre>
    </div><div id="c78" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c78">Comment 78</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-22 01:14:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >[ { are both disallowed in any page name (which includes images). Three or more ~'s in a row is also forbidden in page titles. So you don't have to worry about that.


Personally I favour an approach of adding an interface for adding parserHooks that allows specifying options (such as if the parser hook should allow PST).


<span class="quote">&gt;Actually David's wrong. This bug is seven not six years old. If its not fixed
&gt;soon we'll have to figure out who's going to pay for it to go to college...</span >

That's still a good 11 years away. We're cross that bridge when we come to it.</pre>
    </div><div id="c79" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c79">Comment 79</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-22 20:18:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=10450" name="attach_10450" title="Some parser tests">attachment 10450</a> <a href="attachment.cgi?id=10450&amp;action=edit" title="Some parser tests">[details]</a></span>
Some parser tests</pre>
    </div><div id="c80" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c80">Comment 80</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-22 20:29:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=10451" name="attach_10451" title="Allow extensions to specify tag contents can be passed through preSaveTransform without being escaped">attachment 10451</a> <a href="attachment.cgi?id=10451&amp;action=edit" title="Allow extensions to specify tag contents can be passed through preSaveTransform without being escaped">[details]</a></span>
Allow extensions to specify tag contents can be passed through preSaveTransform without being escaped

This is an alternative to Nikola's patch. It allows extensions and internal setHook functions to specify that there contents can be run through the preSaveTransform function without being escaped.

It passes all the current parser tests and a few others I've managed to throw at it.</pre>
    </div><div id="c81" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c81">Comment 81</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sumana Harihareswara</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-05-25 02:46:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >bluehairedlawyer, could you put this patch in Gerrit?</pre>
    </div><div id="c82" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c82">Comment 82</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">bluehairedlawyer
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-07 09:06:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Dan Collins has already done this (which is just as well as I haven't figured out how to do it yet). Here's the url:

<a href="https://gerrit.wikimedia.org/r/#/c/8784/">https://gerrit.wikimedia.org/r/#/c/8784/</a></pre>
    </div><div id="c83" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c83">Comment 83</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-08 15:31:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >That was a smart way to solve it.

Commented some concerns on gerrit.</pre>
    </div><div id="c84" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c84">Comment 84</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">matanya</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-08-14 10:52:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >patch moved to gerrit, removing patch need review.</pre>
    </div><div id="c85" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c85">Comment 85</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ori Livneh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-09-16 20:53:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Dan Collins has two patches, not one:
<a href="https://gerrit.wikimedia.org/r/#/c/8784/">https://gerrit.wikimedia.org/r/#/c/8784/</a> (previously mentioned)
and 
<a href="https://gerrit.wikimedia.org/r/#/c/8785/">https://gerrit.wikimedia.org/r/#/c/8785/</a></pre>
    </div><div id="c86" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c86">Comment 86</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bartosz Dziewoński</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-13 19:45:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - {{subst:foo}} does not work in &lt;ref&gt;"
   href="show_bug.cgi?id=42078">Bug 42078</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c87" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c87">Comment 87</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bartosz Dziewoński</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-13 19:48:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Somebdy should really give those patches some love, as apparently the original committer has disappeared.</pre>
    </div><div id="c88" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c88">Comment 88</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andre Klapper</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-07-23 09:03:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Gabriel: As you assigned this report to yourself a year ago, do you plean to rework the two patches?</pre>
    </div><div id="c89" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c89">Comment 89</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andre Klapper</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-03-11 14:40:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Gabriel: As you assigned this report to yourself two years ago, do you plan to rework the two patches? Or are they &quot;somehow&quot; obsoleted in the meantime?</pre>
    </div><div id="c90" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c90">Comment 90</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Notification Bot</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-04-05 18:44:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Change 8784 abandoned by Siebrand:
(<a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - Pre-save transform skips extensions using wikitext (gallery, references, footnotes, Cite, status indicators, pipe trick, subst, signatures)"
   href="show_bug.cgi?id=2700">Bug 2700</a>) Pre-save transform inside extension hooks

Reason:
I'm abandoning this patch set as it's been open for a long time without any outlook at the open issues being resolved. 

If the submitter or anyone else would like to work on it again, this patch set can be re-activated by clicking &quot;Restore Change&quot;. Please only do this if you are actually going to work on it immediately.

<a href="https://gerrit.wikimedia.org/r/8784">https://gerrit.wikimedia.org/r/8784</a></pre>
    </div><div id="c91" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2700#c91">Comment 91</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Umherirrender</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-15 14:42:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - {{subst: doesn't work inside &lt;ref&gt;...&lt;/ref&gt;"
   href="show_bug.cgi?id=72079">Bug 72079</a> has been marked as a duplicate of this bug. ***</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=2700&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=2700">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=2700">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=2700">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=2700&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=2700" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=2700&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419360894-niho7guxjmezaidHMimV4tf-2qALEhiISZ_e-H4yFB0">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>