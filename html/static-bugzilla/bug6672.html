<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 6672 &ndash; EXIF orientation (rotation information from digital cameras) should be used in images</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=6672&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=6672">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=6672">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=6672">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 6672 – EXIF orientation (rotation information from digital cameras) should be used in images",  
                             "show_bug.cgi?id=6672" );
        document.title = "Bug 6672 – EXIF orientation (rotation information from digital cameras) should be used in images";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 6672 – EXIF orientation (rotation information from digital cameras) should be used in images", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_RESOLVED bz_product_MediaWiki bz_component_File_management bz_bug_6672 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2012-03-25 05:52:32 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2012-03-25 05:52:32">
  <input type="hidden" name="longdesclength" value="61">
  <input type="hidden" name="id" value="6672">
  <input type="hidden" name="token" value="1419367255-MaEQ_hHDbtLZlXQKjO09RGzhjA7F0pmdmyvxYDHebqc">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=6672"><b>Bug&nbsp;6672</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">EXIF orientation (rotation information from digital cameras) should be used in images</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td><span title="EXIF orientation (rotation information from digital cameras) should be used in images">EXIF orientation (rotation information from digital cameras) should be used i...
        </span>
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('EXIF orientation (rotation information from digital cameras) should be used in images', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>File management
    
    (<a href="buglist.cgi?component=File%20management&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>1.13.x
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">Other
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>High
       major<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=6672">7 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=6672#vote_6672">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Nobody - You can work on this!</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">need-unittest
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label for="duplicates">Duplicates</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Old Upload form on Commons"
   href="show_bug.cgi?id=31290">31290</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - EXIF orientation processing might lead to double rotation"
   href="show_bug.cgi?id=32507">32507</a> 
      </span>
      (<a href="buglist.cgi?bug_id=31290,32507">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Auto-rotating images is broken on test2.wikipedia.org but works fine on my local checkout"
   href="show_bug.cgi?id=31024">31024</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Special:Upload FileAPI thumbnail reports wrong width/height for EXIF rotated images"
   href="show_bug.cgi?id=31048">31048</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - MediaWiki and ImageMagick use different methods to determine orientation that don't match up"
   href="show_bug.cgi?id=31487">31487</a> 
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - Image rotation issues (tracking)"
   href="show_bug.cgi?id=31504">31504</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=6672&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=6672">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2006-07-13 17:57 UTC by <span class="vcard"><span class="fn">Med</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2012-03-25 05:52 UTC 
      (<a href="show_activity.cgi?id=6672">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>16 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="bawolff+wn">bawolff+wn</option>
                <option value="brianna.laugher">brianna.laugher</option>
                <option value="Bryan.TongMinh">Bryan.TongMinh</option>
                <option value="dvilcommons">dvilcommons</option>
                <option value="federicoleva">federicoleva</option>
                <option value="hartman.wiki">hartman.wiki</option>
                <option value="jaroslaw.w.tuszynski">jaroslaw.w.tuszynski</option>
                <option value="luxo.wp+bugzilla">luxo.wp+bugzilla</option>
                <option value="m1bt6">m1bt6</option>
                <option value="mah">mah</option>
                <option value="mediawiki-bugs">mediawiki-bugs</option>
                <option value="neilk">neilk</option>
                <option value="Platonides">Platonides</option>
                <option value="rl">rl</option>
                <option value="RSYQFIOJGWZA">RSYQFIOJGWZA</option>
                <option value="saibotrash">saibotrash</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_image_jpeg">
        <td valign="top">
            <a href="attachment.cgi?id=8647"
               title="View the content of the attachment">
          <b>Sample rotated image file</b></a>

          <span class="bz_attach_extra_info">
              (37.67 KB,
                image/jpeg)

            <br>
            <a href="#attach_8647"
               title="Go to the comment associated with the attachment">2011-06-13 18:56 UTC</a>,

            <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=8647&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=6672&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Med</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-07-13 17:57:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Mediawiki doesn't take into account the EXIF orientation which permits to rotate 
automatically the images. Nowadays most softwares handle this correctly and rotate the 
image accordingly. When an image is uploaded mediawiki doesn't correct the 
orientation, therefore creating some problems.

Mediawiki should handle the EXIF orientation.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">brianna.laugher
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-02 03:15:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Here is a clear example:

<a href="http://flickr.com/photos/73422480&#64;N00/81593789">http://flickr.com/photos/73422480&#64;N00/81593789</a> - Flickr image

<a href="http://commons.wikimedia.org/wiki/Image:Tackle.jpg">http://commons.wikimedia.org/wiki/Image:Tackle.jpg</a> - image transferred to Commons by a bot (so definitely no editing done in between).</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">brianna.laugher
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-02 03:47:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >ImageMagick has this option:

-auto-orient
automatically orient (rotate) image from a digital camera.

could we simply change $wgImageMagickConvertCommand to add this option? I suppose all the width and height stuff would need to be swapped around...</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-02 19:48:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >We'd have to special-case a couple of additional things:

* handling of width and height
* display of full-size images inline

The most consistent width/height handling would likely be to switch the fields at metadata load time. This might have issues with existing files, though.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">brianna.laugher
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-03 02:34:24 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c3">comment #3</a>)
<span class="quote">&gt; * display of full-size images inline</span >

If you mean what happens when the user clicks through to see the fullsize file at upload.wikimedia.org - I suppose we should follow Flickr's lead: if you download one of their photos at &quot;original&quot; it doesn't auto-orient.

I would imagine this behaviour for say a 100px image that needed auto-orient:
- inline image [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=image%3Afoo.jpg">image:foo.jpg</a>]] or [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=image%3Afoo.jpg">image:foo.jpg</a>|100px]] - use auto-orient
- image on image page 100px wide - use auto-orient and provide file link to original file on upload.wikimedia.org (currently we don't do this if the image fits entirely on the image page thumb)
- upload.wikimedia.org - serve file as is, so no auto-orient.</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-03 18:05:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c4">comment #4</a>)
<span class="quote">&gt; If you mean what happens when the user clicks through to see the fullsize file
&gt; at upload.wikimedia.org</span >

Nope: [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Image%3AFoo.jpg">Image:Foo.jpg</a>]] or just plain inline display where it's not big enough to trigger a thumbnailing down to limited size.

<span class="quote">&gt; - I suppose we should follow Flickr's lead: if you
&gt; download one of their photos at &quot;original&quot; it doesn't auto-orient.</span >

For download yes, that's same as our current SVG behavior.

<span class="quote">&gt; I would imagine this behaviour for say a 100px image that needed auto-orient:
&gt; - inline image [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=image%3Afoo.jpg">image:foo.jpg</a>]] or [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=image%3Afoo.jpg">image:foo.jpg</a>|100px]] - use auto-orient
&gt; - image on image page 100px wide - use auto-orient and provide file link to
&gt; original file on upload.wikimedia.org (currently we don't do this if the image
&gt; fits entirely on the image page thumb)
&gt; - upload.wikimedia.org - serve file as is, so no auto-orient.</span >

Sounds perfect. From an internal perspective, the object would be set as always requiring rendering for view, same with SVG and DjVu files.</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roger Luethi</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-09-17 09:27:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >A related problem (I'm going to file a separate bug if necessary) is turning those images that have no (or wrong) EXIF data. On Commons, {{rotate}} asks people to &quot;perform a lossless rotation using a tool such as jpegtran&quot;. How about a mediawiki button, maybe for admins, to losslessly rotate images in steps of 90 degrees?</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-05-04 23:08:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Bumping the priority on this and changing it from &quot;enhancement&quot; to regular bug -- many current digital cameras store orientation information this way, and it can be fairly non-obvious how to &quot;fix&quot; an image from this state when common image editing tools also support the EXIF orientation transparently.

Accepting the declared orientation automatically on our end will reduce the number of hoops required to get a photo onto Wikimedia Commons.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-18 13:43:26 UTC
        </span>
      </div>



<pre class="bz_comment_text" >We should ask imagemagick people to add -auto-orient to the -thumbnail option btw, so we don't have to care about it anymore.</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-07 08:36:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c8">comment #8</a>)
<span class="quote">&gt; We should ask imagemagick people to add -auto-orient to the -thumbnail option
&gt; btw, so we don't have to care about it anymore.</span >

We do, because in the MediaHandler we still need to swap width and height around.</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-07 22:14:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Fixed in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/79845" title="revision 79845 in SVN">r79845</a>.</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-08 00:40:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Interesting observation of note. The thumbnail in the Upload page (using the new FileAPI) is not an actual thumbnail, but the full image of course, and it seems that both Safari and FF for Mac, don't apply the EXIF rotation when viewing images in the browser.

Not sure why that is, but it is rather confusing when you want to upload a file with EXIF rotation.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-08 11:42:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*poke poke brion* 

Can we read out exif data using HTML5? If so we can use the &lt;canvas&gt; element to do rotation ourself. Canvas is not supported by some stone-age browsers, but those browsers probably can't show a thumbnail anyway.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-08 14:04:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><a href="http://code.google.com/p/jsjpegmeta/">http://code.google.com/p/jsjpegmeta/</a> looks useful.</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-08 16:25:03 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Added javascript rotation support in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/79867" title="revision 79867 in SVN">r79867</a>.</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-09 14:31:57 UTC
        </span>
      </div>



<pre class="bz_comment_text" >It seems that this functionality is explicitly disabled in Safari, because it would create further confusion. You would have one browser rotating an included &lt;img&gt;, while all others don't. In that light, perhaps a note with &quot;Your image contains 'orientation' settings that will be automatically applied after upload&quot;, is a better idea than actually rotating the image.......</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-09 14:33:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Actually it is still under debate it seems:

<a href="https://bugs.webkit.org/show_bug.cgi?id=19688">https://bugs.webkit.org/show_bug.cgi?id=19688</a></pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 18:56:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=8647" name="attach_8647" title="Sample rotated image file">attachment 8647</a> <a href="attachment.cgi?id=8647&amp;action=edit" title="Sample rotated image file">[details]</a></span>
Sample rotated image file

This is a sample file I created to ensure we had a handy test case for related bugs &amp; regression checks.

Image was drawn in Gimp in portrait, manually rotated sideways, and had appropriate EXIF orientation tag applied via:


exif -c --output=portrait-rotated.jpg --ifd=0 --tag=0x0112 --set-value=8 --no-fixup portrait-raw.jpg 


Correct preview of this file should be in portrait format, showing the arrow pointing up and the word 'UP' legible.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 20:53:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I've noticed a problem with the rotation &amp; scaling on trunk; while the image appears to be getting rotated correctly, it's scaled to the wrong dimensions in the case of a 90-degree rotation (at least for orientation 8 which should rotate 90 degrees left).

The thumbnail image gets re-scaled to the proper aspect ratio on the client side, but if loaded directly will be stretched.

Test box is on Ubuntu 11.04, $wgUseImageMagick on, version:

$ convert --version
Version: ImageMagick 6.6.2-6 2011-03-16 Q16 <a href="http://www.imagemagick.org">http://www.imagemagick.org</a>
Copyright: Copyright (C) 1999-2010 ImageMagick Studio LLC
Features: OpenMP</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 20:54:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Marking with need-unittest keyword; there really should be some standard source files in the unit test suite that we can confirm get rendered to correct size and orientation.</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 21:10:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Scaler modes tested as of <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/90009" title="revision 90009 in SVN">r90009</a>:

OK:
* gd: correct size &amp; orientation
* imext (ImageMagick PHP extension): correct size &amp; orientation

Bad:
* im (shell-out): orientation ok, size has width/height swapped
* client: fails to rotate at all

Unknown:
* custom

It looks like the --auto-orient option on convert might be telling it to swap its width/height, so we may need to swap them back before passing them in. (The ImageMagick extension mode does the rotation explicitly, and explicitly swaps the swapped width/height back first for the scaling.)</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 22:15:46 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Started adding phpunit test cases in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/90016" title="revision 90016 in SVN">r90016</a>.

So far just loading in a landscape image (unrotated) and a portrait image (rotated via EXIF orientation number 8) and checking their width/height.

The test fails on the rotated image, reporting a width of 1024 pixels instead of the expected 768 pixels; it seems that the 'width' and 'height' are still being reported in pre-rotation form, which isn't very useful since any view or transformation of it will be post-rotation.

Still also need to add actual transform tests (can we test multiple backends easily?)</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 23:20:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The rotation implementation here is awfully complex; is there a reason to use
canvas over CSS transforms?

This relies on FileReader, and so far the only browsers that support FileReader
all support CSS transforms, at least with prefixes. We'd just have to add the
appropriate rule.

     -moz-transform:    rotate(90deg);
     -o-transform:      rotate(90deg);
     -webkit-transform: rotate(90deg);
     transform:         rotate(90deg);</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 23:23:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Well, canvas does two things for you here:

1) by scaling down, you no longer have to keep a 10MP JPEG photo uncompressed in memory

2) by rotating, well it's rotated and now you're done. Copy-pasting the image will work as expected; no idea if it will with a CSS transform.

and also

3) Note that EXIF orientation can include flipping as well as rotation -- see <a href="http://sylvana.net/jpegcrop/exif_orientation.html">http://sylvana.net/jpegcrop/exif_orientation.html</a></pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-13 23:25:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Makes sense. Ok, canvas it is.</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 16:31:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/92246" title="revision 92246 in SVN">r92246</a></pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-09-20 18:25:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >There are some serious breakages -- reopening and setting <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Auto-rotating images is broken on test2.wikipedia.org but works fine on my local checkout"
   href="show_bug.cgi?id=31024">bug 31024</a> as a blocker.</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-09-20 22:26:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Ok, issues recently raised in <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Auto-rotating images is broken on test2.wikipedia.org but works fine on my local checkout"
   href="show_bug.cgi?id=31024">bug 31024</a> and <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Special:Upload FileAPI thumbnail reports wrong width/height for EXIF rotated images"
   href="show_bug.cgi?id=31048">bug 31048</a> are now fixed. Re-resolving.</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-03 16:26:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Old Upload form on Commons"
   href="show_bug.cgi?id=31290">Bug 31290</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-05 03:23:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >reopened. Please see here: <a href="https://commons.wikimedia.org/wiki/Commons:Village_pump#Autorotation_using_EXIF_tag_with_MW_1.18">https://commons.wikimedia.org/wiki/Commons:Village_pump#Autorotation_using_EXIF_tag_with_MW_1.18</a>

Firefox 3.6 and Opera 11.5 do not rotate images based on EXIF tags: totally confusing when you click on the 800px preview to see the image in full that the image is suddenly wrongly rotated by 90° (portrait image). Usability failure in my opinion. Next time: Please ask Commons community before! :-)

Solutions(?): 
*rotate them serverside (lossless!) and offer an additional download link (ugly) for the original image. 
*Get the browsers to rotate images based on EXIF.

EXIF rotation is a confusing idea ;)

And: we will get thousands of images being wrongly rotated in our old images! Images have wrong EXIF tags but it didn't matter since MW did not respect them. We probably need a bot deleting the wrong tag to fix them: 

exiftool -Orientation= filename.jpg</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-05 03:25:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Firefox 7.0.1. apparently respects EXIF rotation. Fine. Although 3.6 is still supported... What about IE?</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-05 03:32:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >where is the edit button?.. gnah.

Those browsers mentioned all do *not* rotate based on EXIF.  Sorry, that EXIF rotation stuff is that confusing that it just did confuse me. Another reason simply not to do it...

<a href="https://upload.wikimedia.org/wikipedia/commons/archive/7/7e/20111005030352!SagradaFamiliaSanJuan05.jpg">https://upload.wikimedia.org/wikipedia/commons/archive/7/7e/20111005030352!SagradaFamiliaSanJuan05.jpg</a> is the old version which has an tag: &quot;Orientierung	drehen 270° (8)&quot;. So the browsers should show a rotated church but they show it all standing. → no browser support for EXIF-based rotation in Firefox 3.6, 6.0.1, 7.0.1 and Opera 11.5.</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-05 13:45:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >More test results:
* IE9  (on Vista) doesn't rotate based on EXIF.
* Safari5 (on Vista) doesn't, too.

&quot;In fact, it seems like there shouldn’t even be the option to specify rotation in EXIF!&quot; [<a href="http://pleaselistencarefully.com/Why-photo-rotation-is-broken-on-the-iphone-4-and-how-to-fix-it-using-paperclip-on-heroku">http://pleaselistencarefully.com/Why-photo-rotation-is-broken-on-the-iphone-4-and-how-to-fix-it-using-paperclip-on-heroku</a> pleaselistencarefully.com] November 16th, 2010
* &quot;AFAIK Firefox ignores EXIF information, and IMHO it probably should by default because it could potentially lead to undesirable affects.&quot; [<a href="http://forums.mozillazine.org/viewtopic.php?f=8&amp;t=1352155">http://forums.mozillazine.org/viewtopic.php?f=8&amp;t=1352155</a> Bluefang] July 13th, 2009
Browser bugreport:
* [<a href="http://code.google.com/p/chromium/issues/detail?id=56845">http://code.google.com/p/chromium/issues/detail?id=56845</a> current chromium bug]

At least we know that the EXIF rotation stuff is ugly. Ugly by design since older/basic tools able to decode and display jpeg do not understand EXIF. Then EXIF was added and used to apply a transformation which is really important - but ignored by all older/basic tools. Since today images are pushed directly from cams to browsers we have a problem.  A safe approach would be: simply do not use the broken-by-design EXIF rotation. 
This means: if we display the thumbs rotated by EXIF we also need to rotate the full size server-side to be compatible with browsers (currently: all!).</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Luxo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-06 15:23:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I really don't like this &quot;feature&quot;, this resolution is not proper. Good would be if the software rotate the images directly after upload, but not just the thumbnails.  If I open the original file or download it on my computer, it's wrong rotated. It confuses user, because on their computer and with original size it looks right but the thumbnail is rotated if the exif is wrong.</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 02:13:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(as I wrote in COM:VP)

In case some people did not understand the severity (changed this bug to &quot;major&quot;) of our problem: 

Some discussion/info about popular M$ tools (e.g. &quot;Microsoft Picture manager&quot;) which do not care for EXIF rotation and also do not update it after rotating an image. See: [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=%3Aen%3AWindows_Photo_Gallery%23Bugs">:en:Windows_Photo_Gallery#Bugs</a>]], [<a href="http://www.artslant.com/global/articles/show/11800">http://www.artslant.com/global/articles/show/11800</a> artslant.com], [<a href="http://www.google.com/support/forum/p/Picasa/thread?tid=76dd86d9b63dfed7&amp;hl=en">http://www.google.com/support/forum/p/Picasa/thread?tid=76dd86d9b63dfed7&amp;hl=en</a> picasa discusion], [<a href="http://social.technet.microsoft.com/Forums/ar/w7itproui/thread/58866b3d-0e14-4db8-b6d4-2ee871303da2">http://social.technet.microsoft.com/Forums/ar/w7itproui/thread/58866b3d-0e14-4db8-b6d4-2ee871303da2</a> technet.microsoft.com].
 
A user I spoke with in Commons did use MS photo manager since ever to rotate images. That means: when the thumbnails of his old uploads get purged or a thumb size which wasn't used before is used they all (also the old uploads) will display wrongly rotated and are unusable until fixed.  If they are currently in articles the article will contain a rotated image.</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 02:32:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I think you are describing a situation like this:

- There are files which have EXIF rotation information.

- Some desktop tools do not display the file correctly, with EXIF rotation.

- So, the user rotates the file &quot;physically&quot; so it looks right in their desktop tool. But the EXIF information is still preserved.

- Then they upload it to Commons, which detects the EXIF, and rotates it *again*.

- Chaos ensues

But, my question is, how do we fix that without also causing a bug if the user has desktop tools which do the *right* thing?

Do we supply some sort of button on Commons to rotate the file until it looks right, then nuke the EXIF?</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 04:33:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Corrections / comments:
* &quot;Some desktop tools&quot; - no - (AFAIK) all(!) current desktop browsers do ignore EXIF rotation. 
* The chaos is minor currently. The chaos will get worse (I guess) when thumbs needs to be regenerated of all the x thousands of files with incorrect EXIF rotation which we already have from uploads in the past.
* I do not know what the &quot;the *right* thing&quot; is: I would say that rotating an image by a meta tag while you know that there are older but even current tools which do not respect this is a stupid idea. This can be done if a file format specifies this right from the beginning... but the old, pure jpeg doesn't.
* It would have been nice if the Commons users would have been asked before such a deployment - why isn't this possible? Why do we need chaos first? 
* I do not understand how you will realize your idea. I.e.: how to get the real orig image if the user wants do download it? 

 Options:
* option one is: 
revert this change and do it like the years before: Ignore EXIF-specified rotation. We have Rotatebot in Commons. Images get tagged and physically bot-rotated. This worked fine for all cases. After physical rotation each and every tool did display correctly - no more hassle.

* option onepointfive is: 
No real server-side rotation but a javascript assisted placement of bot tempates {{rotate|xxx}} or {{reset rotation in EXIF}} (not existent currently)  directly on upload.   Did I understand it correctly that you can read the EXIF tags by using Javascript? You can show the  (exif-rotated) thumb (as it is done now) in the upload form and add rotation arrows and ask the user to bring the image in the right orientation. If the orientation chosen by the user differs from the physical orientation the JS could set one of the templates mentioned above. Those templates could be bot-processed then. Or maybe directly processed by a serverside re-upload of a physically rotated version.  Benefit: no problems with full-size view in older tools (browsers). No chaos with old uploads.  No manual tagging for rotation needed. 

* option two is:
We keep EXIF-based rotation but it needs improvements. 
** The most urgent thing would be that we need to have a possibility to fix files which specify rotation but do not need rotation. Currently, we can only fix this manually. Bot would be a option: <a href="https://commons.wikimedia.org/wiki/User_talk:Dcoetzee#EXIF_orientation_reset_bot">https://commons.wikimedia.org/wiki/User_talk:Dcoetzee#EXIF_orientation_reset_bot</a>  But even if we have one: it is hard for all users except tech-aware to understand what is going on. A average user will think: huh, my image is rotated, lets order rotatebot to correct rotate it back. The problem is: the first rotatebot attempt will fail since rotatebot doesn't take the current Exif rotation into account. Maybe it should - in some cases... 
** The full-size usability: user expects no rotated image when he clicks on a image (with correct exif-based rotation) to see the full view. Serverside rotation of the full resolution image (lossless, via exiftran for example) would be an option.  But we also need to provide a option to download the real original image (maybe an additional link below). Of course this will still cause confusion and maybe will break some scripts/tools.

I suggest: revert and think. And then maybe try a exif-based rotation again.

btw: 
* just found: [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=bugzilla%3A31366">bugzilla:31366</a>]] describes the full-size view problem, too. Feel free to merge or whatever. Not my world here.
* opened [[<a href="https://en.wikipedia.org/w/index.php?title=Special:Search&go=Go&search=Bugzilla%3A31487">Bugzilla:31487</a>]] for another problem: &quot;EXIF orientation tag display on bottom of each file page&quot;. This leads to more user problems because they have no chance to understand why MW rotates a image.</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 14:06:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt;I suggest: revert and think. And then maybe try a exif-based rotation again.</span >

If we do, we should do so soon, before there are lot of cached rotated thumbnails. Given the problems it seems to be causing, the Exif auto-rotation feature does need more careful consideration imho.</pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 14:14:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Why is no one complaining about these problems on Flickr ? Because I believe we chose the same approach as Flickr....

Is it just because it's very difficult to download the full version of an image from flickr ? Or does Flickr serverside rotate images before anyone downloads the full version ?</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 14:18:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I don't think there would be much of an issue if we did this consistently from the beginning (Some files are broken, but if its broken from the get-go, then its the file's fault). But when things used to work, and then stop, people tend to complain (Especially when they become really broken due to mismatched cached thumbs).</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 15:36:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c38">comment #38</a>)
<span class="quote">&gt; Why is no one complaining about these problems on Flickr ? Because I believe we
&gt; chose the same approach as Flickr....
&gt; 
&gt; Is it just because it's very difficult to download the full version of an image
&gt; from flickr ? Or does Flickr serverside rotate images before anyone downloads
&gt; the full version ?</span >

The reason is: in flickr: you click on the image and you get a server-side scaled bigger version of the image but not the real full version like you get at Commons. I really hate flickr therefore, btw. It takes tens of clicks in flickr to get the original version (and this is only available at pro accounts). And: the full version is a forced download (you cannot view it in your browser).  
That is a completely different UI. Btw: that UI is that bad that often scaled-down versions of flickr images (CC licensed) are uploaded to Commons instead of the biggest available version.

And, yes, flickr did the EXIF-based rotation right from the beginning, didn't it?</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 19:45:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Some new stats from the rotation by bot (disabled) cat: (currently) 26 pictures in Category:Images requiring rotation by bot  (images go there if a user places a template on the file page)
    * 15 of had wrong EXIF data, were not physically rotated
    * 4 images had correct EXIF, were physically rotated but a user did apparently intentionally request the correct rotation based on the physical pic.
    * 9 (incl. 4 left over from yesterday) images had incorrect EXIF, were physically rotated and needed rotation.</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 19:48:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Please open separate bugs for new issues so we have a chance of tracking them. :)

<a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - File description page thumbnail click versus EXIF rotation, mustRender()"
   href="show_bug.cgi?id=31366">Bug 31366</a> covers the 'browser will usually see unrotated file when you click on the main image on the description page' thing.

I think there's a couple other bugs around somewhere for manually changing the rotation -- which would let people easily correct images that get uploaded incorrectly.</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 21:25:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c42">comment #42</a>)
With &quot;option one&quot; or &quot;option onepointfive&quot; from <a href="show_bug.cgi?id=6672#c36">comment #36</a> we wouldn't need to solve <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - File description page thumbnail click versus EXIF rotation, mustRender()"
   href="show_bug.cgi?id=31366">Bug 31366</a>.  

However, reverting seems to be the best solution for now. All was fine until the software change. Let's keep it like this please. This feature wasn't ready to be deployed (to Commons and Wikipedia).</pre>
    </div><div id="c44" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-07 21:27:29 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Ok, I've created <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - Image rotation issues (tracking)"
   href="show_bug.cgi?id=31504">bug 31504</a> to track related issues.

See the full list here:
<a href="https://bugzilla.wikimedia.org/showdependencytree.cgi?id=31504&amp;hide_resolved=0">https://bugzilla.wikimedia.org/showdependencytree.cgi?id=31504&amp;hide_resolved=0</a></pre>
    </div><div id="c45" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-08 02:19:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Well, you are all commenting on related issues, but as for Flickr I can speak authoritatively since I used to work there. And anyway, you could have verified its behaviour pretty easily yourself.

I think this picture says it all. Here they are with our rotated test image:

   <a href="http://www.flickr.com/photos/brevity/6221434141/meta/in/photostream/">http://www.flickr.com/photos/brevity/6221434141/meta/in/photostream/</a>

No, they did not do EXIF from day one. In fact, they don't do EXIF rotation at all, and EXIF metadata is entirely stripped from all scaled images. 

The reason why is that some people stuff ridiculous amounts of data in there, which is then incompressible. So if they preserved EXIF there would be some idiot who would just have to add 1MB of data into there, and then suddenly the 75x75 version is still 1MB, which breaks some other code, etc. etc. At Flickr they will add (some) EXIF info to the metadata of the file, which you can view on the metadata page.

So, Flickr doesn't have this problem because they don't do anything with EXIF. But even if they *did* change their system, it would still be mostly okay. At Flickr, when a file is uploaded, it makes several thumbnails at fixed sizes and then that is it. Unless the file is replaced or manually rotated it never makes another thumbnail. 

Commons is very different; it will generate any thumbnail of any size on demand, and doesn't generate thumbnails until asked.

So, on Flickr, if you uploaded some file in 2007, and you got it to the point where you like the rotation of the file or the thumbnails, it will stay that way. 

However, at Commons, now a file that was manually rotated in 2007 could be thumbnailed with the new code, which tries to EXIF-rotate. So now you have thumbnails that were created with different code all co-existing.</pre>
    </div><div id="c46" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-08 02:20:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Anyway I'm not arguing whether it was right or wrong to change what we do with EXIF, I'm just correcting misinformation about Flickr.</pre>
    </div><div id="c47" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-08 10:52:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >so what if we make the scaling take into account upload time ? some versioning or something ?</pre>
    </div><div id="c48" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c48">Comment 48</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jarek Tuszynski</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-12 12:58:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Before this &quot;fix&quot; Commons did not have much problems with rotated images. They were rare and we had a simple system for tagging them for a bot to rotate. Now all the bets are off, since most images in need of rotation only need the deletion of the EXIF tag. I have uploaded yesterday a dozen of images which show just fine on my windows machine and 25% of them show up on Commons rotated. At present I do not have any tools on my PC that follow EXIF tags so it is hard to find such images beforehand. I am uploading images for years and for time being they all look fine, but I expect that large fraction of them will self-rotate if re-rendered. 

I think this extension is a cure to non-existing illness and the side-effects of the cure messing up much more files than are helping. I think we should revert it.</pre>
    </div><div id="c49" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c49">Comment 49</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-12 13:15:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c48">comment #48</a>)
<span class="quote">&gt; we had a simple system for tagging them for a bot to rotate. </span >

Just a tip:
Rotatebot was adjusted to MediaWiki's new behaviour since reverting didn't seem to happen. Rotatebot will rotate and adjust EXIF tag if needed. You can use {{rotate|xx}} based on the new(!) thumbnails (there is also one with a unusual size to force a new thumb creation inside the rotation template) like you did before.</pre>
    </div><div id="c50" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c50">Comment 50</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Saibo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-12 13:48:03 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c48">comment #48</a>)
<span class="quote">&gt; I think we should revert it.</span >

I would go for my suggestion &quot;onepointfive&quot; (see above). This would help users to rotate images. Currently the fully automatic rotation confuses people instead of help them. And: As we see  in <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - MediaWiki uses XMP data in addition to IFD0:Orientation to determine orientation"
   href="show_bug.cgi?id=31637">Bug 31637</a> it is totally arbitrary which metadata is used to rotate. There is no real standard, every program behaves different.  If I create my own metadata standard will it be respected by MediaWiki, too? ;)

→ Images should be physically in a correct orientation!  Nice to have: as many correct metadata tags as possible.</pre>
    </div><div id="c51" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c51">Comment 51</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-16 20:41:30 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c45">comment #45</a>)
<span class="quote">&gt; Well, you are all commenting on related issues, but as for Flickr  (...) they don't do EXIF rotation at all, and EXIF metadata is entirely stripped from all scaled images. </span >

There are images in flickr where the file is rotated according to the EXIF. I.e. the thumbs look right, but the original image (as provided by flickr) is rotated with EXIF rotation metadata.

A couple of instances:
<a href="http://www.flickr.com/photos/igorgm/6073292209/">http://www.flickr.com/photos/igorgm/6073292209/</a>
<a href="http://www.flickr.com/photos/igorgm/6073985274/">http://www.flickr.com/photos/igorgm/6073985274/</a></pre>
    </div><div id="c52" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c52">Comment 52</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-16 22:55:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c51">comment #51</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=6672#c45">comment #45</a>)
&gt; &gt; Well, you are all commenting on related issues, but as for Flickr  (...) they don't do EXIF rotation at all, and EXIF metadata is entirely stripped from all scaled images. 
&gt; 
&gt; There are images in flickr where the file is rotated according to the EXIF.
&gt; I.e. the thumbs look right, but the original image (as provided by flickr) is
&gt; rotated with EXIF rotation metadata.
&gt; 
&gt; A couple of instances:
&gt; <a href="http://www.flickr.com/photos/igorgm/6073292209/">http://www.flickr.com/photos/igorgm/6073292209/</a>
&gt; <a href="http://www.flickr.com/photos/igorgm/6073985274/">http://www.flickr.com/photos/igorgm/6073985274/</a></span >

That was puzzling -- I tried it myself with the test image Brion was using in the unit tests. Orientation is  270, and yet the image remains unrotated:

     <a href="http://www.flickr.com/photos/brevity/6221434141/meta/in/photostream/">http://www.flickr.com/photos/brevity/6221434141/meta/in/photostream/</a>

This is a guess, but the other image uses the Canon EXIF Tag &quot;Auto Rotate&quot;.

     <a href="http://www.flickr.com/photos/igorgm/6073292209/meta/in/photostream/">http://www.flickr.com/photos/igorgm/6073292209/meta/in/photostream/</a>

...which my usual EXIF parsing tool (exiv2) can't even read or write, so that's hard to test.

Maybe Flickr decided that Orientation was unreliable, but maybe Canon's AutoRotate is. I'll ask.</pre>
    </div><div id="c53" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c53">Comment 53</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-16 23:54:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt;...which my usual EXIF parsing tool (exiv2) can't even read or write, so that's
&gt;hard to test.</span >

btw, exiftool can read Canon maker notes (And possibly write them), so it can be used to test that.


As an aside, MediaWiki does not currently extract/do anything with, maker notes.</pre>
    </div><div id="c54" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c54">Comment 54</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Platonides</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-17 16:18:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><a href="http://www.flickr.com/photos/iteijeiro/6049541815/">http://www.flickr.com/photos/iteijeiro/6049541815/</a> and <a href="http://www.flickr.com/photos/iteijeiro/5948070071/">http://www.flickr.com/photos/iteijeiro/5948070071/</a> get rotated and were made with a Nikon (NIKON D3100). They don't seem to contain propietary markers.

Maybe they have a whitelist for cameras with gravity sensor?</pre>
    </div><div id="c55" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c55">Comment 55</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-17 17:38:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c54">comment #54</a>)
<span class="quote">&gt; <a href="http://www.flickr.com/photos/iteijeiro/6049541815/">http://www.flickr.com/photos/iteijeiro/6049541815/</a> and
&gt; <a href="http://www.flickr.com/photos/iteijeiro/5948070071/">http://www.flickr.com/photos/iteijeiro/5948070071/</a> get rotated and were made
&gt; with a Nikon (NIKON D3100). They don't seem to contain propietary markers.
&gt; 
&gt; Maybe they have a whitelist for cameras with gravity sensor?</span >

Maybe. I posted a test image, right out of a camera albeit an older one, and it still didn't work.

   <a href="http://www.flickr.com/photos/brevity/6254100567/meta/in/photostream/">http://www.flickr.com/photos/brevity/6254100567/meta/in/photostream/</a>

(Test image from here: <a href="http://www.kotikone.fi/kuukkeli/antin_exiftran.html">http://www.kotikone.fi/kuukkeli/antin_exiftran.html</a>, taken with Nikon D50.)</pre>
    </div><div id="c56" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c56">Comment 56</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Neil Kandalgaonkar</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-17 17:50:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Oh, never mind. I had a setting in my account to not auto-rotate my images.

A friend of mine who works there says that, unless the user has turned off auto-rotate, EXIF Orientation is used to &quot;physically&quot; rotate the thumbnails as they are generated (which is a one-time event at Flickr).

I do remember this long conversation about stripping EXIF from all thumbnails, which still seems to be the policy.</pre>
    </div><div id="c57" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c57">Comment 57</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-11-20 00:31:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - EXIF orientation processing might lead to double rotation"
   href="show_bug.cgi?id=32507">Bug 32507</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c58" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c58">Comment 58</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bryan Tong Minh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-11-20 19:21:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I should note that it is now possible to disable the automatic rotation via $wgEnableAutoRotation</pre>
    </div><div id="c59" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c59">Comment 59</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeff G.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-24 18:24:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >With <a href="http://commons.wikimedia.org/wiki/File:Urbanski_Grave.jpg">http://commons.wikimedia.org/wiki/File:Urbanski_Grave.jpg</a> (a photo of a grave marker taken with a Canon PowerShot SX100 IS uploaded 03:26, 24 March 2012 (UTC) and my version uploaded 34 minutes later) the EXIF contains &quot;Orientation=Rotated 90° CCW&quot;, the original size displays fine in IE 9.0.8112.16421 64-bit Edition (reading left to right), and all thumbnails display Rotated 90° CW (reading top to bottom). :(</pre>
    </div><div id="c60" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=6672#c60">Comment 60</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-25 05:52:32 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=6672#c59">comment #59</a>)
<span class="quote">&gt; With <a href="http://commons.wikimedia.org/wiki/File:Urbanski_Grave.jpg">http://commons.wikimedia.org/wiki/File:Urbanski_Grave.jpg</a> (a photo of a
&gt; grave marker taken with a Canon PowerShot SX100 IS uploaded 03:26, 24 March
&gt; 2012 (UTC) and my version uploaded 34 minutes later) the EXIF contains
&gt; &quot;Orientation=Rotated 90° CCW&quot;, the original size displays fine in IE
&gt; 9.0.8112.16421 64-bit Edition (reading left to right), and all thumbnails
&gt; display Rotated 90° CW (reading top to bottom). :(</span >

That is the expected behaviour.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=6672&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=6672">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=6672">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=6672">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=6672&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=6672" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=6672&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419367255-hFpvL4Axqtwold6V_aDKIVM8QnhI_4YzGQ670qOENp4">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>