<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 9530 &ndash; Section heading anchors shouldn't begin with invalid characters</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=9530&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=9530">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=9530">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=9530">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 9530 – Section heading anchors shouldn\'t begin with invalid characters",  
                             "show_bug.cgi?id=9530" );
        document.title = "Bug 9530 – Section heading anchors shouldn\'t begin with invalid characters";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 9530 – Section heading anchors shouldn\'t begin with invalid characters", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_RESOLVED bz_product_MediaWiki bz_component_Parser bz_bug_9530 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2013-06-18 14:41:04 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2013-06-18 14:41:04">
  <input type="hidden" name="longdesclength" value="46">
  <input type="hidden" name="id" value="9530">
  <input type="hidden" name="token" value="1419371528-pXDdtqtJFYUafAxfnhWWS9F3o8lJhWQvy0J0Nt0Id-A">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=9530"><b>Bug&nbsp;9530</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Section heading anchors shouldn't begin with invalid characters</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>Section heading anchors shouldn't begin with invalid characters
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Section heading anchors shouldn\'t begin with invalid characters', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          WONTFIX
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>Parser
    
    (<a href="buglist.cgi?component=Parser&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">All
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Low
       trivial<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=9530">3 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=9530#vote_9530">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Nobody - You can work on this!</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
          <a href="http://fr.wikipedia.org/wiki/%C3%89quipe_d%27Angleterre_de_rugby_%C3%A0_XV"><span title="http://fr.wikipedia.org/wiki/%C3%89quipe_d%27Angleterre_de_rugby_%C3%A0_XV">http://fr.wikipedia.org/wiki/%C3%89qu...
        </span></a>
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label for="duplicates">Duplicates</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - The Sanitizer doesn't validate the contents of id attributes"
   href="show_bug.cgi?id=4515">4515</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Section titles beginning with URL-escaped characters --&gt; invalid XHTML anchors"
   href="show_bug.cgi?id=18548">18548</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid id and name generated for Russian header element"
   href="show_bug.cgi?id=18838">18838</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid HTML"
   href="show_bug.cgi?id=19890">19890</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - XHTML does not validate"
   href="show_bug.cgi?id=20225">20225</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Header rendering makes pages not validate"
   href="show_bug.cgi?id=22418">22418</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid section-IDs - especially when using special characters"
   href="show_bug.cgi?id=22693">22693</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Validate Error"
   href="show_bug.cgi?id=25907">25907</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - mediawiki generates invalid xhtml id attributes"
   href="show_bug.cgi?id=29843">29843</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - User-specified HTML IDs (section titles) are not checked for validity"
   href="show_bug.cgi?id=29877">29877</a> 
      </span>
      (<a href="buglist.cgi?bug_id=4515,18548,18838,19890,20225,22418,22693,25907,29843,29877">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - HTML validity (tracking)"
   href="show_bug.cgi?id=209">html</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=9530&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=9530">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2007-04-08 18:40 UTC by <span class="vcard">pixeltoo
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2013-06-18 14:41 UTC 
      (<a href="show_activity.cgi?id=9530">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>18 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="accnospamtom">accnospamtom</option>
                <option value="avarab">avarab</option>
                <option value="ayg">ayg</option>
                <option value="danny.b">danny.b</option>
                <option value="derbeth">derbeth</option>
                <option value="ed.palmer">ed.palmer</option>
                <option value="EN.WP.ST47">EN.WP.ST47</option>
                <option value="greenreaper">greenreaper</option>
                <option value="gwinyam">gwinyam</option>
                <option value="hars">hars</option>
                <option value="hartman.wiki">hartman.wiki</option>
                <option value="ho94949">ho94949</option>
                <option value="kosikfl">kosikfl</option>
                <option value="liangent">liangent</option>
                <option value="martin.leese">martin.leese</option>
                <option value="mediawiki-bugs">mediawiki-bugs</option>
                <option value="tparscal">tparscal</option>
                <option value="verdy_p">verdy_p</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="2">
        <a href="attachment.cgi?bugid=9530&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">pixeltoo
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-08 18:40:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >#First according to the W3C XHTML 1.0 specifications the attribute &quot;name&quot; of the
tag &quot;a&quot; (anchor or link) is deprecated. You can use it but you need also to
notify the &quot;id&quot; attribute.
#Then &quot;id&quot; attribute must begin with a letter ([A-Za-z]) and not with a dot
neither a &quot;-&quot;.  

The tidy extension summaries this with this lines:

BAD         &lt;a name=&quot;123456&quot;&gt;...&lt;/a&gt;
BAD         &lt;a id=&quot;123456&quot;&gt;...&lt;/a&gt;

DEPRECATED  &lt;a name=&quot;my_link&quot;&gt;...&lt;/a&gt;

GOOD        &lt;a id=&quot;my_link&quot;&gt;...&lt;/a&gt;
GOOD        &lt;a id=&quot;my_link&quot; name=&quot;my_link&quot;&gt;...&lt;/a&gt;</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-08 19:37:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >1) Every a element in the URL in question that has a name element appears to also have a matching 
id element.

2) Every id in the URL in question begins with either a letter or underscore.

The URL you linked to appears to be completely correct.</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">pixeltoo
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-08 20:52:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >1)attribute name is deprecated. If there are id and name for each anchor, how do
you explain this warning at the line 275.

#line 275 column 4 - Warning: &lt;a&gt; cannot copy name attribute to id

source html: &lt;p&gt;&lt;a name=&quot;.C3.82ge_d.E2.80.99or_.281890-1909.29&quot;&gt;&lt;/a&gt;&lt;/p&gt;
 

2) why do you use underscore at the begining whereas id attribute must begin
with a letter ([A-Za-z])?

example:
line 1365 column 1 - Warning: &lt;li&gt; ID &quot;_note-effetpanneaux&quot; uses XML ID syntax


source html:
&lt;li id=&quot;_note-effetpanneaux&quot;&gt;&lt;a href=&quot;#_ref-effetpanneaux_0&quot; title=&quot;&quot;&gt;↑&lt;/a&gt;
&lt;span style=&quot;cursor:help&quot;&gt;&lt;span
style=&quot;font-family:monospace;font-weight:bold;font-size:small&quot;
title=&quot;Langue&amp;#160;: français&quot;&gt;(fr)&lt;/span&gt;&lt;/span&gt;


</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-08 21:02:02 UTC
        </span>
      </div>



<pre class="bz_comment_text" >id's in XML may begin with letters, colons, or underscores.  See: &lt;<a href="http://www.w3.org/TR/2006/REC-xml">http://www.w3.org/TR/2006/REC-xml</a>-
<a href="https://gerrit.wikimedia.org/r/#q,20060816,n,z" title="Git commit 20060816">20060816</a>/#NT-Name&gt;.  It's true that this is not permitted in HTML 4.0, which is presumably where the 
warning comes in, but we aren't using HTML 4.0, so I don't see an issue.  The compatibility problems 
would probably be minor.

You're correct that we aren't careful to avoid headings that don't start with valid characters.  
Repurposing to that.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">pixeltoo
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-04-08 22:29:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >ok thanks</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-01-05 16:04:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This is now fixed if $wgEnforceHtmlIds is set to false.  If all goes well, it should be fixed by default sometime this week.</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-01-05 16:31:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - The Sanitizer doesn't validate the contents of id attributes"
   href="show_bug.cgi?id=4515">Bug 4515</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Danny B.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-01-05 18:50:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED WONTFIX - Sanitizer doesn't validate attribute values according to DTD"
   href="show_bug.cgi?id=10218">Bug 10218</a> is more general, should this be duped to it?</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-01-05 19:56:59 UTC
        </span>
      </div>



<pre class="bz_comment_text" >No, it's better to have more specific bugs so we can close them fixed when each one is fixed, and generally maintain their status separately.</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dan Jacobson</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-04-14 19:21:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >validate --xml says
Error at line 85, character 34:  value of attribute &quot;id&quot; invalid: &quot;.&quot;
        cannot start a name
 &lt;a name=&quot;.E8.B7.AF.E7.B7.9A&quot; id=&quot;.E8.B7.AF.E7.B7.9A&quot;&gt;&lt;/a&gt;&lt;h2&gt;&lt;span class=&quot;editsection&quot;&gt;[&lt;a href=&quot;/index
.php?title=%E5%B7%A8%E6%A5%AD_%E5%BD%B0%E5%8C%96-%E5%A4%A7%E8%82%9A-%E6%B2%99%E9%B9%BF&amp;amp;action=edit&amp;amp;sect
</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-18 17:56:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Section titles beginning with URL-escaped characters --&gt; invalid XHTML anchors"
   href="show_bug.cgi?id=18548">Bug 18548</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-18 17:57:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid id and name generated for Russian header element"
   href="show_bug.cgi?id=18838">Bug 18838</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Splarka</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-07-23 07:41:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid HTML"
   href="show_bug.cgi?id=19890">Bug 19890</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chad H.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-08-13 18:37:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - XHTML does not validate"
   href="show_bug.cgi?id=20225">Bug 20225</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-08 10:35:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Header rendering makes pages not validate"
   href="show_bug.cgi?id=22418">Bug 22418</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-02 10:40:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Invalid section-IDs - especially when using special characters"
   href="show_bug.cgi?id=22693">Bug 22693</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-02 17:15:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Note that this is moot if $wgHtml5 is true, since HTML5 permits id's to begin with any character they can contain.  I'll leave the bug open because we still do support XHTML1 as an output format for now, but I don't see it as likely that anyone will fix this bug.

(Also:

(In reply to <a href="show_bug.cgi?id=9530#c5">comment #5</a>)
<span class="quote">&gt; This is now fixed if $wgEnforceHtmlIds is set to false.  If all goes well, it
&gt; should be fixed by default sometime this week.</span >

I love how optimistic I always am about things getting enabled.  :) )</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gadget850</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-04 17:26:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><a href="http://www.mediawiki.org/wiki/Manual:$wgEnforceHtmlIds">http://www.mediawiki.org/wiki/Manual:$wgEnforceHtmlIds</a>
$wgEnforceHtmlIds was renamed to renamed to $wgExperimentalHtmlIds in <a href="https://www.mediawiki.org/wiki/Special:Code/MediaWiki/61691" title="revision 61691 in SVN">r61691</a> (1.16) and converted to use laxer HTML 5 syntax.

<a href="http://www.mediawiki.org/wiki/Manual:$wgExperimentalHtmlIds">http://www.mediawiki.org/wiki/Manual:$wgExperimentalHtmlIds</a>
This option is for testing -- when the functionality is ready, it will be on by default with no option.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-04 17:40:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >. . . yes, and?</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bawolff (Brian Wolff)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 04:31:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Validate Error"
   href="show_bug.cgi?id=25907">Bug 25907</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Trevor Parscal</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 18:42:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >What's the history of the practice of trying to encode the name of the section in the anchor for that section?

It seems to get very messy and unpredictable unless the heading text is written in latin characters without any punctuation. And even in those cases, it's still possible that the heading text will be encoded as the same ID as other IDs on the page, such as those used by the skin or other software that renders user interfaces.

The IDs seem to be effectively unpredictable in a couple of ways:

1. The encoding does not follow a standard encoding algorithm, making any non string that's not [a-zA-Z0-9 ] be converted to something that only someone who knows the algorithm well would expect.
2. The anchor names could possibly intersect with IDs used on the page for other things. An effort has been made to conform the IDs of skins use the mw-* namespace, but it's still not a guarantee, just a bit less likely.

If anchor names were encoded in a predictable way, such as id=&quot;section-1.2&quot; the anchors would be able to correspond to the table of contents, which is pretty simple and straightforward, plus we could know for sure that there would never be collisions with IDs so long as we never use the section-* namespace in skins or other software. Since we have more control over the software than the content, this seems like a superior approach.</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Laurence 'GreenReaper' Parry</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 18:50:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The point is to be able to link to a specific section of an article from another article (or even externally). Yes, it is possible that the name will change, but often that does not happen, especially for articles using a specific template. Naming it &quot;section-1.2&quot; would not really provide anything useful, and would be even more likely to change than the name of the header.</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Trevor Parscal</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 19:08:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt; &quot;but often that does not happen&quot;</span >

What is this based on?</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Laurence 'GreenReaper' Parry</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 19:23:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Personal experience? Maybe you edit different articles than I do, but a lot of them are relatively static, especially in terms of section headers. And that's just on Wikipedia.

Section header links are used a lot. Maybe they shouldn't be, in their current state, but they are. Getting rid of them entirely is not a good idea, nor is replacing them with something that would be useless for their main purpose: linking to a specific part of an article.</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Derk-Jan Hartman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 20:04:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Jumping to named sections is very common. Numbered sections change, so cannot be used for section jumping.

And it's not that difficult. A section anchor is basically: section title -&gt; uri encode -&gt; replace ( '%', '.' )
I do agree we have a lot of issues with id clashing. Anchors really should have their own prefix, but changing that now would be rather disruptive I fear...</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-16 00:15:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c20">comment #20</a>)
<span class="quote">&gt; What's the history of the practice of trying to encode the name of the section
&gt; in the anchor for that section?</span >

The same as the practice of trying to encode the name of the article in the URL for the article, I imagine.  Pretty URLs are nice.

<span class="quote">&gt; It seems to get very messy and unpredictable unless the heading text is written
&gt; in latin characters without any punctuation.</span >

$wgExperimentalHtmlIds is enabled in trunk, so this is no longer the case -- non-Latin scripts and punctuation will work fine.  (Although there are still a bunch of other problems.)

<span class="quote">&gt; 1. The encoding does not follow a standard encoding algorithm, making any non
&gt; string that's not [a-zA-Z0-9 ] be converted to something that only someone who
&gt; knows the algorithm well would expect.</span >

This is no longer the case on trunk.  (Actually, legacy id's are just urlencoded as UTF-8, but with &quot;%&quot; replaced by &quot;.&quot;, so that's not really nonstandard.  But it is ugly.)

<span class="quote">&gt; 2. The anchor names could possibly intersect with IDs used on the page for
&gt; other things. An effort has been made to conform the IDs of skins use the mw-*
&gt; namespace, but it's still not a guarantee, just a bit less likely.</span >

Yes, this is a problem.

<span class="quote">&gt; If anchor names were encoded in a predictable way, such as id=&quot;section-1.2&quot; the
&gt; anchors would be able to correspond to the table of contents, which is pretty
&gt; simple and straightforward, plus we could know for sure that there would never
&gt; be collisions with IDs so long as we never use the section-* namespace in skins
&gt; or other software. Since we have more control over the software than the
&gt; content, this seems like a superior approach.</span >

We could also make our URLs use page_id instead of the article title, but I don't think it's desirable.  The section name is more stable than the number, because it doesn't change when sections are added or removed, and adding/removing sections is more common than renaming them.  (No, I have no stats on this, but it's clear to me from personal experience.)

The section name can also be typed manually or copy-pasted from the rendered page, not just copy-pasted from the URL, so it's more convenient.  You could type a #section-1.2 type anchor manually too, but only if you count the sections, which isn't worth it on large articles.

And the section name gives you an idea of what section you're being linked to before you click the URL.  The section number is opaque.


There are indeed some problems with the way we do things in trunk.  Overall, IMO, they're not enough to offset the (modest) advantages we get from using section names instead of numbers.  It would be pretty easy to more or less eliminate anchor collisions from headers by just making a big pattern of reserved anchors, including unprefixed ones like &quot;content&quot; and &quot;top&quot;, and tweaking header id's if they matched -- we wouldn't get them all, but we'd make the problem really negligible.</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-05 10:47:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >May be the solution would be to use Punycode encoding ? (and really, you should avoid dots everywhere because they are not liked in CSS selectors.
Punycode (used in IDN) solves all these problems. We just don't have to restrict dots (don't need nameprep and its internal very complex character equivalence mappings), they can be Punycoded like the rest.

The good thing about Punycode is that it just uses letters and digits and is case insenstive ; minus-hyphens are use to separate &quot;words&quot; made of cese insensitive letters and digits, and the result can be mappedto javascript properties (like in HTYML5 dataset).

Note that this won't make the ID's built from section headers necesarily unique (there's still a frequent case where multiple headers for distcint sections have identical text content; if this ever happens, some suffix should be appended to the duplicate section headers only.

Oh, my... chaging the algorithm will force all preparsed pages to have their HTML flushed from the server cache, and could break existing URLs that are inserted in discussions as is. But not a major problem, as it would break these URLS, only anchors won't be found. This already happens frequently independantly of this bug, simply because not enough people know how to use the MediaWiki parser functions for computing anchro links. We have utility template on all wikis for this, this is a matter of training, but it is not critical in discussions.

In main articles however, we occasionnly find links to other article sections: a quelity check of these pages should really use the URL-building parser funtions. Or the aricles should contain manually inserted (and predictable) anchor (using &lt;span id=&quot;&quot;&gt;&lt;/psan&gt;), independantly of the text used in section headings.</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-05 16:41:34 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c26">comment #26</a>)
<span class="quote">&gt; May be the solution would be to use Punycode encoding ?</span >

Punycode is gibberish.  We want readable anchors, if it's not too problematic.  And it's not.

<span class="quote">&gt; (and really, you should
&gt; avoid dots everywhere because they are not liked in CSS selectors.</span >

People are not likely to refer to section id's in CSS.  If they do, they can escape special characters with backslashes.</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">ho94949
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-06 08:58:46 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c26">comment #26</a>)
<span class="quote">&gt; May be the solution would be to use Punycode encoding ?</span >
Maybe using punycode may take problem.
First, that is duplicated with each title

For example, title with è 
in punycode that is xn--8ca
than make another title with title xn--8ca
then, we cannot find difference about them.

Also, think about span tag, that is in the article.</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-06 09:58:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Yes I know, but the id duplication is another problem (also for HTML5 conformance and for having autogenerated summaries to link to the appropriate section when we click on them).

Yes there's an extra need for making these ID's unique (required in XHTML) by adding some suffixes to duplicate section headings, when they exist in any page, but this is another issue, independant of this one, that should be handled automatically without any additional markup in the edited pages. This duplication is extremely frequent in vote pages (with standardized subsection headings like &quot;Approve&quot; or &quot;Oppose&quot; or &quot;Neutral&quot;). Adding a span tag will not resolve the issue with the standard summaries which completely ignore this markup in the autogenerated anchors.

Here we were speaking about invalid characters, and it is clear that a valid ID must not contain any dot (and at least must not start with it), and that converting them using &quot;.XX&quot; hex sequences for each non-ASCII UTF-8-encoded character is also not needed in most cases (an ID can perfectly accept non-ASCII letters without this extra encoding to ASCII on top of UTF-8). Really, the generated IDs should be the same and compatible for direct use in URLs, or in CSS selectors, or for the XML syntax. This is possible, but it will require a better encoding than the bogous current one, plus the general need to make them unique by adding some suffixes for duplicates.</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-06 19:18:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c29">comment #29</a>)
<span class="quote">&gt; Yes I know, but the id duplication is another problem (also for HTML5
&gt; conformance and for having autogenerated summaries to link to the appropriate
&gt; section when we click on them).</span >

The algorithm already accounts for this.  E.g.,

== Foo ==
== &quot;Foo&quot; ==

will give the latter an anchor of #Summary_2 in current trunk.  First the anchor is generated, then a number is appended if it's the same as a previous anchor.  You have to have this code anyway, to handle cases like

== Foo ==
== Foo ==

So punycode doesn't gain anything for uniqueness.

<span class="quote">&gt; Here we were speaking about invalid characters, and it is clear that a valid ID
&gt; must not contain any dot (and at least must not start with it)</span >

Valid ID's in XHTML 1.0 and HTML5 may contain a dot.  Valid ID's in HTML5 may start with a dot.

<span class="quote">&gt; and that
&gt; converting them using &quot;.XX&quot; hex sequences for each non-ASCII UTF-8-encoded
&gt; character</span >

We no longer do this in trunk.  We just convert runs of whitespace and other bad characters to a single underscore, and otherwise output as-is (possibly with a number appended).

<span class="quote">&gt; Really, the generated IDs should be the same and compatible for direct use in
&gt; URLs, or in CSS selectors, or for the XML syntax. This is possible, but it will
&gt; require a better encoding than the bogous current one, plus the general need to
&gt; make them unique by adding some suffixes for duplicates.</span >

The id's being output by trunk in HTML5 mode can be used directly in URLs (in reasonably recent browsers), can be used in CSS selectors with proper escaping (although I doubt much of anyone does), and can be used in XML just as in any other markup language.</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 16:34:09 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I really *didnot* say that Punycode wpould solve the duplicates. In fact you're resaying exactly what I said (even speaking that this was a separate issue).

I have never intended that Punycode would solve duplicates. It was just possible to use it as an alternative to the incorrect syntax of existing id's that contain dots.

You can argue anything you want but anything generated like:
 id=&quot;.C2.BF&quot;
is completely invalid. There MUST not ne any dot in id's generated from non-ASCII characters. and the current encoding exposes each UTF-8 byte in its hex form, which is really inefficient (in terms of length) and really unreadable (not more that Punycode), when many more letters outside ASCII are perfectly valid in HTML an XML id's.

Why can't we have ids like:
  id=&quot;Résumé&quot; (which is perfectly valid)
and we still have to see things like:
  id=&quot;R.C2.E9sum.C2.E9&quot; (which is completely invalid)
???

That's ALL what I was commenting (and I did not introduce myself the separate problem of duplicates).

You misunderstood or simply did not read my own statements. Punycode was ONLY a suggestion for the first problem. It is of course based on a framework where we absolutely don't need to keep the additional &quot;xn--&quot; prefix which is definitely not part of Punycode itself, but part of its use in IDNA (which has a much more restricted subset of valid characters, than the set of valid characters in XML id's). But Punycode still offers a good encoding framework for building valid XML id's for the case were some characters are restricted (we'll still need to encode in some way the presence of dots in NON-encoded section headings).</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 16:37:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >See this reference for the syntax of names (and the restricted set) in XML:

<a href="http://www.w3.org/TR/REC-xml/#NT-Name">http://www.w3.org/TR/REC-xml/#NT-Name</a></pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 16:43:21 UTC
        </span>
      </div>



<pre class="bz_comment_text" >You'll immediately se that the ONLY ASCII characters valid everywhere in IDs are only the ASCII letters and the underscore; and plenty of other non ASCII characters are accepted which don't need any UTF-8 bytes-based &quot;.NN&quot; hex encoding like it is done today (in an overlong form).

Additional ASCII characters are accepted ONLY after the initial position (this includes the dot, the minus-hyphen, and ASCII digits); additional NON-ASCII characters are also accepted after the first position (notably the combining characters).</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 17:05:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Note that this is most problameatic with non-Latin wikis (see the Chinse, Korean, Japanese, Arabic, Hebrew, Thai wikis !), were almost all characters are hex-encoded (in overlong sequences) and expose an invalid leading dot, when no hex encoding at all was even necessary in most cases.

Do you still argue that these hex-encoded ID's are &quot;readable&quot; ??? They're definitely not !</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gadget850</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 17:20:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >OK, so leading dots are invalid.

Simple fix: add a prefix to all section headers, such as section_ to ensure the id always starts with a valid character. MediaWiki dot encodes UTF characters as needed, which are valid in any position other than the first.

The cite.php citation extension does this in the same manner, using cite_ref- and cite_note- as id prefixes to ensure valid HTML output.</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 18:40:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c31">comment #31</a>)
<span class="quote">&gt; You can argue anything you want but anything generated like:
&gt;  id=&quot;.C2.BF&quot;</span >

MediaWiki trunk does not create such id's.

<span class="quote">&gt; is completely invalid.</span >

Not in HTML5.

<span class="quote">&gt; Why can't we have ids like:
&gt;   id=&quot;Résumé&quot; (which is perfectly valid)
&gt; and we still have to see things like:
&gt;   id=&quot;R.C2.E9sum.C2.E9&quot; (which is completely invalid)
&gt; ???</span >

In trunk, the wikitext

  == Résumé ==

produces

  &lt;div id=&quot;R.C3.A9sum.C3.A9&quot;&gt;&lt;/div&gt;
  &lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Résumé&quot;&gt;Résumé&lt;/span&gt;&lt;/h2&gt;

The link from the table of contents is &lt;a href=&quot;#Résumé&quot;&gt;.  (The extra div is kept so old links don't break -- it can be removed eventually.)

(In reply to <a href="show_bug.cgi?id=9530#c32">comment #32</a>)
<span class="quote">&gt; See this reference for the syntax of names (and the restricted set) in XML:
&gt; 
&gt; <a href="http://www.w3.org/TR/REC-xml/#NT-Name">http://www.w3.org/TR/REC-xml/#NT-Name</a></span >

HTML5 does not define the id attribute to be an XML Name.  In fact, it has no DTD at all.  The restrictions on the id element in HTML5 (in both text/html and XML syntax) are stated here:

&quot;The value must be unique amongst all the IDs in the element's home subtree and must contain at least one character. The value must not contain any space characters.&quot;
<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-id-attribute">http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-id-attribute</a>

As further evidence that id's in HTML5 are allowed to start with dots in XML as well as text/html format, see this link:

<a href="http://validator.nu/?doc=data%3Aapplication%2Fxhtml%2Bxml%2C%3Chtml+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22+id%3D%22.%22%3E%3Chead%3E%3Ctitle%3E%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E">http://validator.nu/?doc=data%3Aapplication%2Fxhtml%2Bxml%2C%3Chtml+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22+id%3D%22.%22%3E%3Chead%3E%3Ctitle%3E%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E</a>

This is not permitted by XHTML 1.0, which we still technically support, but that's obsolete and I don't expect us to care if we break XHTML 1.0 validation in some cases in the future.  Eventually we're likely to remove the mode entirely.  This bug will be INVALID as soon as $wgHtml5 is removed and set always to true.

(In reply to <a href="show_bug.cgi?id=9530#c34">comment #34</a>)
<span class="quote">&gt; Do you still argue that these hex-encoded ID's are &quot;readable&quot; ??? They're
&gt; definitely not !</span >

The id's *in trunk* are readable.  Example heading taken from he.wikipedia.org:

  == איפה נמצא העמוד ראשי של מחר? ==

id generated in trunk:

  id=&quot;איפה_נמצא_העמוד_ראשי_של_מחר?&quot;

This is valid in HTML5 and works in the (recent-enough) browsers it's been tested in.</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 19:22:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Yes XHTML 1.0 will be deprecated, but ony its &quot;modular&quot; design, that highly depends on validation with external schemas that have to be declared in the document.

But HTML5 does NOT deprecate the compatibility with XML and it explciitly says that it will support TWO syntaxes for its serialization : the historical SGML-based HTML syntax, AND the XML syntax. The inlydifference is that it will not be modular and the schema for the validation of the content model will be inferred. This means that you'll still be able to use an XML parser, but the schema will not be specified by the document itself, so that the documetn can be processed in &quot;standalone&quot; mode using a schema provided by the application using the XML parser, instead of by the ocument or by the site producing it.

In other words, the XML contraints on names continue to apply to HTML5 for strict conformance, otherwise it will not be possible to use an XML parser for it, or to embed HTML5 in an XML document.

XHTML 1.0 is also abandonned because it created a fork from HTML in a separate branch. HTML5 remerges the two branches and deprecates the modular design and free extensions based on non-standard schemas.

Note also, that XML documents do not need to validate, but must still observe the conformance rules. Even a non-validating XML parser will choke on invalid ID's if they are presented with the &quot;xml:id&quot; pseudo-attribute. But I agree with you, id's in HTML5 are not used with a &quot;xml:id&quot; pseudo-attribute, but by a plain &quot;id&quot; attribute : if the XML parser does not validate the schema, it will accept an &quot;id&quot; attribute containing anything. But as soon as you'll want to build a schema for your XML parsed document, it will be impossible to use anything else than the XML type name that restricts its value, if you want the compatibility with schemas built for XHTML 1.0, unless you make this &quot;id&quot; atribute into an unrestricted text type.</pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-07 19:31:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c37">comment #37</a>)
<span class="quote">&gt; But HTML5 does NOT deprecate the compatibility with XML and it explciitly says
&gt; that it will support TWO syntaxes for its serialization : the historical
&gt; SGML-based HTML syntax, AND the XML syntax.</span >

Correct.  However, the id element is not defined as an XML Name in HTML5's XML syntax.

<span class="quote">&gt; In other words, the XML contraints on names continue to apply to HTML5 for
&gt; strict conformance, otherwise it will not be possible to use an XML parser for
&gt; it, or to embed HTML5 in an XML document.</span >

You're mistaken.  There is no conformance mode in HTML5 that prohibits id=&quot;.&quot;, nor any notion of &quot;strict conformance&quot; defined anywhere in HTML5.  And XML parsers can handle such id's just fine.  It will not validate in a DTD that makes id=&quot;&quot; a Name, but HTML5 has no DTD, so this is fine.

<span class="quote">&gt; But as soon as you'll want to
&gt; build a schema for your XML parsed document, it will be impossible to use
&gt; anything else than the XML type name that restricts its value, if you want the
&gt; compatibility with schemas built for XHTML 1.0, unless you make this &quot;id&quot;
&gt; atribute into an unrestricted text type.</span >

Correct.  Any DTD that's compatible with HTML5's requirements will make &quot;id&quot; an unrestricted text type.  Any DTD that restricts it to Name will incorrectly declare valid HTML5 documents to be invalid.</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chad H.</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-12 13:41:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - mediawiki generates invalid xhtml id attributes"
   href="show_bug.cgi?id=29843">Bug 29843</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-13 14:44:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >With a dot in such id, it won't be possible to reference the element by Id using DOM (getElementById() can only return a single element, unlike getElementByTagName()). And CSS selectors won't work with those id's if they contain a dot.

We need still a correct implementation of anchorEncode() that still operates correctly with CSS selectors, and with the DOM API.

Note: Uniqueness of generated Id's is still needed, so beside anchorencode() we also need a suffix generation for duplicates (Facebook does that in its framework, look at how the application-generated HTML is transformed when the page is generated: all application-generated Id's are dynamically suffixed, as well as the generated CSS class names, to create a correct sandboxing isolating them in their own namespace, and enforcing the uniqueness to avoid garbling the content generated outside the framework or from another app, and this is an excellent initiative ; Google does that also for application gadgets for iGoogle, using its framework).</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-13 15:08:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=9530#c40">comment #40</a>)
<span class="quote">&gt; With a dot in such id, it won't be possible to reference the element by Id
&gt; using DOM</span >

getElementById() will accept id's that have dots in them just fine.

<span class="quote">&gt; And CSS selectors won't work with those id's if they
&gt; contain a dot.</span >

You can escape the dot, like #foo\.bar { color: red }.

<span class="quote">&gt; We need still a correct implementation of anchorEncode() that still operates
&gt; correctly with CSS selectors, and with the DOM API.</span >

We have one.  Try viewing a page like this, e.g., by inputting it at &lt;<a href="http://software.hixie.ch/utilities/js/live-dom-viewer/">http://software.hixie.ch/utilities/js/live-dom-viewer/</a>&gt;:

&lt;!DOCTYPE html&gt;
&lt;span id=foo.bar&gt;Hello&lt;/span&gt;
&lt;style&gt;#foo\.bar { color: red }&lt;/style&gt;
&lt;script&gt;document.getElementById(&quot;foo.bar&quot;).innerHTML += &quot;!&quot;&lt;/script&gt;

You'll see &quot;Hello!&quot;, red and with an exclamation point.

<span class="quote">&gt; Note: Uniqueness of generated Id's is still needed, so beside anchorencode() we
&gt; also need a suffix generation for duplicates</span >

We've always done this for headings, although there are various bugs, including ignoring non-heading id's.</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Roan Kattouw</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 01:41:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - User-specified HTML IDs (section titles) are not checked for validity"
   href="show_bug.cgi?id=29877">Bug 29877</a> has been marked as a duplicate of this bug. ***</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Daniel Friesen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-06-08 14:11:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Marking as WONTFIX as we have completely removed XHTML 1.0 support from core. It's rules are no longer relevant and hence this bug is invalid.</pre>
    </div><div id="c44" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philippe Verdy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-06-09 12:00:27 UTC
        </span>
      </div>



<pre class="bz_comment_text" >You've stated to support HTML5, whch includes XHTML5. It will work as long as the HTML5/XHTML5 parsers do not attempt to map its type to a name or to an XML id. As long as the schema validator used keeps this attribute as an unrestricted text type, and the HTML DOM accepts this (including through Javascript), we can live with it.

But ensuring the uniqueness of id values is still a problem when you use document.getElementById() and you don't know which element will be returned. Apparently, browsers have implemented this Javascript API so that they will return an array of elements if this ever occurs (and it's up to Javascript applications to be aware that a single element *may* not be returned by this call, just like with document.getElementByName()...). This means that the id attribute duplicates the function of the name attribute now in (X)HTML5 and we can ignore the non-working &quot;validity&quot; restrictions of XHTML1 and HTML4 or before in their schema.

But we still need a way to create unique anchors which will remain readable and more or less stable when linking between different articles. For now MediaWiki does not track anchors (id's) that are referenced between articles, these anchors are modified in articles without notice, and links from other articles no longer work as expected. And MediaWiki still does not warn editors when we have two sections showing the same heading in the same article, so we can fix them to have working links, with readable anchors usable in other articles.</pre>
    </div><div id="c45" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9530#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Daniel Friesen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-06-09 15:13:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(X)HTML5 does not define id as a name/XML id, any code handling it as such is a non-conforming parser and there is no reason to support it.

The parser already ensures the uniqueness of ids for headers within a page. ID Uniqueness in other locations are <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - User-specified HTML IDs can be the same as interface IDs"
   href="show_bug.cgi?id=7356">bug 7356</a> and <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - Sidebar generates duplicate IDs"
   href="show_bug.cgi?id=35371">bug 35371</a>. If you think we should add extra processing to track user-specified id=&quot;&quot; values and reject them when a user writes bad markup duplicating ids open a new bug.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=9530&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=9530">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=9530">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=9530">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=9530&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=9530" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=9530&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419371528-xb-F5_NYCKAcrt7vqWchSALIclxOmHoePuzAoNEIoq8">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>