<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 959 &ndash; Check email addresses before storing in database for compliance with RFC 2822</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://old-bugzilla.wikimedia.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=959&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=959">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=959">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=959">



    
    <link href="skins/standard/global.css?1389015166"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css?1389015166" rel="stylesheet"
        type="text/css" ><link href="extensions/Voting/web/style.css?1389015166" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css?1389015166" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Wikimedia/global.css?1402013050" rel="stylesheet"
        type="text/css" title="Wikimedia"><link href="skins/contrib/Wikimedia/show_bug.css?1402441020" rel="stylesheet"
        type="text/css" title="Wikimedia">

      <link rel="stylesheet" href="skins/contrib/Wikimedia/vector.css?1403109885" media="screen"
            title="Wikimedia" />


    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1389015166"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1389015166"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1389015166"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1389015166"></script><script type="text/javascript" src="js/yui/json/json-min.js?1389015166"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1389015166"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1389015166"></script><script type="text/javascript" src="js/global.js?1389015166"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 15
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 959 – Check email addresses before storing in database for compliance with RFC 2822",  
                             "show_bug.cgi?id=959" );
        document.title = "Bug 959 – Check email addresses before storing in database for compliance with RFC 2822";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 959 – Check email addresses before storing in database for compliance with RFC 2822", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1389015166"></script><script type="text/javascript" src="js/field.js?1389015166"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="old-bugzilla-wikimedia-org bz_bug bz_status_RESOLVED bz_product_MediaWiki bz_component_User_login_and_signup bz_bug_959 yui-skin-sam">



<!-- If custom Wikimedia skin -->
   <div id="page-base" class="noprint"></div>
                <div id="head-base" class="noprint"></div>
                <!-- content -->
                <div id="content-container" >
                        <a id="top"></a>
                        <!-- bodyContent -->
                        <div id="bodyContent">
      <p class="header_addl_info">Last modified: 2011-03-13 18:04:44 UTC</p>

 <!-- If custom Wikimedia skin -->
<h1>Wikimedia Bugzilla is closed!</h1><div id="message" style="text-align: center; color: black">Wikimedia has <a href="https://www.mediawiki.org/wiki/Phabricator/versus_Bugzilla">migrated from Bugzilla to Phabricator</a>. Bug reports should be created and updated in <a href="https://phabricator.wikimedia.org">Wikimedia Phabricator</a> instead. Please <a href="https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account">create an account in Phabricator and add your Bugzilla email address</a> to it.<br>Wikimedia Bugzilla is read-only. If you try to edit or create any bug report in Bugzilla you will be shown an intentional error message.<br>In order to access the Phabricator task corresponding to a Bugzilla report, just remove "static-" from its URL.<br>You could still run searches in Bugzilla or access your <a href="https://old-bugzilla.wikimedia.org/page.cgi?id=voting%2Fuser.html">list of votes</a> but bug reports will obviously not be up-to-date in Bugzilla.</div>

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2011-03-13 18:04:44">
  <input type="hidden" name="longdesclength" value="39">
  <input type="hidden" name="id" value="959">
  <input type="hidden" name="token" value="1419358120-r0KfrB96n0KSEXqPXgPN3SzBzDRZOzfp5eYgWvSUt5s">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=959"><b>Bug&nbsp;959</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Check email addresses before storing in database for compliance with RFC 2822</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>Check email addresses before storing in database for compliance with RFC 2822
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Check email addresses before storing in database for compliance with RFC 2822', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          WONTFIX
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MediaWiki</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr>
    
    <td class="field_label">
      <label for="component">
        <a href="describecomponents.cgi?product=MediaWiki">
        Component:</a>
      </label>
    </td>
    
    <td>User login and signup
    
    (<a href="buglist.cgi?component=User%20login%20and%20signup&product=MediaWiki&resolution=---"
      target="new_window">Other open bugs</a>)
    
    </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">All
       All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Lowest
       enhancement<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=959">3 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=959#vote_959">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">T. Gries</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wikibugs-l\x40lists.wikimedia.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
          <a href="http://www.faqs.org/rfcs/rfc2822.html">http://www.faqs.org/rfcs/rfc2822.html</a>
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">patch
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - ENotif/EConfirm &amp; further enhancements (tracking)"
   href="show_bug.cgi?id=1932">1932</a> <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - E-mail notification (EN) for page changes of watch-listed pages, user_talk page, and for new pages"
   href="show_bug.cgi?id=454">454</a> <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - EConfirm (EC): e-mail address confirmation by sending a link comprising a token to the unconfirmed mailaddress"
   href="show_bug.cgi?id=866">866</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - e-mail confirmation error message issues"
   href="show_bug.cgi?id=2439">2439</a> 
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=959&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=959">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2004-11-29 23:12 UTC by <span class="vcard"><span class="fn">T. Gries</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2011-03-13 18:04 UTC 
      (<a href="show_activity.cgi?id=959">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>6 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="arichards">arichards</option>
                <option value="bugzillas+padREMOVETHISdu">bugzillas+padREMOVETHISdu</option>
                <option value="happy.melon.wiki">happy.melon.wiki</option>
                <option value="hashar">hashar</option>
                <option value="majewsky">majewsky</option>
                <option value="wikibugs-l">wikibugs-l</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_browser">


  <a 
      title="Please set this if the described problem seems to happen only in a specific web browser."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_browser"
  >Web browser:</a>

</th>
  <td class="field_value "
      id="field_container_cf_browser"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_platform">


  <a 
      title="The Mobile Platform the described problem was experienced on."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_platform"
  >Mobile Platform:</a>

</th>
  <td class="field_value "
      id="field_container_cf_platform"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_hugglebeta">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_hugglebeta"
  >Assignee Huggle Beta Tester:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_hugglebeta"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=453"
               title="View the content of the attachment">
          <b>A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid</b></a>

          <span class="bz_attach_extra_info">
              (2.48 KB,
                text/plain)

            <br>
            <a href="#attach_453"
               title="Go to the comment associated with the attachment">2005-04-23 21:14 UTC</a>,

            <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=453&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=458"
               title="View the content of the attachment">
          <b>Regex checks a string containing ONLY!! an email adress</b></a>

          <span class="bz_attach_extra_info">
              (7.62 KB,
                patch)

            <br>
            <a href="#attach_458"
               title="Go to the comment associated with the attachment">2005-04-26 14:03 UTC</a>,

            <span class="vcard"><span class="fn">David Majnemer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=458&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=459"
               title="View the content of the attachment">
          <b>The check if there is a vaild email somewhere inside of the test string</b></a>

          <span class="bz_attach_extra_info">
              (7.62 KB,
                patch)

            <br>
            <a href="#attach_459"
               title="Go to the comment associated with the attachment">2005-04-26 14:04 UTC</a>,

            <span class="vcard"><span class="fn">David Majnemer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=459&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=3254"
               title="View the content of the attachment">
          <b>Implementation of the e-mail address verification without regexps</b></a>

          <span class="bz_attach_extra_info">
              (5.38 KB,
                patch)

            <br>
            <a href="#attach_3254"
               title="Go to the comment associated with the attachment">2007-02-21 21:03 UTC</a>,

            <span class="vcard"><span class="fn">Stefan Majewsky</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=3254&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=959&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1389015166" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-29 23:12:06 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Email addresses are currently stored unchecked for mailing passwords or
EmailUser. Any *potential* security hole in php mail() or PEAR:Mail function as
called in UserMailer.php could be exploited by entering pseudo addresses which
do something unwanted.

Remark: I do not mean the email authentication as described in
<a href="http://bugzilla.wikipedia.org/show_bug.cgi?id=866">http://bugzilla.wikipedia.org/show_bug.cgi?id=866</a> , which only authenticates
addresses for the &quot;higher&quot; functions such as EmailUser and Enotif. But please be
reminded, that the &quot;I forgot my password&quot; mails are sent to un-authenticated
addresses anyway.

Proposed is
(a) converting to all lower case
(b) a check for valid mail address strings


The Enotif and Email Authentification patches 454 and 866 are coming with
solutions to this bug, as they only allow users to store one email address which
matches the regular expression
^([a-z0-9_.-]+([a-z0-9_.-]+)*\&#64;[a-z0-9_-]+([a-z0-9_.-]+)*([a-z.]{2,})+)$

I gave provisionally highest priority to this bug.

A fix is easy be checking the user entered (dirty=unauthenticated) email address
simply before storing in SpecialUserlogin.php against the above regular
expression. In case of not matching address, an empty (blank) string address can
be provisonally stored in table user.

I repeat: my Enotif and my Email authentication procedure will be published with
a solution to this problem.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-30 02:08:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >To fix this, I introduced a new function in User.php 
 
	/** 
	 * does the string match roughly an email address ? 
	 * &#64;param string $addr email address 
	 * &#64;static 
	 */ 
	function isValidEmailAddr ( $addr ) { 
		return preg_match( '/^([a-z0-9_.-]+([a-z0-9_.-]+)*\&#64;[a-z0-9_-]+([a-z0-9_.-]+)*([a-z.]{2,})+)$/', strtolower($addr)); 
	} 
 
It is currently used in  
 
1) SpecialUserlogin.php (when a user enters a new address into the login form),  
2) SpecialPreferences.php (when a user enters a new address into the preferences form), 
 
&quot;new address&quot; is stored, if 
lowercase(new address string) != lowercase(old stored address string)  
 &amp;&amp; (new address string != '') 
 &amp;&amp; IsValidEmailAddr 
 
 
Remark: UserMailer.php in Enotif patch performs its own checks against a simplified RFC-822 format. 
Fixed within Enotif 2.00 
 </pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-30 08:15:47 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Can you please reference the appropriate RFC to ensure that this 
validation regexp is correct and will not reject valid addresses?</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-30 08:32:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I am using the regular expression as used in AutoMailto() fix of UseMod Wiki,
see <a href="http://www.usemod.com/cgi-bin/wiki.pl?WikiPatches/AutoMailto">http://www.usemod.com/cgi-bin/wiki.pl?WikiPatches/AutoMailto</a> .


     ^([a-z0-9_.-]+([a-z0-9_.-]+)*\&#64;[a-z0-9_-]+([a-z0-9_.-]+)*([a-z.]{2,})+)$

return &quot;true&quot; for a single valid email address in the formats I know. It
checking against a simplified RFC-822 format, but will need some further fine
tuning, which I cannot effort at the moment; perhaps, someone of the community
can assist here, please:

EVERYONE is invited to check this regular expression. 

Its purpose within MediaWiki CVS 1.4 is:
The RE shall validate one single valid email address string (i.e. without a name
string) and return &quot;true&quot; in such a case. 

My regular expression is used often and can be regarded as starting point for
optimisation. If anyone has doubts: please let me know and inidcated a
reference, where you base you objection upon.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Zigger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-30 11:02:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >A number of things seem missing straight away.  Most people do not need these,
but please refer to RFC2822 section 3, starting with the definition of &quot;address&quot;
or &quot;addr-spec&quot; (?) and working backwards.  Hopefully you can find some compliant
regex elsewhere.
</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-11-30 13:14:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >reminder for Tom (myself): don't forget to check wfStrencode() respectively strict use of the new database-wrapper functions, when 
storing e-Mail address.

reminder for Brion and other developers having code access:
current storing of email addresses in SpecialUserlogin.php and SpecialPreferences.php in MediaWiki (pre-CVS release) needs urgently 
(as far as I see) escaping against potential database injections, as any user can store any string at the moment.

Version lowered to 1.3.7 to ring the bells.
</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-01 00:53:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Tom's claim about SQL injection is entirely unfounded, as a cursory look at the 
code or simple experimentation will show.
</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">JeLuF</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-01 05:47:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The regexp rejects several valid email addresses, e.g. plus signs and exclamation
marks are valid characters for the mailbox name. 

Latest Punicode extensions to DNS allow the use of a limited set of diacritic
characters for the hostname.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-19 08:33:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >-- introducing a new function isValidEmailAddr() in User.php, which performs a
check of the entered email address</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-19 08:37:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c7">comment #7</a>)
<span class="quote">&gt; The regexp rejects several valid email addresses, e.g. plus signs and exclamation
&gt; marks are valid characters for the mailbox name. 
&gt; 
&gt; Latest Punicode extensions to DNS allow the use of a limited set of diacritic
&gt; characters for the hostname.</span >

I reopened the bug, because according to JeLuf some email addresses might result
in false-rejects. But the new function is a starting point.</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gdr</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-29 09:42:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Please read RFC2822 <a href="http://www.faqs.org/rfcs/rfc2822.html">http://www.faqs.org/rfcs/rfc2822.html</a>  The local-part of an e-mail address may contain any 
ASCII character. (It might be reasonable for you to only allow the local-part to be in dot-atom format, which rules out 
special characters like &quot;&#64;&lt;&gt;[]:;,\ but allows letters, numbers, and !#$%&amp;'*+-/=?^_`{|}~.  See section 3.2.4 of 
RFC2822.</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-29 23:24:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c10">comment #10</a>)
<span class="quote">&gt; Please read RFC2822 <a href="http://www.faqs.org/rfcs/rfc2822.html">http://www.faqs.org/rfcs/rfc2822.html</a>  The local-part of</span >
an e-mail address may contain any 
<span class="quote">&gt; ASCII character. (It might be reasonable for you to only allow the local-part</span >
to be in dot-atom format, which rules out 
<span class="quote">&gt; special characters like &quot;&#64;&lt;&gt;[]:;,\ but allows letters, numbers, and</span >
!#$%&amp;'*+-/=?^_`{|}~.  See section 3.2.4 of 
<span class="quote">&gt; RFC2822.</span >

Coming soon. thanks for letting me know.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jamesday</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-30 00:15:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The proposed check seems to reject making an email address empty. In UK and much
European law it's required that there be a way to remove personal information on
request and making admins or developers do that instead of letting the software
do it is undesirable. Email addresses are considered personal information.

Please do not convert the saved email addresses to lower case. Changing cases
introduces the possibility of bugs when extensions to the use of ASCII
characters are involved - the case conversion would need to know the local
character set encoding method used by the receiving system, information which is
not available. Note also that a local address is allowed to have many mailboxes
which differ only in case (perhaps because of character set translation), so
case conversion could result in the wrong local mailbox on the receiving system
being used. Conversion also makes life needlessly annoying for humans, who may
be using mixed case deliberately to split words.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2004-12-30 00:31:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c12">comment #12</a>)
<span class="quote">&gt; The proposed check seems to reject making an email address empty. In UK and much
&gt; European law it's required that there be a way to remove personal information on
&gt; request and making admins or developers do that instead of letting the software
&gt; do it is undesirable. Email addresses are considered personal information.</span >

JamesDay,

perhaps you misunderstood my check routine.

The logic in SpecialPreferences and UserlOgin.php *does* allow the user to empty
his/her address: of course, it is and will be possible to blank out (to empty)
the own email address

<span class="quote">&gt; 
&gt; Please do not convert the saved email addresses to lower case. Changing cases
&gt; introduces the possibility of bugs when extensions to the use of ASCII
&gt; characters are involved - the case conversion would need to know the local
&gt; character set encoding method used by the receiving system, information which is
&gt; not available. Note also that a local address is allowed to have many mailboxes
&gt; which differ only in case (perhaps because of character set translation), so
&gt; case conversion could result in the wrong local mailbox on the receiving system
&gt; being used. Conversion also makes life needlessly annoying for humans, who may
&gt; be using mixed case deliberately to split words.</span >

I agree. I introduced and proposed the conversion to lowercase to facilitate the
&quot;unique&quot; (same) userid AND (same) emailaddress checking with Kate's Namechecher
tool targetting to a single-user-login.

As soon as I am allowed to commit to the CVS, I will commit such changes as
proposed by all of you to the isValidEmailAddress code (etc.).

Tom

</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-01 17:50:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Paul Warren made what he claims to be a fullly RFC 822 compatable PCRE that
matches valid email addresses, see:
<a href="http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html">http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html</a>

The regular expression follows (not that I haven't gotten it to work.)

(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:
\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(
?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ 
\t]))*&quot;(?:(?:\r\n)?[ \t])*))*&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\0
31]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\
](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+
(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:
(?:\r\n)?[ \t])*))*|(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)
?[ \t])*)*\&lt;(?:(?:\r\n)?[ \t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\
r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[
 \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)
?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t]
)*))*(?:,&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[
 \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*
)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)
*:(?:(?:\r\n)?[ \t])*)?(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+
|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r
\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:
\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t
]))*&quot;(?:(?:\r\n)?[ \t])*))*&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031
]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](
?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?
:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?
:\r\n)?[ \t])*))*\&gt;(?:(?:\r\n)?[ \t])*)|(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?
:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?
[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*:(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|
\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;
&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;
(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*&#64;(?:(?:\r\n)?[ \t]
)*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\
&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?
:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[
\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-
\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(
?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*\&lt;(?:(?:\r\n)?[ \t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;
:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([
^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;
.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\
]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\
[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\
r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]
|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \0
00-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\
.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,
;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?
:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*&#64;(?:(?:\r\n)?[ \t])*
(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.
\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[
^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]
]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\&gt;(?:(?:\r\n)?[ \t])*)(?:,\s*(
?:(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\
&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(
?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[
\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t
])*))*&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t
])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?
:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|
\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:
[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\
]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*\&lt;(?:(?:\r\n)
?[ \t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;
()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)
?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;
&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,&#64;(?:(?:\r\n)?[
 \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,
;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t]
)*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\
&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?
(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.
\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:
\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[
&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])
*))*&#64;(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])
+|\Z|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\
.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\&gt;(?:(
?:\r\n)?[ \t])*))*)?;\s*)</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wikipedia:en:User:Paddu</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-02 19:19:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The following Perl code may or may not be the same as the regexp in the previous
comment and may or may not be more readable:

$newline = '(?:(?:\r\n)?[ \t])';
$newlines = &quot;$newline+&quot;;
$opt_newlines = &quot;$newline*&quot;;
$normal_chars = '[^()&lt;&gt;&#64;,;:\\&quot;.\[\] \000-\031]+';
$dot = &quot;\.$opt_newlines&quot;;
$backslashdot = '\\.';
$domainliteral = '([^\[\]\r\\]|'.$backslashdot.')*';
$endofstring = '\Z';
$lookahead_special_char = '(?=[\[&quot;()&lt;&gt;&#64;,;:\\&quot;.\[\]])';
$stop_normal_chars = &quot;(?:$newlines|$endofstring|$lookahead_special_char)&quot;;
$quoted_string_char = '[^\&quot;\r\\]';
$quoted_string = '&quot;(?:'.&quot;$quoted_string_char|$backslashdot|$newline&quot;.')*&quot;';
$username_component =
&quot;(?:$normal_chars$stop_normal_chars|$quoted_string$opt_newlines)&quot;;
$domain_component =
&quot;(?:$normal_chars$stop_normal_chars|\[$domainliteral\]$opt_newlines)&quot;;
$at = &quot;&#64;$opt_newlines&quot;;
$at_sameline = '&#64;';
$username = &quot;$username_component(?:$dot$username_component)*&quot;;
$domainname = &quot;$domain_component(?:$dot$domain_component)*&quot;;
$l_ang = &quot;\&lt;$opt_newlines&quot;;
$r_ang = &quot;\&gt;$opt_newlines&quot;;
$colon = &quot;:$opt_newlines&quot;;
$comma = ',\s*';
$comma_no_whitespace = ',';
$route = &quot;(?:$at_sameline$domainname(?:$comma_no_whitespace$at$domainname)*$colon)&quot;;
$opt_route = &quot;$route?&quot;;
$plain_email_addr = &quot;$username$at$domainname&quot;;
$route_addr = &quot;$l_ang$opt_route$plain_email_addr$r_ang&quot;;
$email_addr_opt_with_name = &quot;(?:$plain_email_addr|$username_component$route_addr)&quot;;
$email_addr_list =
&quot;(?:$email_addr_opt_with_name(?:$comma$email_addr_opt_with_name)*)&quot;;
$opt_email_addr_list = &quot;$email_addr_list?&quot;;
$semicolon = ';\s*';
$above_regexp =
&quot;(?:$email_addr_opt_with_name|$username_component$colon$opt_email_addr_list$semicolon)&quot;;</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Wikipedia:en:User:Paddu</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-02 19:23:54 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c15">comment #15</a>)
<span class="quote">&gt; The following Perl code may or may not be the same as the regexp in the previous
&gt; comment and may or may not be more readable:
&gt; </span >

The requirements of $at_sameline and $comma_no_whitespace and the inconsistent
usage of $opt_newlines and \s* (which allows \r without a \n or vice versa)
might be a bug in the regexp or in the RFC or in my brain or in my editor.

</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-09 04:39:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Lowering the severity of this, as it is a theoretical bug, there's no evidence
that this poses a risk at present time.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-22 06:30:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >small title amendment only</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-23 20:07:19 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I was under the impression that we didn't block any email addresses currently,
but the regex we use blocks valid email addresses, upping the priority to BLOCKER.</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-23 20:16:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c19">comment #19</a>)
<span class="quote">&gt; I was under the impression that we didn't block any email addresses currently,
&gt; but the regex we use blocks valid email addresses, upping the priority to BLOCKER.</span >

Avar:
please can you supply us with more data:

(a) Which MediaWiki version do you refer to ?
(b) What user e-mail address exactly is false-rejected ?

Thanks in advance</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-23 20:39:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >In reply to (<a href="show_bug.cgi?id=959#c20">comment #20</a>)

(1) HEAD (this bug is marked as 1.5-cvs so all comments should be considered to
apply to that branch)
(2) An email address with the plus sign and countless others, your regexp only
matches a very small subset of valid email addresses according to RFC 2822, it
will even reject an IPv4 address after the &#64;.

Unless we can come up with some code that doesn't reject valid email addresses I
think we should remove this check alltogather, there's no proof whatsoever that
invalid email addresses pose any kind of threat and thiscan only serve to induce
annoyance by rejecting valid addresses.</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-23 20:54:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c21">comment #21</a>) 
<span class="quote">&gt; In reply to (<a href="show_bug.cgi?id=959#c20">comment #20</a>) 
&gt;  
&gt; (2) An email address with the plus sign and countless others, your regexp only 
&gt; matches a very small subset of valid email addresses according to RFC 2822, it 
&gt; will even reject an IPv4 address after the &#64;. 
&gt;  
&gt; Unless we can come up with some code that doesn't reject valid email addresses I 
&gt; think we should remove this check alltogather, there's no proof whatsoever that 
&gt; invalid email addresses pose any kind of threat and thiscan only serve to induce 
&gt; annoyance by rejecting valid addresses. </span >
 
In User.php, please modify the function 
 
	/** 
	 * does the string match roughly an email address ? 
	 * &#64;param string $addr email address 
	 * &#64;static 
	 */ 
	function isValidEmailAddr ( $addr ) { 
		return preg_match( '/^([a-z0-9_.-]+([a-z0-9_.-]+)*\&#64;[a-z0-9_-]+([a-z0-9_.-]+)*([a-z.]{2,})+)$/', strtolower($addr)); 
	} 
 
 
===&gt; so that it returns ***true***. 
Later, someone can improve the preg_match 
 
 
 </pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-23 21:14:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=453" name="attach_453" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">attachment 453</a> <a href="attachment.cgi?id=453&amp;action=edit" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">[details]</a></span>
A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid

This is a perl program to test if an email address is valid, I modified it from
the Mail::RFC822::Address code, use it like:

$ perl checkaddress.pl &quot;<a href="mailto:email.address&#64;to.check.com">email.address&#64;to.check.com</a>&quot; &amp;&amp; echo valid || echo
invalid</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T. Gries</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-24 08:06:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c23">comment #23</a>)
<span class="quote">&gt; This is a perl program to test if an email address is valid, I modified it from
&gt; the Mail::RFC822::Address code, use it like:</span >
Good morning Avar,

can you recode this PERL to PHP please - this would be of big help (as I can
concentrate on other issues).
Mediawiki is currently coded in PHP and if you want to propose the improved
check routine, you can better post the PHP version here.

It should be compatible to and can than replace the current shorter function:

	/** 
	 * does the string match roughly an email address ? 
	 * &#64;param string $addr email address 
	 * &#64;static 
	 */ 
	function isValidEmailAddr ( $addr ) { 
		return preg_match(
'/^([a-z0-9_.-]+([a-z0-9_.-]+)*\&#64;[a-z0-9_-]+([a-z0-9_.-]+)*([a-z.]{2,})+)$/',
strtolower($addr)); 
	} 
 
I guess, that Brion or JeLuf will commit any improved convincing version, which
helps to improve MediaWiki REL1_5.
Thanks your contribution.

Looking forward to your replacement function in PHP.</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Majnemer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-26 13:52:27 UTC
        </span>
      </div>



<pre class="bz_comment_text" >	/** 
	 * does the string match roughly an email address ? 
	 * &#64;param string $addr email address 
	 * &#64;static 
	 */ 
	function isValidEmailAddr ( $addr ) { 
if (preg_match('/(?:(?:\\r\\n)?[ \\t])*(?:(?:(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*|(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*\\&lt;(?:(?:\\r\\n)?[
\\t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*(?:,&#64;(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*)*:(?:(?:\\r\\n)?[ \\t])*)?(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*\\&gt;(?:(?:\\r\\n)?[ \\t])*)|(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*:(?:(?:\\r\\n)?[
\\t])*(?:(?:(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*|(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*\\&lt;(?:(?:\\r\\n)?[
\\t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*(?:,&#64;(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*)*:(?:(?:\\r\\n)?[ \\t])*)?(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*\\&gt;(?:(?:\\r\\n)?[ \\t])*)(?:,\\s*(?:(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*|(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*\\&lt;(?:(?:\\r\\n)?[
\\t])*(?:&#64;(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*(?:,&#64;(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*)*:(?:(?:\\r\\n)?[ \\t])*)?(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[
\\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*&#64;(?:(?:\\r\\n)?[
\\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]
\\000-\\031]+(?:(?:(?:\\r\\n)?[
\\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;&#64;,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[
\\t])*))*\\&gt;(?:(?:\\r\\n)?[ \\t])*))*)?;\\s*)/', $text)) {
	return true;
} else {
	return false;
}
	}
however! if ONLY AN EMAIL ADRESS IS SENT IN, YOU WANT TO APPEND A \\A RIGHT
AFTER THE '/ THAT STARTS THE REGEX</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Majnemer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-26 14:03:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=458" name="attach_458" title="Regex checks a string containing ONLY!! an email adress">attachment 458</a> <a href="attachment.cgi?id=458&amp;action=edit" title="Regex checks a string containing ONLY!! an email adress">[details]</a></span>
Regex checks a string containing ONLY!! an email adress

This will check if the string contains only an email adress, no more, no less.</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Majnemer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-26 14:04:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=459" name="attach_459" title="The check if there is a vaild email somewhere inside of the test string">attachment 459</a> <a href="attachment.cgi?id=459&amp;action=edit" title="The check if there is a vaild email somewhere inside of the test string">[details]</a></span>
The check if there is a vaild email somewhere inside of the test string

This will return true if there is one valid email in the whole string.</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Majnemer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-04-26 14:06:10 UTC
        </span>
      </div>



<pre class="bz_comment_text" >These patches were commited to bugzilla because my total match rant was
incorrect. The patches, however, are defined exactly by their description. One
vaildates true if there is a single valid email in a string. The other if the
string contains exactly one email adress.</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-05-14 15:11:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=959#c27">comment #27</a>)
<span class="quote">&gt; Created an attachment (id=459) [edit]
&gt; The check if there is a vaild email somewhere inside of the test string</span >

This doesn't pre-strip the email address of comments (see sub strip_comments in
<span class=""><a href="attachment.cgi?id=453" name="attach_453" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">attachment 453</a> <a href="attachment.cgi?id=453&amp;action=edit" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">[details]</a></span>) or check if the address consists only of valid characters (see
the return line in sub valid in <span class=""><a href="attachment.cgi?id=453" name="attach_453" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">attachment 453</a> <a href="attachment.cgi?id=453&amp;action=edit" title="A perl program that returns 0 if it's fed a valid address, and 1 if it's invalid">[details]</a></span>)
</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ævar Arnfjörð Bjarmason</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-05-21 19:57:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Moving the priority down again</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stefan Majewsky</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-21 21:03:37 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=3254" name="attach_3254" title="Implementation of the e-mail address verification without regexps">attachment 3254</a> <a href="attachment.cgi?id=3254&amp;action=edit" title="Implementation of the e-mail address verification without regexps">[details]</a></span>
Implementation of the e-mail address verification without regexps

I see that, in MW 1.9.2, the User::isValidEmailAddr function still just checks
whether the string is not empty and there is an &quot;&#64;&quot;. I read a bit in certain
resources like Wikipedia and the RFCs and composed the function you can find in
the fourth attachment. It makes (nearly) no use of regexps, instead it reads
and validates the string char by char. I made a speed test on my local Apache
server with PHP (measurement with microtime()). It took 7.228 seconds to
execute my function 100,000 times while the regular expression in the second
attachment needed 14.435 seconds under the same conditions.</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stefan Majewsky</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-21 21:09:24 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Sorry, I made an error. What I expected to be the execution time of the regexp
implementation, was the execution time of both implementations. Some test runs
with corrected time measurement: (my vs. the regexp implementation)

5.758 vs. 6.592
5.763 vs. 6.604</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Aryeh Gregor (not reading bugmail, please e-mail directly)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-22 02:29:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Validating e-mail addresses is incredibly error-prone and I don't see any reason
to do it.  It will probably introduce more issues than it fixes.  I suppose
there's a theoretical chance that some vulnerability will be found that relies
on entering an invalid address, but is that chance really significant enough to
bother with?  We should check if there's an &#64; somewhere to stave off people
entering totally the wrong thing by mistake, and maybe check length if there's a
length limit and check for the presence of invalid characters if there's a
simple list of valid characters, but trying (and probably failing) to implement
the entire RFC doesn't seem useful.</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stefan Majewsky</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-02-22 08:28:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Checking the lengths and the characters is what my function does. Not more and
not less.</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gregor Hagedorn</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-30 13:14:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Mediawiki functionality being tested without a solution for 5 years now after the (very) potential security thread was raised, fully agreeing with <a href="show_bug.cgi?id=959#c33">comment #33</a>, I propose to close the bug: works for me.</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Happy-melon</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-30 14:12:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The current code does not satisfy the original bug request, hence WONTFIX, not WORKSFORME.</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Arthur Richards</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-12-21 16:33:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I'm going to refrain from reopening this for now, but I am surprised that the 'solution' to this really complex problem that no one wants to fix because of:

a) its complexity, 
b) the inability of suggested fixes to accommodate rfc 2822 (there are actually a number of other RFCs that govern the validity of email addresses as well)

is to simply look for an '&#64;' in the email string.  Particularly when an email address technically does not require an '&#64;' in the string...

Some folks out there have spent a lot of time in working this problem over the past years.  After some digging, I unearthed what actually looks like a fabulous email validator.  It validates against the various RFCs out there governing email addresses AND it will provide warnings when an email address is technically considered valid but would more likely be a typo by a user.

The license is open, the source has been community developed and maintained (though principally by Dominic Sayers) and they provide a myriad of email addresses to test against the validator that have been carefully constructed using the RFCs.

Please take a look at: <a href="http://www.dominicsayers.com/isemail/">http://www.dominicsayers.com/isemail/</a></pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=959#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Brion Vibber</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-24 21:13:13 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Note that this has been superseded by <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - MediaWiki should do validation of e-mail addresses"
   href="show_bug.cgi?id=22449">bug 22449</a>: for MW 1.17/1.18 the email validation rules specified for HTML 5 client-side input validation are now being used.

This uses a subset of RFC 5322 rules for the mailbox part, and a subset of RFC 1034 for the host part.

Per comments on <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - MediaWiki should do validation of e-mail addresses"
   href="show_bug.cgi?id=22449">bug 22449</a>, this appears to be liberal enough to not be a problem for the folks using slightly funky characters, while still being useful for catching obviously broken cases. It also means that we keep consistency between client-side validation and server-side validation, which is always a plus.

(Additional validation rules can be enforced by extensions hooking into the server-side validation function.)</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=959&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=959">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=959">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=959">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="head" class="noprint">
			<!-- /search -->
			<div id="p-search">
				<h5><label for="searchInput">Search</label></h5>
				<form id="searchform" action="buglist.cgi" method="get"
				 onsubmit="if (this.quicksearch.value == '')
				 { alert('Please enter one or more search terms first.');
				 return false; } return true;">
					<input type='hidden' name="title" value="Special:Search"/>
					<div id="simpleSearch">
						<input id="searchInput" name="quicksearch" type="text" title="Search Bugzilla [alt-f]" accesskey="f" value="" />
						<button id="searchButton" type='submit' name='button' title="Search Bugzilla for this text">&nbsp;</button>
					</div>
				</form>
			</div>
			<!-- /search -->
			<!-- personal -->
			<div id="p-personal" class="">
				<h5>Personal tools</h5>
				<ul >
							<li id="new_account_container">
								<a href="createaccount.cgi">New&nbsp;Account</a>
							</li>
						<li id="mini_login_container">
  <span class="separator">| </span>
  <a id="login_link" href="show_bug.cgi?id=959&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('')">Log In</a>

  
  <form action="show_bug.cgi?id=959" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login"
        onsubmit="return check_mini_login_fields( '' );"
  >
    <input id="Bugzilla_login" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('')"
    >
    <input class="bz_password" 
           id="Bugzilla_password" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy" value="password"
           title="Password"
           onfocus="mini_login_on_focus('')"
    >
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "email address",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('')">[x]</a>
  </form>
</li>
<li id="forgot_container">
  <span class="separator">| </span>
  <a id="forgot_link" href="show_bug.cgi?id=959&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input type="text" name="loginname" size="20" id="login">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token" value="1419358120-4BRdsVKE9JEWWZ-ok-hH3PbBDOltUYsWjSMT4yX8lY4">
    <a href="#" onclick="return hide_forgot_form('')">[x]</a>
  </form>
</li>

				</ul>
			</div>
			<!-- /personal -->
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="panel" class="noprint">
				<!-- logo -->
				<div id="p-logo"><a style="background-image: url(skins/contrib/Wikimedia/images/bugzilla-logo.png);" href="./"  title="Visit the main page"></a></div>
				<!-- /logo -->
				<!-- navigation -->
				<div class="portal">
					<h5>Navigation</h5>
					<div class="body">
						<ul><li><a href="query.cgi?format=specific">Search bugs</a></li>
			<li><a href="query.cgi?format=advanced">Advanced search</a></li>
			<li><a href="describecomponents.cgi">Browse projects</a></li>
			<li><a href="enter_bug.cgi">Enter a new bug</a></li>
                        <li>
                                <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
                        </li>	
						</ul>
					</div>
				</div>
				<!-- /navigation -->
				<!-- interaction -->
				<!-- /interaction -->
				<!-- toolbox -->
				<div class="portal">
					<h5>Links</h5>
					<div class="body">
						<ul><li><a href="report.cgi">Reports</a></li>
			<li><a href="weekly-bug-summary.cgi?tops=10&days=7">Weekly Summary</a></li>
				<li>
						<a href="request.cgi">Requests</a>
				</li>
						</ul>
					</div>
				</div>
				<!-- /toolbox -->
			</div>
		<!-- /panel -->		

		<!-- footer -->
		<div id="footer" >
			<ul id="footer-info">
				<li>Bugzilla version 4.4.5</li>
			</ul>

			<ul id="footer-places">
				<li><a href="https://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Bug_management/Bugzilla_etiquette" title="Bug management/Bugzilla etiquette">Bugzilla etiquette</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:About" title="Project:About">About MediaWiki.org</a></li>
				<li><a href="https://www.mediawiki.org/wiki/Project:General_disclaimer" title="Project:General disclaimer">Disclaimers</a></li>
			</ul>
			<ul id="footer-icons" class="noprint">
				<li id="footer-icon-poweredby"><a href="http://www.bugzilla.org/"><img src="skins/contrib/Wikimedia/images/bugzilla-badge.png" height="31" width="88" alt="Powered by Bugzilla" /></a></li>
			</ul>
			<div style="clear:both"></div>
		<div class="outro"></div>
		</div>
		<!-- /footer -->
	</body>
</html>